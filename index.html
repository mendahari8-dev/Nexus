<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>NexusPro â€” AI Crypto Signal Terminal</title>

  <!-- PWA -->

  <meta name="theme-color" content="#00F5A0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="NexusPro">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="description" content="Professional AI crypto signals with SMC analysis">

  <!-- Fonts -->

  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    html,body,#root{height:100%;overflow:hidden;}
    body{font-family:"Inter",sans-serif;background:#0B0F19;}
    ::-webkit-scrollbar{width:4px;}
    ::-webkit-scrollbar-track{background:transparent;}
    ::-webkit-scrollbar-thumb{background:#1e2a40;border-radius:2px;}
    input,button,select,textarea{font-family:"Inter",sans-serif;}
  </style>

</head>
<body>
  <!-- Loading screen -->
  <div id="loading-screen" style="position:fixed;inset:0;background:#0B0F19;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;font-family:monospace;">
    <div style="font-size:48px;margin-bottom:16px;">âš¡</div>
    <div style="color:#00F5A0;font-size:18px;font-weight:700;letter-spacing:2px;margin-bottom:8px;">NEXUSPRO</div>
    <div style="color:#6B7280;font-size:12px;margin-bottom:24px;">Loading AI Signal Terminal...</div>
    <div style="width:200px;height:3px;background:#1e2a40;border-radius:2px;overflow:hidden;">
      <div style="height:100%;background:#00F5A0;border-radius:2px;animation:lp 2.5s ease forwards;"></div>
    </div>
    <style>@keyframes lp{0%{width:0%}80%{width:85%}100%{width:95%}} @keyframes notifTimer{0%{width:100%}100%{width:0%}}</style>
  </div>

  <div id="root"></div>

  <!-- Error catcher -->

  <script>
    window.onerror = function(msg, src, line, col, err) { if(msg==="Script error." && line===0){ msg="CDN load failed - check internet connection"; }
      var ls = document.getElementById('loading-screen');
      if(ls) ls.innerHTML = '<div style="text-align:center;padding:30px;color:#EF4444;font-family:monospace;"><div style="font-size:40px;margin-bottom:16px;">âš ï¸</div><div style="font-size:14px;font-weight:700;margin-bottom:8px;">Error Loading App</div><div style="font-size:11px;color:#9CA3AF;max-width:300px;margin:auto;">' + msg + '</div><div style="font-size:10px;color:#6B7280;margin-top:8px;">Line: ' + line + '</div></div>';
    };
  </script>

  <!-- React 18 -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>

  <!-- Babel Standalone - JSX Transpiler -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js" crossorigin="anonymous" onerror="document.write('<script src=\'https://unpkg.com/@babel/standalone@7.23.2/babel.min.js\'><\/script>')"></script>

  <script type="text/babel">



    const { useState, useEffect } = React;

const DARK = { bg:"#0B0F19",card:"#111827",inner:"#151C2F",neon:"#00F5A0",blue:"#3B82F6",red:"#EF4444",orange:"#F59E0B",purple:"#8B5CF6",text:"#E5E7EB",soft:"#9CA3AF",dim:"#6B7280",border:"#1e2a40",isDark:true };
const LIGHT = { bg:"#F1F5F9",card:"#FFFFFF",inner:"#F8FAFC",neon:"#059669",blue:"#2563EB",red:"#DC2626",orange:"#D97706",purple:"#7C3AED",text:"#0F172A",soft:"#475569",dim:"#94A3B8",border:"#E2E8F0",isDark:false };

const COINS = [
  {symbol:"BTC",price:67284,change:1.56,volume:"32.5B",apy:4.2,cap:"$1.3T",trend:"up"},
  {symbol:"ETH",price:2523,change:-0.31,volume:"16.2B",apy:5.8,cap:"$303B",trend:"down"},
  {symbol:"BNB",price:319.4,change:-0.16,volume:"16.2B",apy:7.1,cap:"$47B",trend:"up"},
  {symbol:"SOL",price:186.26,change:0.28,volume:"12.1B",apy:6.5,cap:"$85B",trend:"up"},
  {symbol:"XRP",price:1.83,change:0.31,volume:"10.0B",apy:3.1,cap:"$99B",trend:"up"},
  {symbol:"ADA",price:0.59,change:-0.82,volume:"24.8B",apy:4.8,cap:"$21B",trend:"down"},
  {symbol:"AVAX",price:84.31,change:0.16,volume:"60.4B",apy:8.2,cap:"$35B",trend:"up"},
  {symbol:"DOGE",price:0.178,change:0.39,volume:"8.2B",apy:0,cap:"$26B",trend:"up"},
  {symbol:"LINK",price:15.02,change:-0.96,volume:"3.1B",apy:4.5,cap:"$9B",trend:"down"},
  {symbol:"DOT",price:7.42,change:0.12,volume:"2.8B",apy:12.5,cap:"$11B",trend:"up"},
];

const SIGNALS = [
  {
    id:1,coin:"BTC",direction:"LONG",confidence:84,risk:"LOW",validMins:45,
    entryLow:66900,entryHigh:67100,sl:66150,tp1:68100,tp2:69300,
    rr:"1:3.2",status:"ACTIVE",
    // SMC Breakdown
    breakdown:{
      htfTrend:90,      // 4H above 200 EMA âœ…
      liquidity:85,     // Previous Low swept âœ…
      bos:88,           // Break of Structure confirmed âœ…
      volume:82,        // Volume spike above 20MA âœ…
      rsi:78,           // RSI divergence confirmed âœ…
    },
    smcChecks:{
      htfBias:"BULLISH",          // 4H HH-HL structure
      ema200:"ABOVE",             // Price above 4H 200 EMA
      liquiditySweep:"LOW_SWEPT", // Previous low swept âœ…
      bos:"CONFIRMED",            // Strong BOS on 15M âœ…
      orderBlock:"IDENTIFIED",    // Fresh OB found âœ…
      retest:"COMPLETED",         // OB retest done âœ…
      volumeSpike:"ABOVE_20MA",   // Volume expansion âœ…
      rsiDiv:"BULLISH_DIV",       // RSI divergence âœ…
      engulfing:"BULLISH",        // Strong engulf candle âœ…
      atr:"ABOVE_AVG",            // Volatility present âœ…
    },
    timeframes:{m15:"LONG",h1:"LONG",h4:"LONG"},
    partialTP:"1:1 ($67,850)",
    trailAfter:"2R ($68,400)",
    marketCondition:"STABLE",
    session:"LONDON",
    newsRisk:"LOW",
    invalidateIf:"Candle close below Order Block $66,150",
  },
  {
    id:2,coin:"ETH",direction:"SHORT",confidence:79,risk:"LOW",validMins:60,
    entryLow:2510,entryHigh:2535,sl:2615,tp1:2400,tp2:2290,
    rr:"1:3.0",status:"ACTIVE",
    breakdown:{
      htfTrend:82,
      liquidity:80,
      bos:85,
      volume:74,
      rsi:76,
    },
    smcChecks:{
      htfBias:"BEARISH",
      ema200:"BELOW",
      liquiditySweep:"HIGH_SWEPT",
      bos:"CONFIRMED",
      orderBlock:"IDENTIFIED",
      retest:"COMPLETED",
      volumeSpike:"ABOVE_20MA",
      rsiDiv:"BEARISH_DIV",
      engulfing:"BEARISH",
      atr:"ABOVE_AVG",
    },
    timeframes:{m15:"SHORT",h1:"SHORT",h4:"SHORT"},
    partialTP:"1:1 ($2,440)",
    trailAfter:"2R ($2,380)",
    marketCondition:"STABLE",
    session:"LONDON",
    newsRisk:"LOW",
    invalidateIf:"Candle close above Supply Zone $2,615",
  },
  {
    id:3,coin:"SOL",direction:"LONG",confidence:71,risk:"MEDIUM",validMins:30,
    entryLow:184,entryHigh:187,sl:179,tp1:196,tp2:205,
    rr:"1:3.1",status:"ACTIVE",
    breakdown:{
      htfTrend:75,
      liquidity:70,
      bos:72,
      volume:65,
      rsi:68,
    },
    smcChecks:{
      htfBias:"BULLISH",
      ema200:"ABOVE",
      liquiditySweep:"LOW_SWEPT",
      bos:"CONFIRMED",
      orderBlock:"IDENTIFIED",
      retest:"PENDING",           // âš ï¸ Retest pending
      volumeSpike:"ABOVE_20MA",
      rsiDiv:"BULLISH_DIV",
      engulfing:"BULLISH",
      atr:"ABOVE_AVG",
    },
    timeframes:{m15:"LONG",h1:"LONG",h4:"LONG"},
    partialTP:"1:1 ($190)",
    trailAfter:"2R ($193)",
    marketCondition:"STABLE",
    session:"NEW_YORK",
    newsRisk:"MEDIUM",
    invalidateIf:"Candle close below Demand Zone $179",
  },
];

// Market condition â€” updated with SMC filters
const MARKET_STATUS={
  condition:"STABLE",
  fearGreed:62,
  btcDominance:52.4,
  volatilityIndex:18.2,
  signalsPaused:false,
  pauseReason:"",
  maxTradesPerSession:2,
  activeTradesCount:2,
  noTradeZones:["High Impact News","Low Liquidity","Sideways/Ranging"],
};

const VIP_SIGNALS = [
  {id:10,coin:"BTC",direction:"LONG",confidence:91,risk:"LOW",validMins:45,entryLow:66800,entryHigh:67000,sl:66200,tp1:68000,tp2:69500,vipOnly:true},
  {id:11,coin:"ETH",direction:"SHORT",confidence:88,risk:"LOW",validMins:30,entryLow:2510,entryHigh:2530,sl:2600,tp1:2400,tp2:2300,vipOnly:true},
  {id:12,coin:"SOL",direction:"LONG",confidence:86,risk:"LOW",validMins:20,entryLow:185,entryHigh:188,sl:180,tp1:196,tp2:205,vipOnly:true},
];

const HISTORY = [
  {coin:"BTC/USDT",dir:"LONG",conf:85,result:"WIN",pnl:"+3.2%",date:"Feb 20"},
  {coin:"ETH/USDT",dir:"SHORT",conf:71,result:"WIN",pnl:"+2.1%",date:"Feb 20"},
  {coin:"SOL/USDT",dir:"LONG",conf:64,result:"LOSS",pnl:"-1.4%",date:"Feb 19"},
  {coin:"BNB/USDT",dir:"LONG",conf:79,result:"WIN",pnl:"+2.8%",date:"Feb 19"},
  {coin:"XRP/USDT",dir:"SHORT",conf:68,result:"WIN",pnl:"+1.9%",date:"Feb 18"},
  {coin:"ADA/USDT",dir:"LONG",conf:73,result:"LOSS",pnl:"-0.9%",date:"Feb 18"},
];

const LEADERBOARD = [
  {rank:1,name:"CryptoKing",signals:142,winRate:89,profit:"+$12,400",badge:"ğŸ†"},
  {rank:2,name:"BullTrader",signals:98,winRate:83,profit:"+$8,200",badge:"ğŸ¥ˆ"},
  {rank:3,name:"SolMaster",signals:87,winRate:81,profit:"+$6,800",badge:"ğŸ¥‰"},
  {rank:4,name:"EthWhale",signals:76,winRate:78,profit:"+$5,100",badge:"â­"},
  {rank:5,name:"You",signals:12,winRate:74,profit:"+$980",badge:"ğŸ‘¤",isMe:true},
];

const NOTIFS = [
  {id:1,icon:"ğŸ“¡",title:"New Signal: BTC LONG 82%",msg:"Entry: $66,900â€“$67,100",time:"2m ago",read:false},
  {id:2,icon:"âœ…",title:"TP1 Hit! ETH SHORT",msg:"+2.1% profit",time:"1h ago",read:false},
  {id:3,icon:"ğŸ””",title:"BTC price alert",msg:"BTC crossed $67,000",time:"2h ago",read:true},
  {id:4,icon:"âš ï¸",title:"Premium expiring",msg:"Expires in 3 days",time:"1d ago",read:true},
];

const ONBOARDING = [
  {icon:"ğŸ§ ",title:"AI-Powered Signals",desc:"5-indicator engine generates high-confidence LONG & SHORT signals on Top 10 coins.",color:"#00F5A0"},
  {icon:"ğŸ¯",title:"Exact Entry & Exit",desc:"Precise entry zone, stop loss, and two take profit targets. No guessing!",color:"#3B82F6"},
  {icon:"ğŸ“Š",title:"Transparent Results",desc:"Every win and loss tracked publicly. Our 74% win rate is real and verified.",color:"#F59E0B"},
  {icon:"ğŸ””",title:"Instant Alerts",desc:"Telegram notifications the moment a new signal drops. Never miss a setup!",color:"#8B5CF6"},
];

const NAV = [
  {id:"dashboard",icon:"âŠ",label:"Dashboard"},
  {id:"signals",icon:"ğŸ“¡",label:"Live Signals"},
  {id:"search",icon:"ğŸ”",label:"Search"},
  {id:"history",icon:"ğŸ“Š",label:"History"},
  {id:"market",icon:"ğŸ”¥",label:"Market"},
  {id:"portfolio",icon:"ğŸ“ˆ",label:"Portfolio"},
  {id:"wallet",icon:"ğŸ’°",label:"Wallet"},
  {id:"leaderboard",icon:"ğŸ†",label:"Leaderboard"},
  {id:"vip",icon:"ğŸ’",label:"VIP Signals"},
  {id:"membership",icon:"ğŸ‘‘",label:"Membership"},
  {id:"notifications",icon:"ğŸ””",label:"Alerts"},
  {id:"profile",icon:"ğŸ‘¤",label:"Profile"},
  {id:"settings",icon:"âš™ï¸",label:"Settings"},
  {id:"autobot",icon:"ğŸ¤–",label:"Auto Trade"},
  {id:"spin",icon:"ğŸ°",label:"Daily Reward"},
  {id:"support",icon:"ğŸ’¬",label:"Support"},
];

function fmt(p){
  if(p>=1000) return p.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",");
  if(p>=1) return p.toFixed(2);
  return p.toFixed(4);
}

// â”€â”€ SMALL COMPONENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Ring({value,color,size=70}){
  const r=(size-10)/2,c=2*Math.PI*r,off=c-(value/100)*c;
  return(
    <svg width={size} height={size} style={{transform:"rotate(-90deg)",flexShrink:0}}>
      <circle cx={size/2} cy={size/2} r={r} fill="none" stroke="#1e2a4044" strokeWidth={5}/>
      <circle cx={size/2} cy={size/2} r={r} fill="none" stroke={color} strokeWidth={5}
        strokeDasharray={c} strokeDashoffset={off} strokeLinecap="round"
        style={{filter:`drop-shadow(0 0 5px ${color})`}}/>
      <text x="50%" y="50%" dominantBaseline="middle" textAnchor="middle" fill={color}
        fontSize={size*0.21} fontWeight="700"
        style={{transform:"rotate(90deg)",transformOrigin:"center",fontFamily:"monospace"}}>
        {value}%
      </text>
    </svg>
  );
}

function Timer({mins,C}){
  const [s,set]=useState(mins*60);
  useEffect(()=>{const t=setInterval(()=>set(x=>Math.max(0,x-1)),1000);return()=>clearInterval(t);},[]);
  const m=Math.floor(s/60),sec=s%60;
  return <span style={{fontFamily:"monospace",color:s<300?C.red:C.orange,fontSize:13,fontWeight:700}}>{m}m {sec.toString().padStart(2,"0")}s</span>;
}

function MiniChart({up,color}){
  const p=up?"0,20 10,15 20,17 30,10 40,12 50,5 60,8":"0,5 10,9 20,7 30,13 40,10 50,18 60,20";
  return <svg width={60} height={25}><polyline points={p} fill="none" stroke={color} strokeWidth={1.8} strokeLinecap="round" strokeLinejoin="round"/></svg>;
}

function Toast({msg,C,onDone}){
  useEffect(()=>{const t=setTimeout(onDone,3000);return()=>clearTimeout(t);},[]);
  return(
    <div style={{position:"fixed",bottom:80,left:"50%",transform:"translateX(-50%)",
      background:C.card,border:`1px solid ${C.neon}55`,color:C.neon,
      padding:"11px 22px",borderRadius:12,fontSize:13,fontWeight:700,
      zIndex:9999,boxShadow:`0 8px 30px ${C.neon}22`,whiteSpace:"nowrap",animation:"slideUp 0.3s ease"}}>
      âœ“ {msg}
    </div>
  );
}

function Toggle({val,set,label,C}){
  return(
    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"13px 0",borderBottom:`1px solid ${C.border}`}}>
      <span style={{color:C.soft,fontSize:13}}>{label}</span>
      <div onClick={()=>set(!val)} style={{width:42,height:22,borderRadius:11,background:val?C.neon:"#2a3a55",position:"relative",cursor:"pointer",transition:"background 0.2s"}}>
        <div style={{position:"absolute",top:3,left:val?22:3,width:16,height:16,borderRadius:"50%",background:val?"#0B0F19":C.dim,transition:"left 0.2s"}}/>
      </div>
    </div>
  );
}

// â”€â”€ RISK DISCLAIMER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function RiskDisclaimer({onAccept,C}){
  const [ok,setOk]=useState(false);
  return(
    <div style={{position:"fixed",inset:0,background:"rgba(0,0,0,0.96)",zIndex:9000,display:"flex",alignItems:"center",justifyContent:"center",padding:20}}>
      <div style={{background:C.card,borderRadius:24,padding:28,maxWidth:400,width:"100%",border:`1px solid ${C.red}44`,animation:"popIn 0.4s ease"}}>
        <div style={{fontSize:40,textAlign:"center",marginBottom:12}}>âš ï¸</div>
        <h2 style={{color:C.red,textAlign:"center",fontSize:18,fontWeight:800,marginBottom:14}}>Risk Disclaimer</h2>
        <div style={{background:`${C.red}12`,border:`1px solid ${C.red}33`,borderRadius:12,padding:14,marginBottom:18,fontSize:12,color:C.soft,lineHeight:1.9}}>
          âš ï¸ <strong style={{color:C.text}}>Signals are for INFORMATIONAL PURPOSES ONLY.</strong><br/>
          ğŸ“Œ We are <strong style={{color:C.red}}>NOT</strong> a licensed financial advisor.<br/>
          ğŸ’¸ Crypto trading involves <strong style={{color:C.red}}>SIGNIFICANT RISK OF LOSS.</strong><br/>
          ğŸš« Never invest more than you can afford to lose.<br/>
          ğŸ“‰ Past performance does <strong style={{color:C.red}}>NOT</strong> guarantee future results.
        </div>
        <div onClick={()=>setOk(!ok)} style={{display:"flex",alignItems:"center",gap:10,marginBottom:20,cursor:"pointer"}}>
          <div style={{width:20,height:20,borderRadius:5,border:`2px solid ${ok?C.neon:C.border}`,background:ok?C.neon:"transparent",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.2s"}}>
            {ok&&<span style={{color:"#0B0F19",fontSize:12,fontWeight:900}}>âœ“</span>}
          </div>
          <span style={{color:C.soft,fontSize:12,lineHeight:1.5}}>I understand the risks. These signals are informational only.</span>
        </div>
        <button onClick={()=>ok&&onAccept()} style={{width:"100%",padding:13,background:ok?C.neon:"#2a3a55",border:"none",borderRadius:12,color:ok?"#0B0F19":C.dim,fontSize:14,fontWeight:800,cursor:ok?"pointer":"not-allowed",transition:"all 0.2s"}}>
          {ok?"I Accept & Continue â†’":"Check the box first"}
        </button>
      </div>
    </div>
  );
}

// â”€â”€ ONBOARDING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Onboarding({onDone,C}){
  const [step,setStep]=useState(0);
  const s=ONBOARDING[step];
  return(
    <div style={{position:"fixed",inset:0,background:C.bg,zIndex:8000,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:24}}>
      <button onClick={onDone} style={{position:"absolute",top:20,right:20,background:"none",border:"none",color:C.dim,fontSize:13,cursor:"pointer"}}>Skip â†’</button>
      <div style={{display:"flex",gap:8,marginBottom:40}}>
        {ONBOARDING.map((_,i)=>(
          <div key={i} style={{width:i===step?28:8,height:8,borderRadius:4,background:i===step?s.color:C.border,transition:"all 0.3s"}}/>
        ))}
      </div>
      <div style={{textAlign:"center",maxWidth:340,animation:"fadeSlideIn 0.4s ease"}}>
        <div style={{fontSize:72,marginBottom:24}}>{s.icon}</div>
        <h2 style={{fontSize:26,fontWeight:900,color:C.text,marginBottom:12}}>{s.title}</h2>
        <p style={{color:C.soft,fontSize:15,lineHeight:1.7,marginBottom:40}}>{s.desc}</p>
      </div>
      <div style={{display:"flex",gap:12,width:"100%",maxWidth:340}}>
        {step>0&&<button onClick={()=>setStep(x=>x-1)} style={{flex:1,padding:13,background:"transparent",border:`1px solid ${C.border}`,color:C.soft,borderRadius:12,fontSize:14,fontWeight:700,cursor:"pointer"}}>â† Back</button>}
        <button onClick={()=>step<ONBOARDING.length-1?setStep(x=>x+1):onDone()} style={{flex:2,padding:13,background:s.color,border:"none",borderRadius:12,color:"#0B0F19",fontSize:14,fontWeight:800,cursor:"pointer",boxShadow:`0 6px 20px ${s.color}44`}}>
          {step===ONBOARDING.length-1?"Get Started ğŸš€":"Next â†’"}
        </button>
      </div>
    </div>
  );
}

// â”€â”€ AUTH SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function AuthScreen({onLogin,C}){
  const [mode,setMode]=useState("login");
  const [form,setForm]=useState({name:"",email:"",pass:""});
  const [loading,setLoading]=useState(false);
  const [err,setErr]=useState("");

  const submit=()=>{
    setErr("");
    if(!form.email.includes("@")){setErr("Valid email daalo");return;}
    if(form.pass.length<6){setErr("Password min 6 chars");return;}
    if(mode==="register"&&!form.name){setErr("Name daalo");return;}
    setLoading(true);
    setTimeout(()=>{
      setLoading(false);
      // Plan detection from email
      const email=form.email.toLowerCase();
      const plan=email.includes("vip")?"vip":email.includes("premium")?"premium":"free";
      const name=form.name||
        (email.includes("vip")?"VIP Trader":
         email.includes("premium")?"Pro Trader":"Trader");
      onLogin({name,email:form.email,plan,ref:"NXS"+Math.random().toString(36).slice(2,8).toUpperCase()});
    },1400);
  };

  return(
    <div style={{minHeight:"100vh",background:C.bg,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:20,position:"relative",overflow:"hidden"}}>
      <div style={{position:"absolute",inset:0,backgroundImage:`linear-gradient(${C.border}20 1px,transparent 1px),linear-gradient(90deg,${C.border}20 1px,transparent 1px)`,backgroundSize:"48px 48px"}}/>
      <div style={{position:"absolute",width:500,height:500,borderRadius:"50%",background:`radial-gradient(circle,${C.neon}08,transparent 70%)`,top:"50%",left:"50%",transform:"translate(-50%,-50%)"}}/>
      <div style={{position:"relative",width:"100%",maxWidth:380,animation:"popIn 0.4s ease"}}>
        <div style={{textAlign:"center",marginBottom:32}}>
          <div style={{fontFamily:"'Space Mono',monospace",fontSize:28,fontWeight:700,letterSpacing:3}}>NEXUS<span style={{color:C.neon}}>PRO</span></div>
          <div style={{fontSize:11,color:C.dim,letterSpacing:2,marginTop:4}}>AI CRYPTO SIGNAL TERMINAL</div>
        </div>
        <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:22,padding:28,boxShadow:"0 20px 60px rgba(0,0,0,0.4)"}}>
          <div style={{display:"flex",background:C.inner,borderRadius:12,padding:4,marginBottom:24}}>
            {["login","register"].map(m=>(
              <button key={m} onClick={()=>{setMode(m);setErr("");}} style={{flex:1,padding:"9px 0",borderRadius:9,border:"none",background:mode===m?C.neon:"transparent",color:mode===m?"#0B0F19":C.dim,fontSize:13,fontWeight:700,cursor:"pointer",transition:"all 0.2s",textTransform:"capitalize"}}>
                {m==="login"?"Sign In":"Sign Up"}
              </button>
            ))}
          </div>
          {mode==="register"&&(
            <div style={{marginBottom:14}}>
              <label style={{display:"block",color:C.soft,fontSize:11,fontWeight:700,marginBottom:5}}>FULL NAME</label>
              <input value={form.name} onChange={e=>setForm(f=>({...f,name:e.target.value}))} placeholder="Your name"
                style={{width:"100%",background:C.inner,border:`1px solid ${C.border}`,color:C.text,padding:"11px 13px",borderRadius:10,fontSize:14,outline:"none",fontFamily:"Rajdhani"}}/>
            </div>
          )}
          <div style={{marginBottom:14}}>
            <label style={{display:"block",color:C.soft,fontSize:11,fontWeight:700,marginBottom:5}}>EMAIL</label>
            <input type="email" value={form.email} onChange={e=>setForm(f=>({...f,email:e.target.value}))} placeholder="your@email.com"
              style={{width:"100%",background:C.inner,border:`1px solid ${C.border}`,color:C.text,padding:"11px 13px",borderRadius:10,fontSize:14,outline:"none",fontFamily:"Rajdhani"}}/>
          </div>
          <div style={{marginBottom:20}}>
            <label style={{display:"block",color:C.soft,fontSize:11,fontWeight:700,marginBottom:5}}>PASSWORD</label>
            <input type="password" value={form.pass} onChange={e=>setForm(f=>({...f,pass:e.target.value}))} placeholder="Min 6 characters"
              style={{width:"100%",background:C.inner,border:`1px solid ${C.border}`,color:C.text,padding:"11px 13px",borderRadius:10,fontSize:14,outline:"none",fontFamily:"Rajdhani"}}
              onKeyDown={e=>e.key==="Enter"&&submit()}/>
          </div>
          {err&&<div style={{color:C.red,fontSize:12,marginBottom:14,textAlign:"center"}}>{err}</div>}
          <button onClick={submit} disabled={loading} style={{width:"100%",padding:13,background:C.neon,border:"none",borderRadius:12,color:"#0B0F19",fontSize:15,fontWeight:800,cursor:"pointer",boxShadow:`0 6px 20px ${C.neon}33`,opacity:loading?0.8:1}}>
            {loading?<span style={{display:"flex",alignItems:"center",justifyContent:"center",gap:8}}><span style={{width:16,height:16,border:"2px solid #0B0F1966",borderTopColor:"#0B0F19",borderRadius:"50%",display:"inline-block",animation:"spin 0.8s linear infinite"}}/>Processing...</span>:(mode==="login"?"Sign In â†’":"Create Account â†’")}
          </button>
          {mode==="login"&&(
            <div style={{marginTop:14}}>
              <div style={{color:C.dim,fontSize:11,textAlign:"center",marginBottom:10,letterSpacing:1,fontWeight:700}}>
                â€” QUICK TEST LOGIN â€”
              </div>
              <div style={{display:"flex",flexDirection:"column",gap:8}}>
                {[
                  {label:"ğŸ†“ Free Account",email:"test@free.com",plan:"Free",color:C.dim},
                  {label:"â­ Premium Account",email:"premium@test.com",plan:"Premium",color:C.neon},
                  {label:"ğŸ’ VIP Account",email:"vip@test.com",plan:"VIP",color:"#F59E0B"},
                ].map((acc,i)=>(
                  <button key={i}
                    onClick={()=>{
                      setForm({email:acc.email,pass:"demo123",name:acc.label.split(" ")[1]});
                      setErr("");
                    }}
                    style={{
                      padding:"10px 14px",
                      background:C.isDark?"#1e2a40":"#F1F5F9",
                      border:`1px solid ${acc.color}44`,
                      borderRadius:10,cursor:"pointer",
                      display:"flex",alignItems:"center",
                      justifyContent:"space-between"}}>
                    <span style={{color:C.text,fontSize:12,fontWeight:600}}>{acc.label}</span>
                    <span style={{color:acc.color,fontSize:10,fontWeight:700,
                      background:`${acc.color}22`,padding:"2px 8px",borderRadius:6}}>
                      {acc.plan}
                    </span>
                  </button>
                ))}
              </div>
              <p style={{textAlign:"center",color:C.dim,fontSize:10,marginTop:10}}>
                Tap any account â†’ auto-fills â†’ Sign In
              </p>
            </div>
          )}

          {/* Divider */}
          <div style={{display:"flex",alignItems:"center",gap:10,margin:"14px 0 12px"}}>
            <div style={{flex:1,height:1,background:C.border}}/>
            <span style={{color:C.dim,fontSize:11,fontWeight:600}}>OR</span>
            <div style={{flex:1,height:1,background:C.border}}/>
          </div>

          {/* Guest Button */}
          <button onClick={()=>onLogin({name:"Guest",email:"",plan:"guest",ref:"GUEST",isGuest:true})}
            style={{width:"100%",padding:12,background:"transparent",border:`2px dashed ${C.border}`,borderRadius:12,color:C.soft,fontSize:14,fontWeight:700,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:8}}
            onMouseEnter={e=>{e.currentTarget.style.borderColor=C.neon;e.currentTarget.style.color=C.neon;e.currentTarget.style.background=C.neon+"11";}}
            onMouseLeave={e=>{e.currentTarget.style.borderColor=C.border;e.currentTarget.style.color=C.soft;e.currentTarget.style.background="transparent";}}>
            ğŸ‘ï¸ Continue as Guest
          </button>
          <p style={{textAlign:"center",color:C.dim,fontSize:11,marginTop:8,lineHeight:1.5}}>
            Limited access Â· No signup needed Â· Upgrade anytime
          </p>
        </div>
      </div>
    </div>
  );
}

// â”€â”€ FOMO HOOK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function useFOMO(baseCount){
  const [count,setCount]=useState(baseCount);
  // PWA Install prompt
  useEffect(()=>{
    // Show PWA banner after 30 seconds
    const t=setTimeout(()=>setShowPWA(true),30000);

    // Capture install prompt (Android)
    const handler=(e)=>{
      e.preventDefault();
      setDeferredPrompt(e);
      setShowPWA(true);
    };
    window.addEventListener("beforeinstallprompt",handler);

    // Handle install button click
    const installBtn=document.getElementById("pwa-install-btn");
    if(installBtn){
      installBtn.addEventListener("click",async()=>{
        if(deferredPrompt){
          deferredPrompt.prompt();
          const{outcome}=await deferredPrompt.userChoice;
          if(outcome==="accepted") setShowPWA(false);
          setDeferredPrompt(null);
        }
      });
    }

    // Register service worker
    if("serviceWorker" in navigator){
      navigator.serviceWorker.register("/sw.js")
        .then(()=>console.log("âœ… NexusPro SW registered"))
        .catch(e=>console.log("SW error:",e));
    }

    return()=>{
      clearTimeout(t);
      window.removeEventListener("beforeinstallprompt",handler);
    };
  },[]);

  useEffect(()=>{    const t=setInterval(()=>{
      // Realistic fluctuation Â±1 to Â±5
      setCount(c=>Math.max(50,c+(Math.random()>0.4?1:-1)*(Math.floor(Math.random()*4)+1)));
    },3000+Math.random()*2000);
    return()=>clearInterval(t);
  },[]);
  return count;
}

// â”€â”€ CONFIDENCE BREAKDOWN BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function BreakdownBar({label,value,color,C}){
  const [width,setWidth]=useState(0);
  useEffect(()=>{setTimeout(()=>setWidth(value),100);},[value]);
  const getColor=v=>v>=80?"#00F5A0":v>=65?"#F59E0B":"#EF4444";
  const barColor=color||getColor(value);
  return(
    <div style={{marginBottom:8}}>
      <div style={{display:"flex",justifyContent:"space-between",marginBottom:3}}>
        <span style={{color:C.soft,fontSize:10,fontWeight:600}}>{label}</span>
        <span style={{color:barColor,fontSize:10,fontWeight:800,fontFamily:"monospace"}}>{value}%</span>
      </div>
      <div style={{height:5,background:C.isDark?"#1e2a40":"#E2E8F0",borderRadius:3,overflow:"hidden"}}>
        <div style={{height:"100%",width:`${width}%`,background:`linear-gradient(90deg,${barColor},${barColor}cc)`,
          borderRadius:3,transition:"width 0.8s ease",boxShadow:`0 0 6px ${barColor}66`}}/>
      </div>
    </div>
  );
}

// â”€â”€ CONFIDENCE SCORE BREAKDOWN PANEL (SMC) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function ConfidenceBreakdown({sig,C}){
  const [open,setOpen]=useState(false);
  if(!sig.breakdown) return null;

  const smcIndicators=[
    {label:"HTF Trend (4H EMA200)",value:sig.breakdown.htfTrend,desc:"Bias"},
    {label:"Liquidity Sweep (15M)",value:sig.breakdown.liquidity,desc:"Hunt"},
    {label:"Break of Structure",value:sig.breakdown.bos,desc:"BOS"},
    {label:"Volume Expansion",value:sig.breakdown.volume,desc:"Strength"},
    {label:"RSI Divergence (5M)",value:sig.breakdown.rsi,desc:"Confirm"},
  ];

  const smcCheckItems=sig.smcChecks?[
    {k:"HTF Bias",v:sig.smcChecks.htfBias,ok:sig.smcChecks.htfBias!=="NEUTRAL"},
    {k:"200 EMA",v:sig.smcChecks.ema200==="ABOVE"?"Price Above âœ“":"Price Below âœ“",ok:true},
    {k:"Liquidity Sweep",v:sig.smcChecks.liquiditySweep==="LOW_SWEPT"?"Low Swept âœ“":"High Swept âœ“",ok:true},
    {k:"Break of Structure",v:sig.smcChecks.bos,ok:sig.smcChecks.bos==="CONFIRMED"},
    {k:"Order Block",v:sig.smcChecks.orderBlock,ok:sig.smcChecks.orderBlock==="IDENTIFIED"},
    {k:"OB Retest",v:sig.smcChecks.retest,ok:sig.smcChecks.retest==="COMPLETED"},
    {k:"Volume Spike",v:"Above 20MA âœ“",ok:sig.smcChecks.volumeSpike==="ABOVE_20MA"},
    {k:"RSI Divergence",v:sig.smcChecks.rsiDiv?.replace("_"," "),ok:true},
    {k:"Engulfing Candle",v:sig.smcChecks.engulfing,ok:true},
    {k:"ATR",v:"Above Average âœ“",ok:sig.smcChecks.atr==="ABOVE_AVG"},
  ]:[];

  const allPassed=smcCheckItems.filter(c=>c.ok).length;
  const total=smcCheckItems.length;
  const allAgree=sig.timeframes?Object.values(sig.timeframes).filter(v=>v===sig.direction).length:0;
  const tfTotal=sig.timeframes?Object.keys(sig.timeframes).length:0;

  return(
    <div style={{marginTop:10}}>
      <button onClick={()=>setOpen(!open)}
        style={{width:"100%",background:C.isDark?"#1a2238":C.inner,
          border:`1px solid ${C.border}`,borderRadius:open?"8px 8px 0 0":8,padding:"8px 12px",
          display:"flex",justifyContent:"space-between",alignItems:"center",
          cursor:"pointer",color:C.soft,fontSize:11,fontWeight:700,transition:"all 0.2s"}}>
        <span>ğŸ§  SMC Analysis</span>
        <div style={{display:"flex",alignItems:"center",gap:8}}>
          <span style={{color:allPassed===total?"#00F5A0":"#F59E0B",fontSize:10,fontWeight:800}}>
            {allPassed}/{total} checks âœ“
          </span>
          <span style={{color:C.dim,fontSize:12}}>{open?"â–²":"â–¼"}</span>
        </div>
      </button>

      {open&&(
        <div style={{background:C.isDark?"#0d1520":"#F8FAFC",border:`1px solid ${C.border}`,
          borderTop:"none",borderRadius:"0 0 8px 8px",padding:"12px 14px",animation:"fadeSlideIn 0.3s ease"}}>

          {/* SMC Score bars */}
          <div style={{color:C.dim,fontSize:9,letterSpacing:1,fontWeight:700,marginBottom:8}}>SMC SCORE</div>
          {smcIndicators.map((ind,i)=>(
            <BreakdownBar key={i} label={`${ind.label}`} value={ind.value} C={C}/>
          ))}

          {/* SMC Checklist */}
          {smcCheckItems.length>0&&<>
            <div style={{color:C.dim,fontSize:9,letterSpacing:1,fontWeight:700,margin:"12px 0 8px"}}>
              SMC CHECKLIST ({allPassed}/{total} PASSED)
            </div>
            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4,marginBottom:12}}>
              {smcCheckItems.map((c,i)=>(
                <div key={i} style={{display:"flex",alignItems:"center",gap:5,
                  background:c.ok?`${C.neon}10`:"#EF444410",
                  border:`1px solid ${c.ok?`${C.neon}22`:"#EF444422"}`,
                  borderRadius:6,padding:"4px 7px"}}>
                  <span style={{fontSize:10,flexShrink:0}}>{c.ok?"âœ…":"âš ï¸"}</span>
                  <div style={{minWidth:0}}>
                    <div style={{color:C.dim,fontSize:8,fontWeight:700,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{c.k}</div>
                    <div style={{color:c.ok?C.neon:"#F59E0B",fontSize:8,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{c.v}</div>
                  </div>
                </div>
              ))}
            </div>
          </>}

          {/* Timeframe alignment */}
          {sig.timeframes&&(
            <div style={{marginBottom:10}}>
              <div style={{color:C.dim,fontSize:9,letterSpacing:1,fontWeight:700,marginBottom:6}}>TIMEFRAME ALIGNMENT</div>
              <div style={{display:"flex",gap:6}}>
                {Object.entries(sig.timeframes).map(([tf,dir],i)=>{
                  const agree=dir===sig.direction;
                  return(
                    <div key={i} style={{flex:1,background:agree?`#00F5A018`:"#EF444418",
                      border:`1px solid ${agree?"#00F5A044":"#EF444433"}`,
                      borderRadius:8,padding:"6px 4px",textAlign:"center"}}>
                      <div style={{color:C.dim,fontSize:9,fontWeight:700}}>{tf.toUpperCase()}</div>
                      <div style={{fontSize:9,fontWeight:800,color:agree?"#00F5A0":"#EF4444",marginTop:2}}>
                        {agree?"âœ“":"âœ—"} {dir}
                      </div>
                    </div>
                  );
                })}
              </div>
              <div style={{marginTop:6,textAlign:"center",fontSize:11,fontWeight:700,
                color:allAgree===tfTotal?"#00F5A0":"#F59E0B"}}>
                {allAgree===tfTotal?"âœ… All TF Aligned â€” High Probability!":"âš ï¸ Mixed TF â€” Reduce position size"}
              </div>
            </div>
          )}

          {/* Partial TP + Trail info */}
          {sig.partialTP&&(
            <div style={{display:"flex",gap:6,marginBottom:10}}>
              <div style={{flex:1,background:"#00F5A010",border:"1px solid #00F5A033",borderRadius:8,padding:"7px 10px"}}>
                <div style={{color:C.dim,fontSize:9,fontWeight:700}}>PARTIAL TP</div>
                <div style={{color:"#00F5A0",fontSize:11,fontWeight:700,marginTop:2}}>{sig.partialTP}</div>
              </div>
              <div style={{flex:1,background:"#3B82F610",border:"1px solid #3B82F633",borderRadius:8,padding:"7px 10px"}}>
                <div style={{color:C.dim,fontSize:9,fontWeight:700}}>TRAIL AFTER</div>
                <div style={{color:"#3B82F6",fontSize:11,fontWeight:700,marginTop:2}}>{sig.trailAfter}</div>
              </div>
            </div>
          )}

          {/* Session + News Risk */}
          {sig.session&&(
            <div style={{display:"flex",gap:6,marginBottom:10}}>
              <div style={{background:C.isDark?"#1a2238":C.inner,borderRadius:8,padding:"6px 10px",flex:1}}>
                <div style={{color:C.dim,fontSize:9}}>SESSION</div>
                <div style={{color:C.text,fontSize:11,fontWeight:700}}>ğŸ• {sig.session}</div>
              </div>
              <div style={{background:sig.newsRisk==="LOW"?"#00F5A010":"#F59E0B10",
                border:`1px solid ${sig.newsRisk==="LOW"?"#00F5A033":"#F59E0B33"}`,
                borderRadius:8,padding:"6px 10px",flex:1}}>
                <div style={{color:C.dim,fontSize:9}}>NEWS RISK</div>
                <div style={{color:sig.newsRisk==="LOW"?"#00F5A0":"#F59E0B",fontSize:11,fontWeight:700}}>
                  {sig.newsRisk==="LOW"?"ğŸŸ¢":"ğŸŸ¡"} {sig.newsRisk}
                </div>
              </div>
            </div>
          )}

          {/* Invalidation */}
          {sig.invalidateIf&&(
            <div style={{background:"#EF444415",border:"1px solid #EF444433",borderRadius:8,padding:"8px 10px"}}>
              <div style={{color:"#EF4444",fontSize:10,fontWeight:800,marginBottom:2}}>ğŸ”” INVALIDATES IF:</div>
              <div style={{color:"#9CA3AF",fontSize:11}}>{sig.invalidateIf}</div>
            </div>
          )}
        </div>
      )}
    </div>
  );
}

// â”€â”€ MARKET CONDITION BANNER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function MarketConditionBanner({C}){
  const [market,setMarket]=useState(MARKET_STATUS);
  const [expanded,setExpanded]=useState(false);

  // Simulate market changes
  useEffect(()=>{
    const t=setInterval(()=>{
      setMarket(m=>({
        ...m,
        fearGreed:Math.min(100,Math.max(0,m.fearGreed+(Math.random()-0.5)*3)),
        volatilityIndex:Math.max(10,m.volatilityIndex+(Math.random()-0.5)*1.5),
      }));
    },5000);
    return()=>clearInterval(t);
  },[]);

  const fg=market.fearGreed;
  const vi=market.volatilityIndex;
  const isVolatile=vi>30;
  const isExtreme=vi>50;

  const fgLabel=fg<25?"Extreme Fear":fg<45?"Fear":fg<55?"Neutral":fg<75?"Greed":"Extreme Greed";
  const fgColor=fg<25?"#EF4444":fg<45?"#F59E0B":fg<55?"#9CA3AF":fg<75?"#00F5A0":"#00F5A0";
  const condColor=isExtreme?"#EF4444":isVolatile?"#F59E0B":"#00F5A0";
  const condLabel=isExtreme?"âš ï¸ EXTREME VOLATILITY":isVolatile?"ğŸŸ¡ HIGH VOLATILITY":"âœ… STABLE MARKET";

  return(
    <div style={{marginBottom:12}}>
      <div onClick={()=>setExpanded(!expanded)}
        style={{background:isExtreme?`#EF444415`:isVolatile?`#F59E0B15`:`${C.neon}10`,
          border:`1px solid ${condColor}44`,borderRadius:10,
          padding:"9px 14px",cursor:"pointer",
          display:"flex",justifyContent:"space-between",alignItems:"center"}}>
        <div style={{display:"flex",alignItems:"center",gap:8}}>
          <span style={{width:8,height:8,borderRadius:"50%",background:condColor,
            display:"inline-block",animation:isVolatile?"blink 1s infinite":"none"}}/>
          <span style={{color:condColor,fontWeight:800,fontSize:12}}>{condLabel}</span>
        </div>
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          <span style={{color:C.dim,fontSize:10}}>VI: <span style={{color:condColor,fontWeight:700}}>{vi.toFixed(1)}</span></span>
          <span style={{color:C.dim,fontSize:12}}>{expanded?"â–²":"â–¼"}</span>
        </div>
      </div>

      {expanded&&(
        <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:"0 0 10px 10px",
          padding:14,animation:"fadeSlideIn 0.3s ease"}}>
          
          {/* Fear & Greed */}
          <div style={{marginBottom:12}}>
            <div style={{display:"flex",justifyContent:"space-between",marginBottom:5}}>
              <span style={{color:C.dim,fontSize:11,fontWeight:700}}>ğŸ˜¨ Fear & Greed Index</span>
              <span style={{color:fgColor,fontWeight:800,fontSize:12}}>{Math.round(fg)} â€” {fgLabel}</span>
            </div>
            <div style={{height:8,background:C.isDark?"#1e2a40":C.inner,borderRadius:4,overflow:"hidden",position:"relative"}}>
              <div style={{position:"absolute",inset:0,background:"linear-gradient(90deg,#EF4444,#F59E0B,#9CA3AF,#00F5A0,#00F5A0)",borderRadius:4,opacity:0.5}}/>
              <div style={{position:"absolute",top:"50%",left:`${fg}%`,transform:"translate(-50%,-50%)",
                width:14,height:14,borderRadius:"50%",background:fgColor,
                border:`2px solid ${C.card}`,boxShadow:`0 0 8px ${fgColor}`}}/>
            </div>
            <div style={{display:"flex",justifyContent:"space-between",marginTop:3,fontSize:9,color:C.dim}}>
              <span>Fear</span><span>Neutral</span><span>Greed</span>
            </div>
          </div>

          {/* Stats row */}
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:8}}>
            {[
              {l:"Volatility",v:`${vi.toFixed(1)}`,unit:"VI",c:condColor},
              {l:"BTC Dom.",v:`${market.btcDominance}%`,unit:"",c:C.blue},
              {l:"Signals",v:isExtreme?"PAUSED":isVolatile?"LIMITED":"ACTIVE",unit:"",c:condColor},
            ].map((s,i)=>(
              <div key={i} style={{background:C.isDark?"#1a2238":C.inner,borderRadius:8,padding:"8px 6px",textAlign:"center"}}>
                <div style={{color:s.c,fontWeight:800,fontSize:11,fontFamily:"monospace"}}>{s.v}{s.unit}</div>
                <div style={{color:C.dim,fontSize:9,marginTop:2}}>{s.l}</div>
              </div>
            ))}
          </div>

          {/* Warning if volatile */}
          {isVolatile&&(
            <div style={{marginTop:10,background:"#F59E0B15",border:"1px solid #F59E0B44",
              borderRadius:8,padding:"8px 12px",fontSize:11}}>
              <span style={{color:"#F59E0B",fontWeight:700}}>âš ï¸ Caution: </span>
              <span style={{color:"#9CA3AF"}}>
                {isExtreme
                  ?"Extreme volatility â€” Signals paused. Tighten existing SL immediately!"
                  :"High volatility â€” Reduce position size 50%. Only 1:3+ RR trades."}
              </span>
            </div>
          )}

          {/* SMC Core Rules reminder */}
          <div style={{marginTop:10,background:C.isDark?"#1a2238":C.inner,borderRadius:8,padding:"10px 12px"}}>
            <div style={{color:C.dim,fontSize:9,fontWeight:700,letterSpacing:1,marginBottom:6}}>ğŸ”’ ACTIVE TRADE RULES</div>
            {[
              {rule:"Risk per trade",val:"1% max",ok:true},
              {rule:"Max trades/session",val:`${MARKET_STATUS.activeTradesCount}/${MARKET_STATUS.maxTradesPerSession}`,ok:MARKET_STATUS.activeTradesCount<MARKET_STATUS.maxTradesPerSession},
              {rule:"Min Risk:Reward",val:"1:3 required",ok:true},
              {rule:"News filter",val:"Active âœ“",ok:true},
            ].map((r,i)=>(
              <div key={i} style={{display:"flex",justifyContent:"space-between",
                padding:"4px 0",borderBottom:i<3?`1px solid ${C.border}`:"none",fontSize:11}}>
                <span style={{color:C.soft}}>{r.rule}</span>
                <span style={{color:r.ok?"#00F5A0":"#EF4444",fontWeight:700}}>{r.val}</span>
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
}

// â”€â”€ SIGNAL INVALIDATION TRACKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function InvalidationTracker({signals,C}){
  const [statuses,setStatuses]=useState(
    signals.reduce((a,s)=>({...a,[s.id]:{status:"ACTIVE",reason:"",changedAt:null}}),{})
  );
  const [showAll,setShowAll]=useState(false);

  // Simulate random invalidation for demo
  useEffect(()=>{
    const t=setTimeout(()=>{
      // SOL signal gets invalidated after 30s for demo
      setStatuses(prev=>({...prev,
        3:{status:"INVALIDATED",reason:"Price closed below $182 â€” conditions changed",changedAt:new Date().toLocaleTimeString()}
      }));
    },30000);
    return()=>clearTimeout(t);
  },[]);

  const active=Object.values(statuses).filter(s=>s.status==="ACTIVE").length;
  const invalidated=Object.values(statuses).filter(s=>s.status==="INVALIDATED").length;

  return(
    <div style={{marginBottom:12}}>
      <div onClick={()=>setShowAll(!showAll)}
        style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:10,
          padding:"9px 14px",cursor:"pointer",
          display:"flex",justifyContent:"space-between",alignItems:"center"}}>
        <div style={{display:"flex",alignItems:"center",gap:8}}>
          <span style={{fontSize:14}}>ğŸ””</span>
          <span style={{color:C.text,fontWeight:700,fontSize:12}}>Signal Status Tracker</span>
        </div>
        <div style={{display:"flex",gap:8,alignItems:"center"}}>
          <span style={{background:"#00F5A022",color:"#00F5A0",padding:"2px 8px",borderRadius:6,fontSize:10,fontWeight:700}}>{active} Active</span>
          {invalidated>0&&<span style={{background:"#EF444422",color:"#EF4444",padding:"2px 8px",borderRadius:6,fontSize:10,fontWeight:700}}>{invalidated} Cancelled</span>}
          <span style={{color:C.dim,fontSize:12}}>{showAll?"â–²":"â–¼"}</span>
        </div>
      </div>

      {showAll&&(
        <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:"0 0 10px 10px",padding:10,animation:"fadeSlideIn 0.3s ease"}}>
          {signals.map((sig,i)=>{
            const st=statuses[sig.id];
            const isActive=st.status==="ACTIVE";
            const glow=sig.direction==="LONG"?"#00F5A0":"#EF4444";
            return(
              <div key={i} style={{display:"flex",alignItems:"center",gap:10,padding:"8px 10px",
                background:isActive?`${glow}08`:"#EF444408",
                borderRadius:8,marginBottom:i<signals.length-1?6:0,
                border:`1px solid ${isActive?`${glow}22`:"#EF444422"}`}}>
                <div style={{width:8,height:8,borderRadius:"50%",
                  background:isActive?glow:"#EF4444",flexShrink:0,
                  animation:isActive?"blink 2s infinite":"none"}}/>
                <div style={{flex:1,minWidth:0}}>
                  <div style={{display:"flex",gap:6,alignItems:"center"}}>
                    <span style={{color:C.text,fontWeight:700,fontSize:12}}>{sig.coin}/USDT</span>
                    <span style={{color:glow,fontSize:9,fontWeight:700}}>{sig.direction}</span>
                  </div>
                  {!isActive&&<div style={{color:"#EF4444",fontSize:10,marginTop:2}}>{st.reason}</div>}
                  {!isActive&&<div style={{color:C.dim,fontSize:9}}>{st.changedAt}</div>}
                </div>
                <span style={{color:isActive?glow:"#EF4444",fontWeight:800,fontSize:10,
                  background:isActive?`${glow}15`:"#EF444415",
                  padding:"3px 8px",borderRadius:6,flexShrink:0,whiteSpace:"nowrap"}}>
                  {isActive?"â— ACTIVE":"âœ— CANCELLED"}
                </span>
              </div>
            );
          })}
          <p style={{color:C.dim,fontSize:10,textAlign:"center",marginTop:8}}>
            ğŸ”” You'll be notified instantly when a signal is cancelled
          </p>
        </div>
      )}
    </div>
  );
}

// â”€â”€ SIGNAL CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function SigCard({sig,onChart,onShare,C,isGuest,onSignup,locked}){
  const isLong=sig.direction==="LONG";
  const glow=isLong?C.neon:C.red;
  const [hover,setHover]=useState(false);
  const [secs,setSecs]=useState(sig.validMins*60);
  const traders=useFOMO(600+sig.id*80+Math.floor(Math.random()*200));
  const viewers=useFOMO(12+sig.id*7);
  const isUrgent=secs<300; // <5 mins
  const isCritical=secs<60; // <1 min

  useEffect(()=>{
    const t=setInterval(()=>setSecs(x=>Math.max(0,x-1)),1000);
    return()=>clearInterval(t);
  },[]);

  const mm=Math.floor(secs/60),ss=secs%60;
  const timeStr=`${mm}m ${ss.toString().padStart(2,"0")}s`;

  return(
    <div onMouseEnter={()=>setHover(true)} onMouseLeave={()=>setHover(false)}
      style={{background:C.isDark?"linear-gradient(135deg,#151C2F,#0d1320)":`linear-gradient(135deg,${C.card},${C.inner})`,
        border:`2px solid ${isCritical?C.red:isUrgent?C.orange:glow}44`,
        borderRadius:16,padding:"18px",
        boxShadow:hover?`0 8px 36px ${glow}30`:`0 0 20px ${isCritical?C.red:glow}14`,
        flex:"1 1 260px",minWidth:255,position:"relative",overflow:"hidden",
        transform:hover?"translateY(-4px)":"translateY(0)",transition:"all 0.2s",
        animation:"fadeSlideIn 0.5s ease both"}}>

      {/* Urgency pulse border */}
      {isUrgent&&<div style={{position:"absolute",inset:0,borderRadius:16,border:`2px solid ${isCritical?C.red:C.orange}`,animation:"urgencyPulse 1s ease-in-out infinite",pointerEvents:"none"}}/>}

      <div style={{position:"absolute",top:-35,right:-35,width:100,height:100,background:`radial-gradient(circle,${glow}20 0%,transparent 70%)`,borderRadius:"50%",pointerEvents:"none"}}/>

      {/* FOMO Top Bar */}
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",
        background:isCritical?`${C.red}18`:isUrgent?`${C.orange}15`:`${glow}10`,
        borderRadius:8,padding:"5px 10px",marginBottom:12,gap:8,flexWrap:"wrap"}}>
        {/* Traders count */}
        <div style={{display:"flex",alignItems:"center",gap:5}}>
          <span style={{width:7,height:7,borderRadius:"50%",background:C.neon,display:"inline-block",animation:"blink 1s infinite",flexShrink:0}}/>
          <span style={{color:C.text,fontSize:11,fontWeight:700}}>
            âš¡ <span style={{color:C.neon}}>{traders.toLocaleString()}</span> traders
          </span>
        </div>
        {/* Viewers */}
        <div style={{display:"flex",alignItems:"center",gap:4}}>
          <span style={{fontSize:10}}>ğŸ‘ï¸</span>
          <span style={{color:C.dim,fontSize:10,fontWeight:600}}>{viewers} viewing</span>
        </div>
      </div>

      {/* Coin + Direction */}
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}}>
        <div><span style={{color:C.text,fontWeight:800,fontSize:18}}>{sig.coin}</span><span style={{color:C.dim,fontSize:13}}>/USDT</span></div>
        <span style={{background:`${glow}22`,color:glow,border:`1px solid ${glow}55`,padding:"2px 12px",borderRadius:6,fontSize:10,fontWeight:700,letterSpacing:1.5}}>{sig.direction}</span>
      </div>

      {/* Confidence + chart + ring */}
      <div style={{display:"flex",alignItems:"center",gap:10,marginBottom:12}}>
        <div>
          <div style={{fontSize:40,fontWeight:900,color:C.text,fontFamily:"monospace",lineHeight:1}}>{sig.confidence}<span style={{fontSize:16,color:C.soft}}>%</span></div>
          {/* Countdown with urgency */}
          <div style={{display:"flex",alignItems:"center",gap:5,marginTop:3}}>
            <span style={{fontSize:10}}>â°</span>
            <span style={{color:isCritical?C.red:isUrgent?C.orange:C.dim,fontSize:11,fontWeight:isCritical?800:600,
              animation:isCritical?"criticalBlink 0.5s infinite":"none"}}>
              {isCritical?"ğŸ”´ LAST CHANCE: ":isUrgent?"âš ï¸ Expires: ":""}{timeStr}
            </span>
          </div>
        </div>
        <div style={{flex:1,display:"flex",justifyContent:"center"}}><MiniChart up={isLong} color={glow}/></div>
        <Ring value={sig.confidence} color={glow} size={70}/>
      </div>

      {/* Risk + urgency badge */}
      <div style={{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"}}>
        <span style={{background:C.isDark?"#1e2a40":C.inner,color:C.soft,padding:"3px 10px",borderRadius:20,fontSize:10,fontWeight:600,letterSpacing:1}}>{sig.risk} RISK</span>
        {sig.marketCondition==="VOLATILE"&&<span style={{background:"#F59E0B22",color:"#F59E0B",padding:"3px 8px",borderRadius:20,fontSize:9,fontWeight:700}}>âš ï¸ VOLATILE MKT</span>}
        {sig.timeframes&&Object.values(sig.timeframes).every(v=>v===sig.direction)&&<span style={{background:"#00F5A022",color:"#00F5A0",padding:"3px 8px",borderRadius:20,fontSize:9,fontWeight:700}}>âœ… ALL TF ALIGNED</span>}
        {isUrgent&&!isCritical&&<span style={{background:`${C.orange}22`,color:C.orange,padding:"3px 10px",borderRadius:20,fontSize:10,fontWeight:700,animation:"blink 1.5s infinite"}}>âš ï¸ EXPIRING SOON</span>}
        {isCritical&&<span style={{background:`${C.red}22`,color:C.red,padding:"3px 10px",borderRadius:20,fontSize:10,fontWeight:800,animation:"criticalBlink 0.5s infinite"}}>ğŸ”´ LAST CHANCE!</span>}
      </div>

      {/* Signal data */}
      <div style={{fontSize:12,color:C.soft,lineHeight:2,marginTop:12}}>
        <div style={{display:"flex",justifyContent:"space-between"}}><span>Entry Zone:</span><span style={{color:C.text,fontFamily:"monospace"}}>${fmt(sig.entryLow)} â€“ ${fmt(sig.entryHigh)}</span></div>
        <div style={{display:"flex",justifyContent:"space-between"}}><span>Stop Loss:</span><span style={{color:C.red,fontFamily:"monospace",fontWeight:700}}>${fmt(sig.sl)}</span></div>
        {[{l:"Take Profit 1",v:sig.tp1},{l:"Take Profit 2",v:sig.tp2}].map((tp,i)=>(
          <div key={i} style={{display:"flex",justifyContent:"space-between",background:C.isDark?"#1a2238":C.inner,borderRadius:8,padding:"5px 10px",marginTop:4}}>
            <span style={{color:C.dim}}>{tp.l}</span><span style={{color:glow,fontFamily:"monospace",fontWeight:700}}>${fmt(tp.v)}</span>
          </div>
        ))}
      </div>

      {/* Action buttons */}
      {/* R:R Ratio */}
      {sig.rr&&(
        <div style={{display:"flex",alignItems:"center",gap:6,marginTop:10,padding:"6px 10px",
          background:C.isDark?"#1a2238":C.inner,borderRadius:8}}>
          <span style={{color:C.dim,fontSize:11}}>Risk:Reward</span>
          <span style={{color:glow,fontWeight:800,fontSize:13,fontFamily:"monospace",marginLeft:"auto"}}>{sig.rr}</span>
          <span style={{background:`${glow}20`,color:glow,fontSize:9,fontWeight:700,padding:"2px 6px",borderRadius:4}}>
            {parseFloat(sig.rr.split(":")[1])>=2?"GOOD":"OK"}
          </span>
        </div>
      )}

      {/* Confidence breakdown toggle */}
      <ConfidenceBreakdown sig={sig} C={C}/>

      <div style={{display:"flex",gap:8,marginTop:10}}>
        <button onClick={()=>locked?onSignup():onChart(sig)} style={{flex:1,background:locked?`${C.dim}18`:`${glow}18`,border:`1px solid ${locked?C.dim:glow}44`,color:locked?C.dim:glow,borderRadius:8,padding:"9px 0",fontSize:12,fontWeight:700,cursor:"pointer"}}>ğŸ“ˆ Chart</button>
        <button onClick={()=>locked?onSignup():onShare(sig)} style={{flex:1,background:C.isDark?"#1e2a40":C.inner,border:`1px solid ${C.border}`,color:C.soft,borderRadius:8,padding:"9px 0",fontSize:12,fontWeight:700,cursor:"pointer"}}>â†‘ Share</button>
      </div>

      {/* Locked overlay for guest */}
      {locked&&(
        <div style={{position:"absolute",inset:0,borderRadius:16,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backdropFilter:"blur(6px)",background:"rgba(11,15,25,0.7)",cursor:"pointer",zIndex:10}} onClick={onSignup}>
          <div style={{fontSize:32,marginBottom:8}}>ğŸ”’</div>
          <div style={{color:C.text,fontWeight:800,fontSize:14,marginBottom:4}}>Locked</div>
          <div style={{color:C.dim,fontSize:12,marginBottom:14,textAlign:"center",padding:"0 20px"}}>Sign up free to unlock all signals</div>
          <button style={{background:C.neon,color:"#0B0F19",border:"none",borderRadius:10,padding:"9px 22px",fontSize:13,fontWeight:800,cursor:"pointer"}}>Sign Up Free â†’</button>
        </div>
      )}
    </div>
  );
}

// â”€â”€ PWA INSTALL BANNER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function PWAInstallBanner({C,onDismiss}){
  return(
    <div style={{position:"fixed",bottom:48,left:10,right:10,zIndex:7000,
      background:`linear-gradient(135deg,${C.isDark?"#0f1e30":"#fff"},${C.isDark?"#0d1a28":"#f0fdf4"})`,
      border:`2px solid ${C.neon}66`,borderRadius:18,padding:"14px 16px",
      boxShadow:`0 8px 40px rgba(0,0,0,0.5),0 0 30px ${C.neon}22`,
      animation:"slideUp 0.4s ease"}}>
      <div style={{display:"flex",alignItems:"center",gap:12}}>
        {/* App icon */}
        <div style={{width:52,height:52,borderRadius:14,
          background:`linear-gradient(135deg,#0B0F19,#151C2F)`,
          border:`2px solid ${C.neon}44`,flexShrink:0,
          display:"flex",alignItems:"center",justifyContent:"center",
          boxShadow:`0 4px 12px ${C.neon}33`}}>
          <div style={{fontFamily:"monospace",fontWeight:900,fontSize:11,textAlign:"center",lineHeight:1.2}}>
            <span style={{color:C.neon}}>N</span>
            <span style={{color:"#fff",fontSize:9,display:"block"}}>PRO</span>
          </div>
        </div>

        {/* Text */}
        <div style={{flex:1,minWidth:0}}>
          <div style={{color:C.text,fontWeight:800,fontSize:14}}>Install NexusPro</div>
          <div style={{color:C.dim,fontSize:11,marginTop:2}}>
            Add to home screen â€” works like a real app!
          </div>
          <div style={{display:"flex",gap:8,marginTop:4}}>
            {["ğŸ“¡ Live signals","ğŸ”” Notifications","âš¡ Fast & offline"].map((f,i)=>(
              <span key={i} style={{color:C.neon,fontSize:9,fontWeight:600}}>{f}</span>
            ))}
          </div>
        </div>
      </div>

      {/* Buttons */}
      <div style={{display:"flex",gap:8,marginTop:12}}>
        <button onClick={onDismiss}
          style={{flex:1,padding:"9px 0",background:"transparent",
            border:`1px solid ${C.border}`,borderRadius:10,
            color:C.dim,fontSize:12,fontWeight:600,cursor:"pointer"}}>
          Not now
        </button>
        <button id="pwa-install-btn"
          style={{flex:2,padding:"9px 0",
            background:`linear-gradient(90deg,${C.neon},#00c4a0)`,
            border:"none",borderRadius:10,color:"#0B0F19",
            fontSize:13,fontWeight:800,cursor:"pointer",
            boxShadow:`0 4px 16px ${C.neon}44`}}>
          ğŸ“² Install App â€” FREE
        </button>
      </div>

      {/* iOS instructions */}
      <div style={{marginTop:10,background:C.isDark?"#1a2238":C.inner,
        borderRadius:10,padding:"8px 12px",fontSize:11,color:C.dim,textAlign:"center"}}>
        ğŸ“± <strong style={{color:C.soft}}>iPhone:</strong> Tap <strong style={{color:C.neon}}>Share â†‘</strong> â†’ <strong style={{color:C.neon}}>"Add to Home Screen"</strong>
      </div>
    </div>
  );
}

// â”€â”€ GUEST SIGNUP POPUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function GuestSignupPopup({onClose,onGoSignup,C}){
  return(
    <div onClick={onClose} style={{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(6px)",zIndex:6000,display:"flex",alignItems:"center",justifyContent:"center",padding:20}}>
      <div onClick={e=>e.stopPropagation()} style={{background:C.card,borderRadius:22,padding:28,maxWidth:360,width:"100%",border:`1px solid ${C.neon}44`,animation:"popIn 0.3s ease",textAlign:"center"}}>
        <div style={{fontSize:48,marginBottom:14}}>ğŸ”’</div>
        <h2 style={{fontSize:20,fontWeight:900,color:C.text,marginBottom:8}}>This Feature is Locked</h2>
        <p style={{color:C.soft,fontSize:13,lineHeight:1.7,marginBottom:22}}>
          Create a <strong style={{color:C.neon}}>FREE account</strong> to unlock all signals, charts, history and more!
        </p>
        <div style={{background:C.inner,borderRadius:14,padding:14,marginBottom:22}}>
          {["All free signals (1/day)","Signal history","Portfolio tracker","Market data","Leaderboard"].map((f,i)=>(
            <div key={i} style={{display:"flex",gap:8,padding:"5px 0",borderBottom:i<4?`1px solid ${C.border}`:"none",fontSize:13,color:C.soft,textAlign:"left"}}>
              <span style={{color:C.neon}}>âœ“</span>{f}
            </div>
          ))}
        </div>
        <button onClick={onGoSignup} style={{width:"100%",padding:13,background:C.neon,border:"none",borderRadius:12,color:"#0B0F19",fontSize:15,fontWeight:800,cursor:"pointer",marginBottom:10,boxShadow:`0 6px 20px ${C.neon}33`}}>
          ğŸš€ Sign Up Free â€” Takes 30 seconds
        </button>
        <button onClick={onClose} style={{width:"100%",padding:10,background:"transparent",border:`1px solid ${C.border}`,borderRadius:12,color:C.dim,fontSize:13,fontWeight:600,cursor:"pointer"}}>
          Continue as Guest
        </button>
      </div>
    </div>
  );
}

// â”€â”€ MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Modal({type,signal,onClose,toast,C}){
  if(!type) return null;
  return(
    <div onClick={onClose} style={{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(6px)",zIndex:5000,display:"flex",alignItems:"center",justifyContent:"center",padding:20}}>
      <div onClick={e=>e.stopPropagation()} style={{background:C.card,borderRadius:20,padding:26,width:"100%",maxWidth:400,position:"relative",border:`1px solid ${C.border}`,animation:"popIn 0.3s ease",maxHeight:"90vh",overflowY:"auto"}}>
        <button onClick={onClose} style={{position:"absolute",top:12,right:14,background:"none",border:"none",color:C.dim,fontSize:22,cursor:"pointer",lineHeight:1}}>Ã—</button>

        {type==="vip"&&<>
          <div style={{fontSize:40,textAlign:"center",marginBottom:10}}>ğŸ’</div>
          <h2 style={{textAlign:"center",fontSize:19,fontWeight:800,marginBottom:4,color:"#F59E0B"}}>Upgrade to VIP</h2>
          <p style={{color:C.soft,fontSize:12,textAlign:"center",marginBottom:18}}>Ultra signals 85%+ Â· Early access Â· Elite support</p>
          <div style={{background:C.inner,borderRadius:12,padding:14,marginBottom:18}}>
            {["5 VIP signals/day (85%+)","Early access +2 minutes","1-on-1 Telegram support","50% referral commission","Monthly strategy call","ğŸ’ VIP badge on leaderboard"].map((f,i)=>(
              <div key={i} style={{display:"flex",gap:8,padding:"6px 0",borderBottom:i<5?`1px solid ${C.border}`:"none",fontSize:13,color:C.soft}}>
                <span style={{color:"#F59E0B"}}>âœ“</span>{f}
              </div>
            ))}
          </div>
          <div style={{textAlign:"center",marginBottom:14}}><span style={{fontSize:34,fontWeight:900,fontFamily:"monospace",color:"#F59E0B"}}>$99</span><span style={{color:C.dim,fontSize:13}}>/month</span></div>
          <button onClick={()=>{window.open("https://buy.stripe.com/vip_link","_blank");closeModal();}} style={{width:"100%",padding:13,background:"linear-gradient(90deg,#F59E0B,#d97706)",border:"none",borderRadius:12,color:"#0B0F19",fontSize:14,fontWeight:800,cursor:"pointer",boxShadow:"0 6px 20px #F59E0B33"}}>ğŸ’ Get VIP Access â†’</button>
          <p style={{textAlign:"center",color:C.dim,fontSize:10,marginTop:8}}>Cancel anytime Â· Stripe secured</p>
        </>}

        {type==="upgrade"&&<>
          <div style={{fontSize:34,textAlign:"center",marginBottom:10}}>ğŸ‘‘</div>
          <h2 style={{textAlign:"center",fontSize:19,fontWeight:800,marginBottom:6}}>Upgrade to Premium</h2>
          <p style={{color:C.soft,fontSize:12,textAlign:"center",marginBottom:18}}>All signals Â· Telegram alerts Â· Full history</p>
          <div style={{background:C.inner,borderRadius:12,padding:14,marginBottom:18}}>
            {["All signals (30/day)","High confidence 75%+","Telegram instant alerts","Full signal history","Priority support"].map((f,i)=>(
              <div key={i} style={{display:"flex",gap:8,padding:"6px 0",borderBottom:i<4?`1px solid ${C.border}`:"none",fontSize:13,color:C.soft}}>
                <span style={{color:C.neon}}>âœ“</span>{f}
              </div>
            ))}
          </div>
          <div style={{textAlign:"center",marginBottom:14}}><span style={{fontSize:34,fontWeight:900,fontFamily:"monospace"}}>$29</span><span style={{color:C.dim,fontSize:13}}>/month</span></div>
          <button onClick={()=>{window.open("https://buy.stripe.com/your_link","_blank");onClose();}} style={{width:"100%",padding:13,background:C.neon,border:"none",borderRadius:12,color:"#0B0F19",fontSize:14,fontWeight:800,cursor:"pointer"}}>ğŸ’³ Upgrade Now â†’</button>
          <p style={{textAlign:"center",color:C.dim,fontSize:10,marginTop:8}}>Cancel anytime Â· Stripe secured</p>
        </>}

        {type==="chart"&&signal&&<>
          <h2 style={{fontSize:17,fontWeight:800,marginBottom:4}}>{signal.coin}/USDT <span style={{marginLeft:8,fontSize:11,color:signal.direction==="LONG"?C.neon:C.red,background:signal.direction==="LONG"?`${C.neon}20`:`${C.red}20`,padding:"2px 10px",borderRadius:6,fontWeight:700}}>{signal.direction}</span></h2>
          <div style={{background:C.inner,borderRadius:12,padding:14,marginBottom:14}}>
            <svg width="100%" height={100} viewBox="0 0 300 100">
              <defs><linearGradient id="cg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stopColor={signal.direction==="LONG"?C.neon:C.red} stopOpacity="0.3"/><stop offset="100%" stopColor={signal.direction==="LONG"?C.neon:C.red} stopOpacity="0"/></linearGradient></defs>
              {signal.direction==="LONG"?<>
                <path d="M0,85 L75,65 L150,48 L225,30 L300,15 L300,100 L0,100 Z" fill="url(#cg)"/>
                <path d="M0,85 L75,65 L150,48 L225,30 L300,15" fill="none" stroke={C.neon} strokeWidth={2.5} strokeLinecap="round" style={{filter:`drop-shadow(0 0 4px ${C.neon})`}}/>
              </>:<>
                <path d="M0,15 L75,35 L150,52 L225,70 L300,88 L300,0 L0,0 Z" fill="url(#cg)"/>
                <path d="M0,15 L75,35 L150,52 L225,70 L300,88" fill="none" stroke={C.red} strokeWidth={2.5} strokeLinecap="round" style={{filter:`drop-shadow(0 0 4px ${C.red})`}}/>
              </>}
            </svg>
          </div>
          {[{k:"Entry",v:`$${fmt(signal.entryLow)}â€“$${fmt(signal.entryHigh)}`,c:C.text},{k:"Stop Loss",v:`$${fmt(signal.sl)}`,c:C.red},{k:"TP1",v:`$${fmt(signal.tp1)}`,c:C.neon},{k:"TP2",v:`$${fmt(signal.tp2)}`,c:C.neon}].map((r,i)=>(
            <div key={i} style={{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:`1px solid ${C.border}`,fontSize:12}}>
              <span style={{color:C.dim}}>{r.k}</span><span style={{color:r.c,fontFamily:"monospace",fontWeight:700}}>{r.v}</span>
            </div>
          ))}
          <button onClick={()=>window.open(`https://www.tradingview.com/chart/?symbol=BINANCE:${signal.coin}USDT`,"_blank")} style={{width:"100%",marginTop:14,padding:12,background:C.blue,border:"none",borderRadius:10,color:"#fff",fontSize:13,fontWeight:700,cursor:"pointer"}}>ğŸ“ˆ Open TradingView</button>
        </>}

        {type==="share"&&signal&&<>
          <div style={{fontSize:30,textAlign:"center",marginBottom:10}}>ğŸ“¤</div>
          <h2 style={{textAlign:"center",fontSize:17,fontWeight:800,marginBottom:16}}>Share Signal</h2>
          {[
            {label:"âœˆï¸ Share on Telegram",bg:"#2196F3",action:()=>{
              const t=`ğŸ¯ ${signal.coin}/USDT ${signal.direction}\nConfidence: ${signal.confidence}%\nEntry: $${fmt(signal.entryLow)}â€“$${fmt(signal.entryHigh)}\nSL: $${fmt(signal.sl)} | TP1: $${fmt(signal.tp1)}\nvia NexusPro.io`;
              window.open(`https://t.me/share/url?url=nexuspro.io&text=${encodeURIComponent(t)}`,"_blank");
            }},
            {label:"ğ• Share on Twitter",bg:"#000",border:"1px solid #333",action:()=>{
              window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(`ğŸ¯ ${signal.coin}/USDT ${signal.direction} | ${signal.confidence}% confidence | via @NexusPro`)}`,"_blank");
            }},
            {label:"ğŸ“‹ Copy to Clipboard",bg:C.inner,border:`1px solid ${C.border}`,color:C.soft,action:()=>{
              const t=`ğŸ¯ ${signal.coin}/USDT ${signal.direction}\n${signal.confidence}% confidence\nEntry: $${fmt(signal.entryLow)}â€“$${fmt(signal.entryHigh)}\nSL: $${fmt(signal.sl)} | TP1: $${fmt(signal.tp1)}\nvia NexusPro.io`;
              navigator.clipboard?.writeText(t);toast("Signal copied!");
            }},
          ].map((btn,i)=>(
            <button key={i} onClick={()=>{btn.action();if(i<2)onClose();}} style={{width:"100%",padding:12,background:btn.bg,border:btn.border||"none",borderRadius:10,color:btn.color||"#fff",fontSize:13,fontWeight:700,cursor:"pointer",marginBottom:10}}>{btn.label}</button>
          ))}
        </>}

        {type==="signalDetail"&&signal&&<>
          <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14}}>
            <h2 style={{fontSize:19,fontWeight:800}}>{signal.coin}/USDT</h2>
            <span style={{color:signal.direction==="LONG"?C.neon:C.red,background:signal.direction==="LONG"?`${C.neon}20`:`${C.red}20`,padding:"3px 12px",borderRadius:6,fontSize:10,fontWeight:700}}>{signal.direction}</span>
          </div>
          <div style={{textAlign:"center",marginBottom:18}}>
            <div style={{fontSize:52,fontWeight:900,fontFamily:"monospace",color:signal.direction==="LONG"?C.neon:C.red}}>{signal.confidence}%</div>
            <div style={{color:C.dim,fontSize:11}}>Confidence Score</div>
          </div>
          {[{k:"Entry Zone",v:`$${fmt(signal.entryLow)}â€“$${fmt(signal.entryHigh)}`,c:C.text},{k:"Stop Loss",v:`$${fmt(signal.sl)}`,c:C.red},{k:"Take Profit 1",v:`$${fmt(signal.tp1)}`,c:C.neon},{k:"Take Profit 2",v:`$${fmt(signal.tp2)}`,c:C.neon},{k:"Risk",v:signal.risk,c:C.orange}].map((r,i)=>(
            <div key={i} style={{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:`1px solid ${C.border}`,fontSize:13}}>
              <span style={{color:C.dim}}>{r.k}</span><span style={{color:r.c,fontFamily:"monospace",fontWeight:700}}>{r.v}</span>
            </div>
          ))}
          <div style={{display:"flex",gap:10,marginTop:18}}>
            <button onClick={onClose} style={{flex:1,padding:11,background:C.inner,border:`1px solid ${C.border}`,borderRadius:10,color:C.soft,fontSize:13,fontWeight:700,cursor:"pointer"}}>Close</button>
            <button onClick={()=>window.open(`https://www.tradingview.com/chart/?symbol=BINANCE:${signal.coin}USDT`,"_blank")} style={{flex:2,padding:11,background:C.neon,border:"none",borderRadius:10,color:"#0B0F19",fontSize:13,fontWeight:800,cursor:"pointer"}}>ğŸ“ˆ View Chart</button>
          </div>
        </>}
      </div>
    </div>
  );
}

// â”€â”€ PAGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// â”€â”€ FOMO STATS BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function FOMOStatsBar({C}){
  const total=useFOMO(847);
  const premium=useFOMO(234);
  const [wins,setWins]=useState(74);
  const [lastWin,setLastWin]=useState("BTC LONG +3.2%");
  const wins24=useFOMO(28);

  const recentWins=["BTC LONG +3.2%","ETH SHORT +2.1%","SOL LONG +4.5%","BNB LONG +2.8%","XRP SHORT +1.9%"];
  useEffect(()=>{
    const t=setInterval(()=>{
      setLastWin(recentWins[Math.floor(Math.random()*recentWins.length)]);
    },5000);
    return()=>clearInterval(t);
  },[]);

  return(
    <div style={{marginBottom:16}}>
      {/* LIVE badge header */}
      <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:8}}>
        <span style={{width:8,height:8,borderRadius:"50%",background:C.neon,display:"inline-block",animation:"blink 1s infinite"}}/>
        <span style={{color:C.neon,fontWeight:800,fontSize:12,letterSpacing:0.5}}>LIVE ACTIVITY</span>
        <span style={{background:`${C.neon}22`,color:C.neon,padding:"1px 8px",borderRadius:6,fontSize:9,fontWeight:700}}>REAL-TIME</span>
      </div>

      {/* 3 stat cards â€” equal width, mobile safe */}
      <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:6,marginBottom:8}}>
        {[
          {icon:"âš¡",val:total.toLocaleString(),label:"traders",color:C.neon},
          {icon:"ğŸ‘ï¸",val:premium.toLocaleString(),label:"premium",color:C.blue},
          {icon:"ğŸ†",val:wins24,label:"wins today",color:C.orange},
        ].map((s,i)=>(
          <div key={i} style={{background:`${s.color}12`,border:`1px solid ${s.color}33`,borderRadius:10,padding:"8px 6px",textAlign:"center",minWidth:0}}>
            <div style={{fontSize:11,marginBottom:2}}>{s.icon}</div>
            <div style={{color:s.color,fontWeight:900,fontSize:14,fontFamily:"monospace",lineHeight:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{s.val}</div>
            <div style={{color:C.dim,fontSize:9,marginTop:3,lineHeight:1.2}}>{s.label}</div>
          </div>
        ))}
      </div>

      {/* Last win ticker â€” single line, truncated properly */}
      <div style={{background:C.isDark?"#0d1220":C.inner,border:`1px solid ${C.border}`,borderRadius:10,padding:"8px 12px",display:"flex",alignItems:"center",gap:8,minWidth:0}}>
        <span style={{fontSize:12,flexShrink:0}}>ğŸ¯</span>
        <span style={{color:C.dim,fontSize:11,flexShrink:0,whiteSpace:"nowrap"}}>Latest:</span>
        <span style={{color:C.neon,fontWeight:700,fontSize:12,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{lastWin}</span>
        <span style={{color:C.dim,fontSize:10,flexShrink:0,whiteSpace:"nowrap"}}>just now</span>
      </div>
    </div>
  );
}

// â”€â”€ BOT STATUS WIDGET â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function BotStatusWidget({C,onGoBot}){
  const [botOn,setBotOn]=useState(false);
  const [trades]=useState([
    {coin:"BTC",dir:"LONG",pnl:+127.4,pnlPct:+1.9},
    {coin:"ETH",dir:"SHORT",pnl:+43.2,pnlPct:+1.7},
  ]);
  const totalPnl=trades.reduce((a,t)=>a+t.pnl,0);

  return(
    <div style={{
      background:botOn
        ?`linear-gradient(135deg,${C.neon}12,${C.neon}05)`
        :C.card,
      border:`2px solid ${botOn?C.neon:C.border}`,
      borderRadius:20,padding:16,marginBottom:16,
      boxShadow:botOn?`0 0 30px ${C.neon}22`:"none",
      transition:"all 0.4s"}}>

      {/* Header row */}
      <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:14}}>
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          <div style={{
            width:40,height:40,borderRadius:12,
            background:botOn?`${C.neon}20`:"#1e2a40",
            border:`1px solid ${botOn?C.neon:C.border}`,
            display:"flex",alignItems:"center",justifyContent:"center",
            fontSize:20,transition:"all 0.3s"}}>
            ğŸ¤–
          </div>
          <div>
            <div style={{color:C.text,fontWeight:800,fontSize:14}}>Auto Trade Bot</div>
            <div style={{display:"flex",alignItems:"center",gap:5,marginTop:2}}>
              <span style={{
                width:7,height:7,borderRadius:"50%",
                background:botOn?C.neon:"#EF4444",
                display:"inline-block",
                boxShadow:botOn?`0 0 8px ${C.neon}`:"none",
                animation:botOn?"blink 2s infinite":"none",
                transition:"all 0.3s"}}/>
              <span style={{
                color:botOn?C.neon:"#EF4444",
                fontSize:10,fontWeight:700,
                fontFamily:"monospace",letterSpacing:1}}>
                {botOn?"ACTIVE":"INACTIVE"}
              </span>
              {botOn&&<span style={{color:C.dim,fontSize:10}}>Â· Binance</span>}
            </div>
          </div>
        </div>

        {/* Toggle */}
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          {!botOn&&(
            <button onClick={onGoBot}
              style={{
                background:"transparent",
                border:`1px solid ${C.neon}44`,
                color:C.neon,fontSize:10,fontWeight:700,
                padding:"5px 10px",borderRadius:8,cursor:"pointer"}}>
              Setup â†’
            </button>
          )}
          <div onClick={()=>setBotOn(!botOn)}
            style={{
              width:52,height:28,borderRadius:14,
              background:botOn?C.neon:"#1e2a40",
              position:"relative",cursor:"pointer",
              border:`1px solid ${botOn?C.neon:C.border}`,
              transition:"all 0.3s",
              boxShadow:botOn?`0 4px 16px ${C.neon}55`:"none"}}>
            <div style={{
              position:"absolute",top:3,
              left:botOn?26:3,
              width:22,height:22,borderRadius:"50%",
              background:"#fff",
              transition:"left 0.3s",
              boxShadow:"0 2px 6px rgba(0,0,0,0.3)"}}/>
          </div>
        </div>
      </div>

      {/* Stats row */}
      <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:8,marginBottom:botOn?12:0}}>
        {[
          {l:"Today's P&L",v:`+$${totalPnl.toFixed(0)}`,c:C.neon,show:true},
          {l:"Open Trades",v:botOn?"2":"â€”",c:C.blue,show:true},
          {l:"Win Rate",v:"74%",c:C.orange,show:true},
        ].map((s,i)=>(
          <div key={i} style={{
            background:C.isDark?"rgba(255,255,255,0.04)":"rgba(0,0,0,0.04)",
            borderRadius:10,padding:"8px 6px",textAlign:"center",
            border:`1px solid ${C.border}`}}>
            <div style={{
              color:botOn?s.c:C.dim,
              fontWeight:800,fontSize:13,
              fontFamily:"monospace",
              filter:botOn?"none":"blur(4px)",
              transition:"all 0.3s"}}>
              {s.v}
            </div>
            <div style={{color:C.dim,fontSize:9,marginTop:2}}>{s.l}</div>
          </div>
        ))}
      </div>

      {/* Live trades - only when bot active */}
      {botOn&&(
        <div style={{animation:"fadeSlideIn 0.4s ease"}}>
          {trades.map((t,i)=>{
            const isLong=t.dir==="LONG";
            const glow=isLong?C.neon:"#EF4444";
            return(
              <div key={i} style={{
                display:"flex",alignItems:"center",gap:10,
                padding:"8px 10px",marginBottom:i<trades.length-1?6:0,
                background:`${glow}08`,
                border:`1px solid ${glow}22`,
                borderRadius:10}}>
                <span style={{fontSize:16}}>{isLong?"ğŸ“ˆ":"ğŸ“‰"}</span>
                <div style={{flex:1}}>
                  <span style={{color:C.text,fontWeight:700,fontSize:12}}>{t.coin}/USDT </span>
                  <span style={{color:glow,fontSize:10,fontWeight:700,
                    background:`${glow}15`,padding:"1px 6px",borderRadius:4}}>{t.dir}</span>
                </div>
                <div style={{textAlign:"right"}}>
                  <div style={{color:glow,fontWeight:800,fontSize:13,fontFamily:"monospace"}}>
                    {t.pnl>0?"+":""}{t.pnlPct}%
                  </div>
                  <div style={{color:glow,fontSize:10,fontFamily:"monospace"}}>
                    +${t.pnl.toFixed(1)}
                  </div>
                </div>
              </div>
            );
          })}
          <div style={{
            marginTop:10,padding:"6px 10px",
            background:`${C.neon}08`,borderRadius:8,
            display:"flex",justifyContent:"space-between",alignItems:"center"}}>
            <span style={{color:C.dim,fontSize:11}}>
              âš¡ Next signal check in <strong style={{color:C.neon,fontFamily:"monospace"}}>2m 14s</strong>
            </span>
            <button onClick={onGoBot}
              style={{background:"transparent",border:"none",
                color:C.neon,fontSize:11,fontWeight:700,cursor:"pointer"}}>
              Manage â†’
            </button>
          </div>
        </div>
      )}

      {/* Not connected state */}
      {!botOn&&(
        <div style={{
          marginTop:4,padding:"10px 12px",
          background:C.isDark?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.03)",
          borderRadius:10,border:`1px dashed ${C.border}`,
          textAlign:"center"}}>
          <div style={{color:C.dim,fontSize:11}}>
            ğŸ”— Connect Binance/Bybit to enable auto trading
          </div>
        </div>
      )}
    </div>
  );
}

function Dashboard({coins,onChart,onShare,onDetail,onUpgrade,C,isGuest,onSignup,onGoBot}){
  return(
    <div style={{padding:16}}>
      <div style={{display:"flex",alignItems:"center",gap:10,marginBottom:18}}>
        <h2 style={{color:C.text,fontWeight:800,fontSize:18,margin:0}}>Live Signals</h2>
        <span style={{background:`${C.neon}22`,color:C.neon,padding:"2px 9px",borderRadius:6,fontSize:9,fontWeight:700,letterSpacing:1}}>NEW</span>
        <div style={{marginLeft:"auto",display:"flex",alignItems:"center",gap:6}}>
          <span style={{width:7,height:7,borderRadius:"50%",background:C.neon,display:"inline-block",animation:"blink 1.5s infinite"}}/>
          <span style={{color:C.dim,fontSize:11}}>LIVE Â· 15M</span>
        </div>
      </div>
      {/* FOMO Live Stats Bar */}
      <FOMOStatsBar C={C}/>

      {/* Market Condition Banner */}
      <MarketConditionBanner C={C}/>

      {/* Signal Invalidation Tracker */}
      <InvalidationTracker signals={SIGNALS} C={C}/>

      {/* Bot Status Widget */}
      {!isGuest&&<BotStatusWidget C={C} onGoBot={onGoBot}/>}

      {/* Guest Banner */}
      {isGuest&&(
        <div style={{background:"linear-gradient(90deg,#F59E0B22,#F59E0B11)",border:"1px solid #F59E0B44",borderRadius:12,padding:"10px 16px",marginBottom:16,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"}}>
          <span style={{fontSize:18}}>ğŸ‘ï¸</span>
          <div style={{flex:1}}>
            <div style={{color:"#F59E0B",fontWeight:700,fontSize:13}}>Guest Mode â€” Limited Access</div>
            <div style={{color:"#9CA3AF",fontSize:11}}>Signals 2 & 3 are locked. Sign up free to unlock everything!</div>
          </div>
          <button onClick={onSignup} style={{background:"#F59E0B",color:"#0B0F19",border:"none",borderRadius:8,padding:"7px 16px",fontSize:12,fontWeight:800,cursor:"pointer",whiteSpace:"nowrap"}}>Sign Up Free â†’</button>
        </div>
      )}
      <div style={{display:"flex",gap:14,marginBottom:22,flexWrap:"wrap"}}>
        {SIGNALS.map((s,i)=><SigCard key={s.id} sig={s} onChart={onChart} onShare={onShare} C={C} isGuest={isGuest} onSignup={onSignup} locked={isGuest&&i>0}/>)}
      </div>
      <div style={{display:"flex",gap:14,flexWrap:"wrap"}}>
        <div style={{flex:"1 1 250px",background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:16}}>
          <h3 style={{color:C.text,fontWeight:700,fontSize:14,margin:"0 0 12px"}}>Performance</h3>
          <div style={{display:"flex",gap:10,flexWrap:"wrap"}}>
            {[{l:"Win Rate",v:"74%",c:C.neon},{l:"Today",v:"3/10",c:C.blue},{l:"Avg Conf",v:"78%",c:C.orange}].map((s,i)=>(
              <div key={i} style={{flex:"1 1 75px",background:C.inner,borderRadius:10,padding:"11px 8px",textAlign:"center"}}>
                <div style={{fontSize:19,fontWeight:800,color:s.c,fontFamily:"monospace"}}>{s.v}</div>
                <div style={{fontSize:9,color:C.dim,marginTop:3}}>{s.l}</div>
              </div>
            ))}
          </div>
          <div style={{marginTop:12,background:C.inner,borderRadius:10,padding:"11px 12px"}}>
            <div style={{fontSize:9,color:C.dim,marginBottom:6}}>â­ BEST Today</div>
            <div style={{display:"flex",justifyContent:"space-between",alignItems:"center"}}>
              <div><span style={{color:C.text,fontWeight:700}}>BTC/USDT</span><span style={{color:C.neon,marginLeft:8,fontSize:12}}>LONG 82%</span></div>
              <button onClick={()=>onDetail(SIGNALS[0])} style={{background:C.neon,color:"#0B0F19",border:"none",borderRadius:7,padding:"6px 13px",fontSize:11,fontWeight:800,cursor:"pointer"}}>VIEW</button>
            </div>
          </div>
        </div>
        <div style={{flex:"1 1 250px",background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:16,overflow:"hidden"}}>
          <h3 style={{color:C.text,fontWeight:700,fontSize:14,margin:"0 0 12px"}}>Top 10 Market</h3>
          <table style={{width:"100%",borderCollapse:"collapse",fontSize:12}}>
            <tbody>
              {coins.slice(0,6).map((c,i)=>(
                <tr key={i} style={{borderBottom:`1px solid ${C.border}`}}>
                  <td style={{padding:"7px 0",color:C.text,fontWeight:600}}>{c.symbol}</td>
                  <td style={{textAlign:"right",color:C.text,fontFamily:"monospace"}}>${fmt(c.price)}</td>
                  <td style={{textAlign:"right",color:c.change>0?C.neon:C.red,fontWeight:700}}>{c.change>0?"â–²":"â–¼"}{Math.abs(c.change).toFixed(2)}%</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
}

function SearchPage({coins,C,setCoin,setNav}){
  const [q,setQ]=useState("");
  const [dir,setDir]=useState("all");
  const fc=coins.filter(c=>c.symbol.toLowerCase().includes(q.toLowerCase()));
  const fs=SIGNALS.filter(s=>s.coin.toLowerCase().includes(q.toLowerCase())&&(dir==="all"||(dir==="long"&&s.direction==="LONG")||(dir==="short"&&s.direction==="SHORT")));
  return(
    <div style={{padding:16}}>
      <div style={{position:"relative",marginBottom:14}}>
        <span style={{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",fontSize:16,pointerEvents:"none"}}>ğŸ”</span>
        <input value={q} onChange={e=>setQ(e.target.value)} placeholder="Search coins or signals..."
          style={{width:"100%",background:C.card,border:`1px solid ${C.border}`,color:C.text,padding:"12px 12px 12px 38px",borderRadius:12,fontSize:14,outline:"none",fontFamily:"Rajdhani",boxShadow:q?`0 0 0 2px ${C.neon}33`:"none",transition:"box-shadow 0.2s"}}/>
        {q&&<button onClick={()=>setQ("")} style={{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:C.dim,cursor:"pointer",fontSize:16}}>Ã—</button>}
      </div>
      <div style={{display:"flex",gap:8,marginBottom:14}}>
        {["all","long","short"].map(f=>(
          <button key={f} onClick={()=>setDir(f)} style={{padding:"6px 14px",borderRadius:20,border:"none",background:dir===f?(f==="long"?C.neon:f==="short"?C.red:C.blue):`${C.border}`,color:dir===f?"#0B0F19":C.dim,fontSize:12,fontWeight:700,cursor:"pointer",textTransform:"uppercase",letterSpacing:1}}>
            {f==="all"?"All":f==="long"?"ğŸŸ¢ Long":"ğŸ”´ Short"}
          </button>
        ))}
      </div>
      {!q&&<div style={{color:C.dim,fontSize:13,textAlign:"center",padding:"30px 0"}}>ğŸ” Type to search...</div>}
      {q&&fs.length>0&&<>
        <div style={{color:C.dim,fontSize:11,letterSpacing:1,marginBottom:8,fontWeight:700}}>SIGNALS</div>
        {fs.map((s,i)=>(
          <div key={i} style={{background:C.card,border:`1px solid ${s.direction==="LONG"?C.neon:C.red}33`,borderRadius:12,padding:"12px 14px",marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center"}}>
            <div><span style={{color:C.text,fontWeight:700}}>{s.coin}/USDT</span><span style={{color:s.direction==="LONG"?C.neon:C.red,background:s.direction==="LONG"?`${C.neon}15`:`${C.red}15`,marginLeft:8,padding:"1px 7px",borderRadius:4,fontSize:9,fontWeight:700}}>{s.direction}</span></div>
            <span style={{color:s.direction==="LONG"?C.neon:C.red,fontFamily:"monospace",fontWeight:800}}>{s.confidence}%</span>
          </div>
        ))}
      </>}
      {q&&fc.length>0&&<>
        <div style={{color:C.dim,fontSize:11,letterSpacing:1,marginBottom:8,fontWeight:700,marginTop:12}}>COINS</div>
        {fc.map((c,i)=>(
          <div key={i} onClick={()=>{setCoin(c);setNav("coinDetail");}} style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:12,padding:"12px 14px",marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"}}
            onMouseEnter={e=>e.currentTarget.style.borderColor=C.neon}
            onMouseLeave={e=>e.currentTarget.style.borderColor=C.border}>
            <div><span style={{color:C.text,fontWeight:700}}>{c.symbol}/USDT</span><span style={{color:C.dim,fontSize:12,marginLeft:8}}>${fmt(c.price)}</span></div>
            <span style={{color:c.change>0?C.neon:C.red,fontWeight:700}}>{c.change>0?"â–²":"â–¼"} {Math.abs(c.change).toFixed(2)}%</span>
          </div>
        ))}
      </>}
      {q&&fs.length===0&&fc.length===0&&<div style={{textAlign:"center",padding:"30px 0"}}><div style={{fontSize:40,marginBottom:12}}>ğŸ˜•</div><div style={{color:C.dim}}>No results for "{q}"</div></div>}
    </div>
  );
}

function CoinDetailPage({coin,onBack,C}){
  const [amt,setAmt]=useState(1000);
  if(!coin) return null;
  const yearly=(amt*coin.apy/100).toFixed(2);
  const monthly=(yearly/12).toFixed(2);
  const pts=coin.trend==="up"?"M0,80 L60,65 L120,50 L180,35 L240,22 L300,12":"M0,12 L60,28 L120,44 L180,58 L240,70 L300,82";
  return(
    <div style={{padding:16}}>
      <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:18}}>
        <button onClick={onBack} style={{background:C.inner,border:`1px solid ${C.border}`,color:C.soft,width:34,height:34,borderRadius:10,cursor:"pointer",fontSize:16,display:"flex",alignItems:"center",justifyContent:"center"}}>â†</button>
        <div><h2 style={{color:C.text,fontSize:20,fontWeight:800,margin:0}}>{coin.symbol}/USDT</h2><div style={{color:C.dim,fontSize:12}}>Market Cap: {coin.cap}</div></div>
        <div style={{marginLeft:"auto",textAlign:"right"}}>
          <div style={{fontSize:22,fontWeight:900,fontFamily:"monospace",color:C.text}}>${fmt(coin.price)}</div>
          <div style={{color:coin.change>0?C.neon:C.red,fontWeight:700,fontSize:13}}>{coin.change>0?"â–²":"â–¼"} {Math.abs(coin.change).toFixed(2)}%</div>
        </div>
      </div>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:16,marginBottom:14}}>
        <svg width="100%" height={100} viewBox="0 0 300 100" preserveAspectRatio="none">
          <defs><linearGradient id={`g${coin.symbol}`} x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stopColor={coin.trend==="up"?C.neon:C.red} stopOpacity="0.3"/><stop offset="100%" stopColor={coin.trend==="up"?C.neon:C.red} stopOpacity="0"/></linearGradient></defs>
          <path d={pts+` L300,100 L0,100 Z`} fill={`url(#g${coin.symbol})`}/>
          <path d={pts} fill="none" stroke={coin.trend==="up"?C.neon:C.red} strokeWidth={2.5} strokeLinecap="round" style={{filter:`drop-shadow(0 0 4px ${coin.trend==="up"?C.neon:C.red})`}}/>
        </svg>
        <div style={{display:"flex",justifyContent:"space-between",marginTop:8,fontSize:11,color:C.dim}}><span>7 days ago</span><span>Today</span></div>
      </div>
      <div style={{display:"flex",gap:10,marginBottom:14,flexWrap:"wrap"}}>
        {[{l:"Volume",v:`$${coin.volume}`},{l:"Staking APY",v:coin.apy>0?`${coin.apy}%`:"N/A"},{l:"Market Cap",v:coin.cap}].map((s,i)=>(
          <div key={i} style={{flex:"1 1 80px",background:C.card,border:`1px solid ${C.border}`,borderRadius:12,padding:"11px 10px",textAlign:"center"}}>
            <div style={{fontSize:15,fontWeight:800,color:C.neon,fontFamily:"monospace"}}>{s.v}</div>
            <div style={{fontSize:10,color:C.dim,marginTop:3}}>{s.l}</div>
          </div>
        ))}
      </div>
      {coin.apy>0&&<div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:16,marginBottom:14}}>
        <div style={{fontWeight:700,fontSize:14,marginBottom:4}}>ğŸ§® Staking Calculator</div>
        <div style={{color:C.dim,fontSize:12,marginBottom:12}}>Estimate your returns (info only)</div>
        <input type="number" value={amt} onChange={e=>setAmt(+e.target.value)} style={{width:"100%",background:C.inner,border:`1px solid ${C.border}`,color:C.text,padding:"10px 12px",borderRadius:10,fontSize:14,outline:"none",fontFamily:"Rajdhani",marginBottom:12}}/>
        <div style={{display:"flex",gap:10}}>
          {[{l:"Monthly",v:`$${monthly}`,c:C.neon},{l:"Yearly",v:`$${yearly}`,c:C.orange},{l:"APY",v:`${coin.apy}%`,c:C.blue}].map((r,i)=>(
            <div key={i} style={{flex:1,background:C.inner,borderRadius:10,padding:"10px 8px",textAlign:"center"}}>
              <div style={{color:r.c,fontWeight:800,fontSize:15,fontFamily:"monospace"}}>{r.v}</div>
              <div style={{color:C.dim,fontSize:9,marginTop:3}}>{r.l}</div>
            </div>
          ))}
        </div>
        <p style={{fontSize:10,color:C.dim,marginTop:10,textAlign:"center"}}>âš ï¸ Estimated only. Not guaranteed.</p>
      </div>}
    </div>
  );
}

function MarketPage({coins,setCoin,setNav,C}){
  return(
    <div style={{padding:20}}>
      <h2 style={{color:C.text,fontSize:20,fontWeight:800,marginBottom:6}}>Top 10 Market</h2>
      <p style={{color:C.dim,fontSize:12,marginBottom:18}}>Live prices Â· Click coin for details</p>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,overflow:"hidden"}}>
        <table style={{width:"100%",borderCollapse:"collapse",fontSize:12}}>
          <thead><tr style={{background:C.inner}}>
            {["#","Coin","Price","24h","Volume"].map(h=><th key={h} style={{padding:"10px 12px",textAlign:h==="Coin"||h==="#"?"left":"right",color:C.dim,fontWeight:500}}>{h}</th>)}
          </tr></thead>
          <tbody>
            {coins.map((c,i)=>(
              <tr key={i} style={{borderBottom:`1px solid ${C.border}`,cursor:"pointer",transition:"background 0.15s"}}
                onClick={()=>{setCoin(c);setNav("coinDetail");}}
                onMouseEnter={e=>e.currentTarget.style.background=C.isDark?"#1a2238":C.inner}
                onMouseLeave={e=>e.currentTarget.style.background="transparent"}>
                <td style={{padding:"11px 12px",color:C.dim,fontWeight:600,width:30}}>{i+1}</td>
                <td style={{padding:"11px 12px",color:C.text,fontWeight:700}}>{c.symbol}<span style={{color:C.dim}}>/USDT</span></td>
                <td style={{textAlign:"right",padding:"11px 12px",color:C.text,fontFamily:"monospace"}}>${fmt(c.price)}</td>
                <td style={{textAlign:"right",padding:"11px 12px",color:c.change>0?C.neon:C.red,fontWeight:700}}>{c.change>0?"â–²":"â–¼"}{Math.abs(c.change).toFixed(2)}%</td>
                <td style={{textAlign:"right",padding:"11px 12px",color:C.dim}}>${c.volume}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}

function HistoryPage({C}){
  return(
    <div style={{padding:20}}>
      <h2 style={{color:C.text,fontSize:20,fontWeight:800,marginBottom:16}}>Signal History</h2>
      <div style={{display:"flex",gap:12,marginBottom:18,flexWrap:"wrap"}}>
        {[{l:"Total",v:"48",c:C.neon},{l:"Win Rate",v:"74%",c:C.neon},{l:"Avg Return",v:"+2.1%",c:C.orange}].map((s,i)=>(
          <div key={i} style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:12,padding:"11px 16px"}}>
            <div style={{color:s.c,fontWeight:800,fontSize:20,fontFamily:"monospace"}}>{s.v}</div>
            <div style={{color:C.dim,fontSize:11,marginTop:3}}>{s.l}</div>
          </div>
        ))}
      </div>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,overflow:"hidden"}}>
        <table style={{width:"100%",borderCollapse:"collapse",fontSize:12}}>
          <thead><tr style={{background:C.inner}}>
            {["Coin","Dir","Conf","Result","P&L","Date"].map(h=><th key={h} style={{padding:"11px 12px",textAlign:"left",color:C.dim,fontWeight:500}}>{h}</th>)}
          </tr></thead>
          <tbody>
            {HISTORY.map((r,i)=>(
              <tr key={i} style={{borderBottom:`1px solid ${C.border}`}}
                onMouseEnter={e=>e.currentTarget.style.background=C.isDark?"#1a2238":C.inner}
                onMouseLeave={e=>e.currentTarget.style.background="transparent"}>
                <td style={{padding:"11px 12px",color:C.text,fontWeight:600}}>{r.coin}</td>
                <td style={{padding:"11px 12px"}}><span style={{color:r.dir==="LONG"?C.neon:C.red,background:r.dir==="LONG"?`${C.neon}15`:`${C.red}15`,padding:"2px 7px",borderRadius:4,fontSize:9,fontWeight:700}}>{r.dir}</span></td>
                <td style={{padding:"11px 12px",color:C.soft}}>{r.conf}%</td>
                <td style={{padding:"11px 12px",color:r.result==="WIN"?C.neon:C.red,fontWeight:700}}>{r.result==="WIN"?"âœ“":"âœ—"} {r.result}</td>
                <td style={{padding:"11px 12px",color:r.pnl.startsWith("+")?C.neon:C.red,fontFamily:"monospace",fontWeight:700}}>{r.pnl}</td>
                <td style={{padding:"11px 12px",color:C.dim}}>{r.date}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}

function WalletPage({C}){
  const [tab,setTab]=useState("holdings");
  const h=[{coin:"BTC",amt:0.05,val:3364},{coin:"ETH",amt:1.2,val:3027},{coin:"SOL",amt:8.5,val:1583}];
  const total=h.reduce((a,x)=>a+x.val,0);
  return(
    <div style={{padding:16}}>
      <h2 style={{color:C.text,fontSize:18,fontWeight:800,marginBottom:16}}>ğŸ’° Wallet & Portfolio</h2>
      <div style={{background:C.card,border:`1px solid ${C.neon}33`,borderRadius:20,padding:22,marginBottom:14,textAlign:"center",boxShadow:`0 0 30px ${C.neon}10`}}>
        <div style={{color:C.dim,fontSize:12,marginBottom:6}}>TOTAL PORTFOLIO</div>
        <div style={{fontSize:36,fontWeight:900,fontFamily:"monospace"}}>${total.toLocaleString()}</div>
        <div style={{color:C.neon,fontSize:13,marginTop:4}}>â–² +$142.50 today (+1.8%)</div>
      </div>
      <div style={{display:"flex",gap:8,marginBottom:14}}>
        {["holdings","pnl","referral"].map(t=>(
          <button key={t} onClick={()=>setTab(t)} style={{flex:1,padding:"8px 0",borderRadius:10,border:"none",background:tab===t?C.neon:"transparent",color:tab===t?"#0B0F19":C.dim,fontSize:12,fontWeight:700,cursor:"pointer",textTransform:"capitalize"}}>{t==="pnl"?"P&L":t[0].toUpperCase()+t.slice(1)}</button>
        ))}
      </div>
      {tab==="holdings"&&<div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,overflow:"hidden"}}>
        {h.map((x,i)=>(
          <div key={i} style={{display:"flex",alignItems:"center",gap:12,padding:"14px 16px",borderBottom:i<h.length-1?`1px solid ${C.border}`:"none"}}>
            <div style={{width:36,height:36,borderRadius:"50%",background:`${C.neon}22`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700}}>{x.coin[0]}</div>
            <div style={{flex:1}}><div style={{color:C.text,fontWeight:700}}>{x.coin}</div><div style={{color:C.dim,fontSize:11}}>{x.amt} {x.coin}</div></div>
            <div style={{textAlign:"right"}}><div style={{color:C.text,fontFamily:"monospace",fontWeight:700}}>${x.val.toLocaleString()}</div><div style={{color:C.neon,fontSize:11}}>â–² +1.5%</div></div>
          </div>
        ))}
      </div>}
      {tab==="pnl"&&<div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,overflow:"hidden"}}>
        {HISTORY.map((r,i)=>(
          <div key={i} style={{display:"flex",justifyContent:"space-between",padding:"12px 16px",borderBottom:i<HISTORY.length-1?`1px solid ${C.border}`:"none"}}>
            <div><div style={{color:C.text,fontWeight:700,fontSize:13}}>{r.coin}</div><div style={{color:C.dim,fontSize:11}}>{r.date}</div></div>
            <div style={{textAlign:"right"}}><div style={{color:r.result==="WIN"?C.neon:C.red,fontWeight:800}}>{r.pnl}</div><div style={{fontSize:10,color:r.result==="WIN"?C.neon:C.red}}>{r.result}</div></div>
          </div>
        ))}
      </div>}
      {tab==="referral"&&<div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:16}}>
        <div style={{display:"flex",gap:12,flexWrap:"wrap",marginBottom:16}}>
          {[{l:"Referrals",v:"3"},{l:"Converted",v:"2"},{l:"Earned",v:"$17.40"}].map((s,i)=>(
            <div key={i} style={{flex:"1 1 80px",background:C.inner,borderRadius:10,padding:"10px",textAlign:"center"}}>
              <div style={{color:C.neon,fontWeight:800,fontSize:18,fontFamily:"monospace"}}>{s.v}</div>
              <div style={{color:C.dim,fontSize:10}}>{s.l}</div>
            </div>
          ))}
        </div>
        <div style={{color:C.text,fontWeight:700,marginBottom:8,fontSize:13}}>Referred users</div>
        {[{e:"alex@gmail.com",p:"premium",earn:"$5.80"},{e:"sara@email.com",p:"premium",earn:"$5.80"},{e:"mike@web.com",p:"free",earn:"$0"}].map((r,i)=>(
          <div key={i} style={{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:i<2?`1px solid ${C.border}`:"none",fontSize:12}}>
            <div><div style={{color:C.text}}>{r.e}</div><div style={{color:r.p==="premium"?C.orange:C.dim,fontSize:10}}>{r.p.toUpperCase()}</div></div>
            <div style={{color:r.p==="premium"?C.neon:C.dim,fontWeight:700}}>{r.earn}</div>
          </div>
        ))}
      </div>}
    </div>
  );
}

function LeaderboardPage({C}){
  const [period,setPeriod]=useState("weekly");
  return(
    <div style={{padding:16}}>
      <h2 style={{color:C.text,fontSize:18,fontWeight:800,marginBottom:6}}>ğŸ† Leaderboard</h2>
      <p style={{color:C.dim,fontSize:12,marginBottom:14}}>Top traders by win rate</p>
      <div style={{display:"flex",gap:8,marginBottom:18}}>
        {["weekly","monthly","alltime"].map(p=>(
          <button key={p} onClick={()=>setPeriod(p)} style={{padding:"7px 14px",borderRadius:20,border:"none",background:period===p?C.neon:"transparent",color:period===p?"#0B0F19":C.dim,fontSize:11,fontWeight:700,cursor:"pointer"}}>
            {p==="alltime"?"All Time":p[0].toUpperCase()+p.slice(1)}
          </button>
        ))}
      </div>
      <div style={{display:"flex",alignItems:"flex-end",justifyContent:"center",gap:10,marginBottom:20,height:110}}>
        {[LEADERBOARD[1],LEADERBOARD[0],LEADERBOARD[2]].map((u,i)=>{
          const hs=[80,110,65],badges=["ğŸ¥ˆ","ğŸ†","ğŸ¥‰"];
          return(
            <div key={i} style={{flex:1,background:`linear-gradient(to top,${i===1?C.orange:C.border}44,transparent)`,borderRadius:"10px 10px 0 0",height:hs[i],display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"10px 6px",maxWidth:100}}>
              <div style={{fontSize:i===1?20:16}}>{badges[i]}</div>
              <div style={{color:C.text,fontWeight:700,fontSize:11,marginTop:4,textAlign:"center"}}>{u.name}</div>
              <div style={{color:i===1?C.orange:C.soft,fontSize:10}}>{u.winRate}%</div>
            </div>
          );
        })}
      </div>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,overflow:"hidden"}}>
        {LEADERBOARD.map((u,i)=>(
          <div key={i} style={{display:"flex",alignItems:"center",gap:12,padding:"13px 16px",borderBottom:i<LEADERBOARD.length-1?`1px solid ${C.border}`:"none",background:u.isMe?`${C.neon}08`:"transparent"}}>
            <div style={{width:28,textAlign:"center",fontWeight:800,color:i===0?C.orange:i===1?C.soft:i===2?C.orange:C.dim,fontSize:14}}>{u.badge}</div>
            <div style={{flex:1}}>
              <div style={{color:u.isMe?C.neon:C.text,fontWeight:700,fontSize:13}}>{u.name}{u.isMe?" (You)":""}</div>
              <div style={{color:C.dim,fontSize:11}}>{u.signals} signals</div>
            </div>
            <div style={{textAlign:"right"}}>
              <div style={{color:C.neon,fontWeight:800,fontSize:14}}>{u.winRate}%</div>
              <div style={{color:C.soft,fontSize:11}}>{u.profit}</div>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

function VIPSignalsPage({onUpgrade,C}){
  const VIP_COLOR="#F59E0B";
  const [locked,setLocked]=useState(true);
  return(
    <div style={{padding:16}}>
      {/* Header */}
      <div style={{background:`linear-gradient(135deg,${C.isDark?"#1a1200":"#fffbeb"},${C.isDark?"#261800":"#fef3c7"})`,border:`2px solid ${VIP_COLOR}55`,borderRadius:20,padding:20,marginBottom:18,textAlign:"center"}}>
        <div style={{fontSize:40,marginBottom:8}}>ğŸ’</div>
        <h2 style={{color:VIP_COLOR,fontSize:22,fontWeight:900,marginBottom:4}}>VIP Signals</h2>
        <p style={{color:C.soft,fontSize:13,marginBottom:0}}>Ultra high confidence Â· 85%+ only Â· Early access +2min</p>
      </div>

      {/* Stats */}
      <div style={{display:"flex",gap:10,marginBottom:18,flexWrap:"wrap"}}>
        {[{l:"Today's Signals",v:"3/5",c:VIP_COLOR},{l:"Avg Confidence",v:"88%",c:C.neon},{l:"Win Rate",v:"91%",c:C.neon},{l:"Avg Return",v:"+3.4%",c:C.neon}].map((s,i)=>(
          <div key={i} style={{flex:"1 1 80px",background:C.card,border:`1px solid ${i===0?VIP_COLOR+"44":C.border}`,borderRadius:12,padding:"11px 10px",textAlign:"center"}}>
            <div style={{fontSize:17,fontWeight:800,color:s.c,fontFamily:"monospace"}}>{s.v}</div>
            <div style={{fontSize:10,color:C.dim,marginTop:3}}>{s.l}</div>
          </div>
        ))}
      </div>

      {/* VIP Signals - locked for non-VIP */}
      <div style={{marginBottom:14}}>
        <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:12}}>
          <span style={{color:VIP_COLOR,fontWeight:800,fontSize:14}}>Today's VIP Signals</span>
          <span style={{background:`${VIP_COLOR}22`,color:VIP_COLOR,padding:"2px 8px",borderRadius:6,fontSize:9,fontWeight:700}}>LIVE</span>
        </div>
        {VIP_SIGNALS.map((sig,i)=>{
          const isLong=sig.direction==="LONG";
          const glow=isLong?C.neon:C.red;
          return(
            <div key={i} style={{background:C.isDark?"linear-gradient(135deg,#1a1200,#0d1320)":"linear-gradient(135deg,#fffbeb,#fff)",border:`2px solid ${VIP_COLOR}44`,borderRadius:16,padding:18,marginBottom:12,position:"relative",overflow:"hidden"}}>
              {/* VIP badge */}
              <div style={{position:"absolute",top:10,right:10,background:VIP_COLOR,color:"#0B0F19",padding:"2px 10px",borderRadius:6,fontSize:9,fontWeight:800}}>ğŸ’ VIP</div>

              <div style={{display:"flex",alignItems:"center",gap:10,marginBottom:12}}>
                <div>
                  <span style={{color:C.text,fontWeight:800,fontSize:18}}>{sig.coin}</span>
                  <span style={{color:C.dim,fontSize:13}}>/USDT</span>
                </div>
                <span style={{background:`${glow}22`,color:glow,border:`1px solid ${glow}55`,padding:"2px 10px",borderRadius:6,fontSize:10,fontWeight:700,letterSpacing:1}}>{sig.direction}</span>
                <span style={{background:`${VIP_COLOR}22`,color:VIP_COLOR,padding:"2px 8px",borderRadius:6,fontSize:10,fontWeight:700}}>LOW RISK</span>
              </div>

              <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:12}}>
                <div>
                  <div style={{fontSize:44,fontWeight:900,color:glow,fontFamily:"monospace",lineHeight:1,filter:`drop-shadow(0 0 8px ${glow}66)`}}>{sig.confidence}<span style={{fontSize:18,color:C.soft}}>%</span></div>
                  <div style={{color:VIP_COLOR,fontSize:11,marginTop:2,fontWeight:700}}>âš¡ +2min early access</div>
                </div>
                <div style={{flex:1}}>
                  {locked?(
                    <div style={{background:`${C.border}`,borderRadius:10,padding:10,filter:"blur(4px)",userSelect:"none"}}>
                      <div style={{fontSize:12,color:C.soft}}>Entry: $â–ˆâ–ˆ,â–ˆâ–ˆâ–ˆ â€“ $â–ˆâ–ˆ,â–ˆâ–ˆâ–ˆ</div>
                      <div style={{fontSize:12,color:C.red,marginTop:4}}>SL: $â–ˆâ–ˆ,â–ˆâ–ˆâ–ˆ</div>
                      <div style={{fontSize:12,color:glow,marginTop:4}}>TP1: $â–ˆâ–ˆ,â–ˆâ–ˆâ–ˆ</div>
                    </div>
                  ):(
                    <div style={{background:C.inner,borderRadius:10,padding:10}}>
                      <div style={{fontSize:12,color:C.soft}}>Entry: <span style={{color:C.text,fontFamily:"monospace"}}>${fmt(sig.entryLow)}â€“${fmt(sig.entryHigh)}</span></div>
                      <div style={{fontSize:12,color:C.red,marginTop:4}}>SL: <span style={{fontFamily:"monospace"}}>${fmt(sig.sl)}</span></div>
                      <div style={{fontSize:12,color:glow,marginTop:4}}>TP1: <span style={{fontFamily:"monospace"}}>${fmt(sig.tp1)}</span></div>
                    </div>
                  )}
                </div>
              </div>

              {/* Locked overlay */}
              {locked&&(
                <div style={{position:"absolute",inset:0,borderRadius:16,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backdropFilter:"blur(3px)",background:"rgba(11,15,25,0.6)",cursor:"pointer",zIndex:5}} onClick={onUpgrade}>
                  <div style={{fontSize:28,marginBottom:6}}>ğŸ’</div>
                  <div style={{color:VIP_COLOR,fontWeight:800,fontSize:14,marginBottom:4}}>VIP Only</div>
                  <div style={{color:C.dim,fontSize:11,marginBottom:12,textAlign:"center",padding:"0 20px"}}>Unlock with VIP â€” $99/mo</div>
                  <button style={{background:`linear-gradient(90deg,${VIP_COLOR},#d97706)`,color:"#0B0F19",border:"none",borderRadius:10,padding:"8px 20px",fontSize:12,fontWeight:800,cursor:"pointer"}}>Get VIP Access â†’</button>
                </div>
              )}
            </div>
          );
        })}
      </div>

      {/* Upgrade CTA */}
      <div style={{background:`linear-gradient(135deg,${C.isDark?"#1a1200":"#fffbeb"},${C.isDark?"#1a1500":"#fef9ee"})`,border:`2px solid ${VIP_COLOR}44`,borderRadius:18,padding:20,textAlign:"center"}}>
        <div style={{fontSize:32,marginBottom:8}}>ğŸ’</div>
        <h3 style={{color:VIP_COLOR,fontWeight:900,fontSize:17,marginBottom:6}}>Unlock VIP Access</h3>
        <p style={{color:C.soft,fontSize:12,lineHeight:1.7,marginBottom:16}}>Get all 5 VIP signals daily with 85%+ confidence. Early access, 1-on-1 support, and 50% referral commission!</p>
        <div style={{fontSize:28,fontWeight:900,fontFamily:"monospace",marginBottom:4}}><span style={{color:VIP_COLOR}}>$99</span><span style={{color:C.dim,fontSize:14}}>/month</span></div>
        <button onClick={onUpgrade} style={{width:"100%",padding:13,background:`linear-gradient(90deg,${VIP_COLOR},#d97706)`,border:"none",borderRadius:12,color:"#0B0F19",fontSize:15,fontWeight:800,cursor:"pointer",boxShadow:`0 6px 20px ${VIP_COLOR}33`,marginTop:8}}>
          ğŸ’ Upgrade to VIP â€” $99/mo
        </button>
        <p style={{color:C.dim,fontSize:10,marginTop:8}}>Cancel anytime Â· Stripe secured Â· Instant access</p>
      </div>
    </div>
  );
}

function MembershipPage({onUpgrade,onVIP,user,C}){
  const [hover,setHover]=useState(null);
  const VIP_COLOR="#F59E0B";
  const VIP_GLOW="#F59E0B";

  const [billingTab,setBillingTab]=useState("monthly");
  const ANNUAL_COLOR="#8B5CF6";

  const plans=[
    {
      id:"free",label:"FREE",price:"$0",sub:"Forever free",popular:false,
      color:C.dim,border:C.border,bg:"transparent",
      features:["1 signal per day","Confidence up to 70%","Basic market view","Guest & free access","Community support"],
      btn:"Current Plan",btnBg:"transparent",btnBorder:C.border,btnColor:C.soft,btnAction:null,
    },
    {
      id:"premium",label:"PREMIUM",
      price:billingTab==="annual"?"$16.58":"$29",
      sub:billingTab==="annual"?"/mo Â· billed $199/yr Â· Save $149!":"/month Â· Cancel anytime",
      popular:true,
      color:C.neon,border:C.neon,bg:C.isDark?"linear-gradient(135deg,#0f1e30,#0d1a28)":C.card,
      features:["All signals (30/day)","Confidence 75%+","Telegram instant alerts","Full signal history","Priority support","Portfolio tracker","Referral commission 20%",
        ...(billingTab==="annual"?["ğŸ 2 months FREE","ğŸ”’ Price locked for 1 year"]:[] )],
      btn:billingTab==="annual"?"Get Annual Plan â†’":"Upgrade to Premium â†’",
      btnBg:`linear-gradient(90deg,${billingTab==="annual"?ANNUAL_COLOR:C.neon},${billingTab==="annual"?"#7c3aed":"#00c4a0"})`,
      btnBorder:"none",btnColor:"#0B0F19",btnAction:onUpgrade,
    },
    {
      id:"vip",label:"VIP",price:"$99",sub:"/month Â· Elite access",popular:false,
      color:VIP_COLOR,border:VIP_COLOR,bg:C.isDark?"linear-gradient(135deg,#1a1200,#261800)":"linear-gradient(135deg,#fffbeb,#fef3c7)",
      features:["VIP-only signals 85%+","Max 5 ultra signals/day","Early signal access (+2min)","1-on-1 Telegram support","VIP badge on leaderboard","50% referral commission","Monthly strategy call","Custom price alerts"],
      btn:"Upgrade to VIP ğŸ’ â†’",btnBg:`linear-gradient(90deg,${VIP_COLOR},#d97706)`,btnBorder:"none",btnColor:"#0B0F19",btnAction:onVIP,
    },
  ];

  return(
    <div style={{padding:20}}>
      <h2 style={{color:C.text,fontSize:20,fontWeight:800,marginBottom:4}}>Membership Plans</h2>
      <p style={{color:C.dim,fontSize:12,marginBottom:20}}>Choose the plan that fits your trading style</p>

      {/* Monthly / Annual Toggle */}
      <div style={{display:"flex",alignItems:"center",justifyContent:"center",gap:12,marginBottom:20}}>
        <span style={{color:billingTab==="monthly"?C.text:C.dim,fontSize:13,fontWeight:700}}>Monthly</span>
        <div onClick={()=>setBillingTab(t=>t==="monthly"?"annual":"monthly")}
          style={{width:50,height:26,borderRadius:13,background:billingTab==="annual"?"#8B5CF6":"#2a3a55",
            position:"relative",cursor:"pointer",transition:"background 0.3s"}}>
          <div style={{position:"absolute",top:3,left:billingTab==="annual"?26:3,
            width:20,height:20,borderRadius:"50%",background:"#fff",transition:"left 0.3s"}}/>
        </div>
        <span style={{color:billingTab==="annual"?"#8B5CF6":C.dim,fontSize:13,fontWeight:700}}>Annual</span>
        {billingTab==="annual"&&(
          <span style={{background:"#8B5CF6",color:"#fff",padding:"2px 8px",borderRadius:6,fontSize:10,fontWeight:800,animation:"blink 2s infinite"}}>
            SAVE 43%
          </span>
        )}
      </div>

      {/* Annual savings banner */}
      {billingTab==="annual"&&(
        <div style={{background:"linear-gradient(90deg,#8B5CF622,#8B5CF611)",border:"1px solid #8B5CF644",borderRadius:12,padding:"10px 16px",marginBottom:16,display:"flex",alignItems:"center",gap:10}}>
          <span style={{fontSize:20}}>ğŸ</span>
          <div>
            <div style={{color:"#8B5CF6",fontWeight:800,fontSize:13}}>Annual Plan â€” Best Value!</div>
            <div style={{color:C.soft,fontSize:11}}>Pay $199/year instead of $348 â€” Save $149 (43% off!)</div>
          </div>
        </div>
      )}

      {/* VIP Banner */}
      <div style={{background:`linear-gradient(90deg,${VIP_COLOR}22,${VIP_COLOR}11)`,border:`1px solid ${VIP_COLOR}44`,borderRadius:14,padding:"12px 18px",marginBottom:22,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"}}>
        <span style={{fontSize:24}}>ğŸ’</span>
        <div style={{flex:1}}>
          <div style={{color:VIP_COLOR,fontWeight:800,fontSize:13}}>NEW â€” VIP Tier Now Available!</div>
          <div style={{color:C.soft,fontSize:11,marginTop:2}}>Only 85%+ confidence signals Â· Early access Â· Elite support</div>
        </div>
        <button onClick={onVIP} style={{background:VIP_COLOR,color:"#0B0F19",border:"none",borderRadius:8,padding:"7px 16px",fontSize:12,fontWeight:800,cursor:"pointer",whiteSpace:"nowrap"}}>See VIP â†’</button>
      </div>

      {/* Plan Cards */}
      <div style={{display:"flex",gap:16,flexWrap:"wrap"}}>
        {plans.map((p,idx)=>(
          <div key={p.id}
            onMouseEnter={()=>setHover(p.id)}
            onMouseLeave={()=>setHover(null)}
            style={{flex:"1 1 200px",background:p.bg,border:`2px solid ${hover===p.id||p.popular?p.color:C.border}`,borderRadius:20,padding:"22px 18px",position:"relative",
              boxShadow:hover===p.id||p.popular?`0 0 40px ${p.color}22`:"none",
              transform:p.popular?"scale(1.03)":"scale(1)",
              transition:"all 0.25s"}}>

            {/* Popular / New badge */}
            {p.popular&&<div style={{position:"absolute",top:-1,right:14,background:C.neon,color:"#0B0F19",padding:"3px 12px",borderRadius:"0 0 8px 8px",fontSize:9,fontWeight:800,letterSpacing:1}}>MOST POPULAR</div>}
            {p.id==="vip"&&<div style={{position:"absolute",top:-1,right:14,background:VIP_COLOR,color:"#0B0F19",padding:"3px 12px",borderRadius:"0 0 8px 8px",fontSize:9,fontWeight:800,letterSpacing:1}}>ğŸ’ ELITE</div>}

            {/* Plan label */}
            <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:8}}>
              {p.id==="vip"&&<span style={{fontSize:18}}>ğŸ’</span>}
              {p.id==="premium"&&<span style={{fontSize:18}}>â­</span>}
              {p.id==="free"&&<span style={{fontSize:18}}>ğŸ†“</span>}
              <div style={{color:p.color,fontSize:10,letterSpacing:2,fontWeight:800}}>{p.label}</div>
            </div>

            {/* Price */}
            <div style={{marginBottom:16}}>
              <span style={{fontSize:38,fontWeight:900,fontFamily:"monospace",color:C.text}}>{p.price}</span>
              <span style={{color:C.dim,fontSize:12}}>{p.sub}</span>
            </div>

            {/* Features */}
            <div style={{marginBottom:18}}>
              {p.features.map((f,i)=>(
                <div key={i} style={{display:"flex",gap:8,padding:"6px 0",borderBottom:i<p.features.length-1?`1px solid ${C.border}`:"none",fontSize:12,color:C.soft,alignItems:"flex-start"}}>
                  <span style={{color:p.color,flexShrink:0,marginTop:1}}>âœ“</span>
                  <span>{f}</span>
                </div>
              ))}
            </div>

            {/* Button */}
            <button
              onClick={p.btnAction||undefined}
              disabled={!p.btnAction}
              style={{width:"100%",padding:"12px 0",background:p.btnBg,border:p.btnBorder||"none",borderRadius:10,color:p.btnColor,fontSize:13,fontWeight:800,cursor:p.btnAction?"pointer":"default",
                boxShadow:p.id==="vip"?`0 6px 20px ${VIP_COLOR}33`:p.id==="premium"?`0 6px 20px ${C.neon}33`:"none",
                transition:"opacity 0.2s"}}
              onMouseEnter={e=>{if(p.btnAction)e.currentTarget.style.opacity="0.88";}}
              onMouseLeave={e=>{e.currentTarget.style.opacity="1";}}>
              {p.btn}
            </button>
          </div>
        ))}
      </div>

      {/* Comparison table */}
      <div style={{marginTop:28}}>
        <h3 style={{color:C.text,fontSize:14,fontWeight:800,marginBottom:14}}>ğŸ“Š Full Comparison</h3>
        <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,overflow:"hidden"}}>
          <table style={{width:"100%",borderCollapse:"collapse",fontSize:12}}>
            <thead>
              <tr style={{background:C.inner}}>
                <th style={{padding:"10px 14px",textAlign:"left",color:C.dim,fontWeight:600}}>Feature</th>
                <th style={{padding:"10px 10px",textAlign:"center",color:C.dim,fontWeight:600}}>Free</th>
                <th style={{padding:"10px 10px",textAlign:"center",color:C.neon,fontWeight:700}}>Premium</th>
                <th style={{padding:"10px 10px",textAlign:"center",color:VIP_COLOR,fontWeight:700}}>ğŸ’ VIP</th>
              </tr>
            </thead>
            <tbody>
              {[
                ["Price/month","Free","$29 or $16.58/mo","$99"],
                ["Annual option","â€”","âœ… $199/yr","â€”"],
                ["Signals per day","1","30","5 ultra"],
                ["Min confidence","â€“","75%","85%"],
                ["Early access","âŒ","âŒ","âœ… +2min"],
                ["Telegram alerts","âŒ","âœ…","âœ… Priority"],
                ["Signal history","âŒ","âœ…","âœ…"],
                ["Referral commission","âŒ","20%","50%"],
                ["Support","Community","Priority","1-on-1"],
                ["Leaderboard badge","âŒ","â­","ğŸ’ VIP"],
                ["Strategy call","âŒ","âŒ","âœ… Monthly"],
              ].map((r,i)=>(
                <tr key={i} style={{borderBottom:`1px solid ${C.border}`}}>
                  <td style={{padding:"10px 14px",color:C.soft}}>{r[0]}</td>
                  <td style={{padding:"10px 10px",textAlign:"center",color:C.dim}}>{r[1]}</td>
                  <td style={{padding:"10px 10px",textAlign:"center",color:C.neon,fontWeight:600}}>{r[2]}</td>
                  <td style={{padding:"10px 10px",textAlign:"center",color:VIP_COLOR,fontWeight:700}}>{r[3]}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>

      {/* ROI Calculator */}
      <div style={{marginTop:20,background:C.isDark?"linear-gradient(135deg,#1a1200,#1a1500)":"#fffbeb",border:`1px solid ${VIP_COLOR}44`,borderRadius:16,padding:18}}>
        <div style={{display:"flex",alignItems:"center",gap:10,marginBottom:10}}>
          <span style={{fontSize:20}}>ğŸ’°</span>
          <div style={{color:VIP_COLOR,fontWeight:800,fontSize:14}}>VIP ROI Calculator</div>
        </div>
        <div style={{color:C.soft,fontSize:12,lineHeight:1.8}}>
          If you trade <strong style={{color:C.text}}>$1,000</strong> per signal at <strong style={{color:VIP_COLOR}}>85%+ confidence</strong>:<br/>
          â€¢ 5 signals/day Ã— 22 trading days = <strong style={{color:C.text}}>110 signals/month</strong><br/>
          â€¢ Avg return per signal: <strong style={{color:C.neon}}>+2.1%</strong><br/>
          â€¢ Potential monthly: <strong style={{color:C.neon}}>~$2,310</strong> on $1,000 capital<br/>
          â€¢ VIP cost: <strong style={{color:VIP_COLOR}}>$99/mo</strong> â†’ <strong style={{color:C.neon}}>ROI: 2,233%</strong>
        </div>
        <p style={{fontSize:10,color:C.dim,marginTop:8}}>âš ï¸ Estimates only. Past performance does not guarantee future results.</p>
        <button onClick={onVIP} style={{marginTop:12,width:"100%",padding:12,background:`linear-gradient(90deg,${VIP_COLOR},#d97706)`,border:"none",borderRadius:10,color:"#0B0F19",fontSize:14,fontWeight:800,cursor:"pointer",boxShadow:`0 6px 20px ${VIP_COLOR}33`}}>
          ğŸ’ Get VIP Access â€” $99/mo
        </button>
      </div>
    </div>
  );
}

function NotificationsPage({C}){
  const [notifs,setNotifs]=useState(NOTIFS);
  const unread=notifs.filter(n=>!n.read).length;
  return(
    <div style={{padding:16}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
        <div><h2 style={{color:C.text,fontSize:18,fontWeight:800,margin:0}}>Notifications</h2>{unread>0&&<div style={{color:C.dim,fontSize:12,marginTop:2}}>{unread} unread</div>}</div>
        {unread>0&&<button onClick={()=>setNotifs(p=>p.map(n=>({...n,read:true})))} style={{background:"transparent",border:`1px solid ${C.border}`,color:C.soft,padding:"6px 12px",borderRadius:8,fontSize:12,fontWeight:600,cursor:"pointer"}}>Mark all read</button>}
      </div>
      {notifs.map((n,i)=>(
        <div key={i} onClick={()=>setNotifs(p=>p.map(x=>x.id===n.id?{...x,read:true}:x))}
          style={{background:n.read?C.card:`${C.neon}08`,border:`1px solid ${n.read?C.border:`${C.neon}33`}`,borderRadius:14,padding:"14px 16px",marginBottom:10,display:"flex",gap:12,alignItems:"flex-start",cursor:"pointer",transition:"all 0.2s"}}
          onMouseEnter={e=>e.currentTarget.style.transform="translateX(4px)"}
          onMouseLeave={e=>e.currentTarget.style.transform="translateX(0)"}>
          <div style={{width:38,height:38,borderRadius:"50%",background:C.inner,display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,flexShrink:0}}>{n.icon}</div>
          <div style={{flex:1}}>
            <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start"}}>
              <div style={{color:C.text,fontWeight:700,fontSize:13}}>{n.title}</div>
              {!n.read&&<div style={{width:8,height:8,borderRadius:"50%",background:C.neon,flexShrink:0,marginTop:3}}/>}
            </div>
            <div style={{color:C.soft,fontSize:12,marginTop:3}}>{n.msg}</div>
            <div style={{color:C.dim,fontSize:11,marginTop:4}}>{n.time}</div>
          </div>
        </div>
      ))}
    </div>
  );
}

function ProfilePage({user,onLogout,onUpgrade,onVIP,C}){
  const [copied,setCopied]=useState(false);
  const copyRef=()=>{
    navigator.clipboard?.writeText(`https://nexuspro.io/r/${user.ref}`).catch(()=>{});
    setCopied(true);setTimeout(()=>setCopied(false),2000);
  };
  return(
    <div style={{padding:16,maxWidth:500}}>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:20,padding:22,marginBottom:14,display:"flex",alignItems:"center",gap:16}}>
        <div style={{width:64,height:64,borderRadius:"50%",background:`linear-gradient(135deg,${C.neon},#00a06d)`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:26,flexShrink:0,boxShadow:`0 0 20px ${C.neon}44`}}>{user.name[0].toUpperCase()}</div>
        <div style={{flex:1}}>
          <div style={{color:C.text,fontSize:18,fontWeight:800,marginBottom:2}}>{user.name}</div>
          <div style={{color:C.dim,fontSize:12,marginBottom:6}}>{user.email}</div>
          <span style={{background:user.plan==="premium"?`${C.orange}22`:`${C.dim}22`,color:user.plan==="premium"?C.orange:C.dim,border:`1px solid ${user.plan==="premium"?C.orange:C.dim}44`,padding:"2px 10px",borderRadius:6,fontSize:10,fontWeight:800,letterSpacing:1}}>
            {user.plan==="premium"?"ğŸ‘‘ PREMIUM":"ğŸ†“ FREE"}
          </span>
        </div>
      </div>
      <div style={{display:"flex",gap:10,marginBottom:14}}>
        {[{l:"Signals",v:"47"},{l:"Win Rate",v:"74%"},{l:"Member",v:"Jan '25"}].map((s,i)=>(
          <div key={i} style={{flex:1,background:C.card,border:`1px solid ${C.border}`,borderRadius:14,padding:"12px 10px",textAlign:"center"}}>
            <div style={{fontSize:18,fontWeight:800,color:C.neon,fontFamily:"monospace"}}>{s.v}</div>
            <div style={{fontSize:10,color:C.dim,marginTop:3}}>{s.l}</div>
          </div>
        ))}
      </div>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:16,marginBottom:14}}>
        <div style={{fontWeight:700,fontSize:14,marginBottom:4}}>ğŸ¤ Referral Link</div>
        <div style={{color:C.dim,fontSize:12,marginBottom:10}}>Earn 20% commission per Premium signup!</div>
        <div style={{display:"flex",gap:8}}>
          <div style={{flex:1,background:C.inner,border:`1px solid ${C.border}`,borderRadius:8,padding:"9px 12px",fontSize:11,color:C.neon,fontFamily:"monospace",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>nexuspro.io/r/{user.ref}</div>
          <button onClick={copyRef} style={{background:copied?`${C.neon}22`:`${C.blue}22`,border:`1px solid ${copied?C.neon:C.blue}44`,color:copied?C.neon:C.blue,padding:"9px 14px",borderRadius:8,fontSize:11,fontWeight:700,cursor:"pointer",whiteSpace:"nowrap"}}>{copied?"âœ“ Copied!":"Copy"}</button>
        </div>
        <div style={{marginTop:10,fontSize:11,color:C.dim}}>Total referrals: <strong style={{color:C.text}}>3</strong> Â· Earned: <strong style={{color:C.neon}}>$17.40</strong></div>
      </div>
      {user.plan==="free"&&<div style={{display:"flex",gap:10,marginBottom:14}}>
        <button onClick={onUpgrade} style={{flex:1,padding:12,background:`linear-gradient(90deg,${C.neon},#00c4a0)`,border:"none",borderRadius:14,color:"#0B0F19",fontSize:13,fontWeight:800,cursor:"pointer",boxShadow:`0 6px 20px ${C.neon}33`}}>â­ Premium $29</button>
        <button onClick={onVIP} style={{flex:1,padding:12,background:"linear-gradient(90deg,#F59E0B,#d97706)",border:"none",borderRadius:14,color:"#0B0F19",fontSize:13,fontWeight:800,cursor:"pointer",boxShadow:"0 6px 20px #F59E0B33"}}>ğŸ’ VIP $99</button>
      </div>}
      <button onClick={onLogout} style={{width:"100%",padding:12,background:"transparent",border:`1px solid ${C.red}44`,color:C.red,borderRadius:14,fontSize:13,fontWeight:700,cursor:"pointer"}}>Sign Out</button>
    </div>
  );
}

// â”€â”€ PORTFOLIO TRACKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function PortfolioPage({coins,C}){
  const [holdings,setHoldings]=useState([
    {coin:"BTC",amt:0.05},{coin:"ETH",amt:1.2},{coin:"SOL",amt:8.5},
  ]);
  const [adding,setAdding]=useState(false);
  const [newCoin,setNewCoin]=useState("BTC");
  const [newAmt,setNewAmt]=useState("");

  const getPrice=symbol=>coins.find(c=>c.symbol===symbol)?.price||0;
  const getChange=symbol=>coins.find(c=>c.symbol===symbol)?.change||0;

  const rows=holdings.map(h=>({
    ...h,
    price:getPrice(h.coin),
    change:getChange(h.coin),
    value:h.amt*getPrice(h.coin),
  }));
  const total=rows.reduce((a,r)=>a+r.value,0);
  const totalChange=rows.reduce((a,r)=>a+(r.value*(r.change/100)),0);

  const addHolding=()=>{
    if(!newAmt||isNaN(newAmt)||+newAmt<=0) return;
    const exists=holdings.findIndex(h=>h.coin===newCoin);
    if(exists>=0){
      setHoldings(prev=>prev.map((h,i)=>i===exists?{...h,amt:h.amt+(+newAmt)}:h));
    } else {
      setHoldings(prev=>[...prev,{coin:newCoin,amt:+newAmt}]);
    }
    setNewAmt("");setAdding(false);
  };

  const removeHolding=coin=>setHoldings(prev=>prev.filter(h=>h.coin!==coin));

  // Pie chart data
  const colors=["#00F5A0","#3B82F6","#F59E0B","#8B5CF6","#EF4444","#06B6D4","#10B981","#F97316"];
  const pie=rows.map((r,i)=>({...r,pct:total>0?(r.value/total)*100:0,color:colors[i%colors.length]}));

  // Simple donut
  let angle=-90;
  const slices=pie.map(p=>{
    const start=angle;
    angle+=p.pct*3.6;
    const r=70,cx=80,cy=80;
    const a1=start*(Math.PI/180),a2=(start+p.pct*3.6)*(Math.PI/180);
    const x1=cx+r*Math.cos(a1),y1=cy+r*Math.sin(a1);
    const x2=cx+r*Math.cos(a2),y2=cy+r*Math.sin(a2);
    const large=p.pct*3.6>180?1:0;
    return{...p,d:`M${cx},${cy} L${x1},${y1} A${r},${r} 0 ${large},1 ${x2},${y2} Z`};
  });

  return(
    <div style={{padding:16}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
        <h2 style={{color:C.text,fontSize:18,fontWeight:800,margin:0}}>ğŸ“ˆ Portfolio Tracker</h2>
        <button onClick={()=>setAdding(!adding)}
          style={{background:C.neon,border:"none",color:"#0B0F19",padding:"7px 14px",borderRadius:10,fontSize:12,fontWeight:800,cursor:"pointer"}}>
          + Add Coin
        </button>
      </div>

      {/* Add coin form */}
      {adding&&(
        <div style={{background:C.card,border:`1px solid ${C.neon}44`,borderRadius:14,padding:16,marginBottom:14,animation:"fadeSlideIn 0.3s ease"}}>
          <div style={{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"}}>
            <div style={{flex:"1 1 100px"}}>
              <label style={{display:"block",color:C.dim,fontSize:11,fontWeight:700,marginBottom:5}}>COIN</label>
              <select value={newCoin} onChange={e=>setNewCoin(e.target.value)}
                style={{width:"100%",background:C.inner,border:`1px solid ${C.border}`,color:C.text,padding:"10px 12px",borderRadius:10,fontSize:13,outline:"none",fontFamily:"Rajdhani"}}>
                {coins.map(c=><option key={c.symbol} value={c.symbol}>{c.symbol}</option>)}
              </select>
            </div>
            <div style={{flex:"1 1 120px"}}>
              <label style={{display:"block",color:C.dim,fontSize:11,fontWeight:700,marginBottom:5}}>AMOUNT</label>
              <input type="number" value={newAmt} onChange={e=>setNewAmt(e.target.value)} placeholder="0.00"
                style={{width:"100%",background:C.inner,border:`1px solid ${C.border}`,color:C.text,padding:"10px 12px",borderRadius:10,fontSize:13,outline:"none",fontFamily:"Rajdhani"}}/>
            </div>
            <div style={{display:"flex",gap:8}}>
              <button onClick={addHolding} style={{padding:"10px 18px",background:C.neon,border:"none",borderRadius:10,color:"#0B0F19",fontSize:13,fontWeight:800,cursor:"pointer"}}>Add</button>
              <button onClick={()=>setAdding(false)} style={{padding:"10px 14px",background:"transparent",border:`1px solid ${C.border}`,color:C.soft,borderRadius:10,fontSize:13,cursor:"pointer"}}>âœ•</button>
            </div>
          </div>
          <div style={{color:C.dim,fontSize:11,marginTop:8}}>
            Current price: <span style={{color:C.neon,fontFamily:"monospace"}}>${fmt(getPrice(newCoin))}</span>
            {newAmt&&+newAmt>0&&<span style={{marginLeft:12}}>Value: <span style={{color:C.orange,fontFamily:"monospace"}}>${fmt(+newAmt*getPrice(newCoin))}</span></span>}
          </div>
        </div>
      )}

      {/* Total card */}
      <div style={{background:C.card,border:`1px solid ${C.neon}33`,borderRadius:20,padding:20,marginBottom:14,boxShadow:`0 0 30px ${C.neon}10`}}>
        <div style={{color:C.dim,fontSize:11,letterSpacing:1,marginBottom:4}}>TOTAL PORTFOLIO VALUE</div>
        <div style={{fontSize:34,fontWeight:900,fontFamily:"monospace",color:C.text}}>${total.toFixed(2)}</div>
        <div style={{color:totalChange>=0?C.neon:C.red,fontSize:13,marginTop:4,fontWeight:700}}>
          {totalChange>=0?"â–²":"â–¼"} ${Math.abs(totalChange).toFixed(2)} today ({total>0?((totalChange/total)*100).toFixed(2):0}%)
        </div>
      </div>

      <div style={{display:"flex",gap:14,flexWrap:"wrap",marginBottom:14}}>
        {/* Donut chart */}
        <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:16,display:"flex",flexDirection:"column",alignItems:"center",flex:"0 0 180px"}}>
          <div style={{fontSize:12,color:C.dim,fontWeight:700,marginBottom:10,letterSpacing:1}}>ALLOCATION</div>
          <svg width={160} height={160} viewBox="0 0 160 160">
            {slices.map((s,i)=>(
              <path key={i} d={s.d} fill={s.color} opacity={0.9} style={{filter:`drop-shadow(0 0 3px ${s.color}66)`}}/>
            ))}
            <circle cx={80} cy={80} r={40} fill={C.card}/>
            <text x="80" y="77" textAnchor="middle" fill={C.text} fontSize={11} fontWeight="700" fontFamily="monospace">${(total/1000).toFixed(1)}k</text>
            <text x="80" y="91" textAnchor="middle" fill={C.dim} fontSize={9}>Total</text>
          </svg>
          {/* Legend */}
          <div style={{width:"100%",marginTop:8}}>
            {pie.map((p,i)=>(
              <div key={i} style={{display:"flex",alignItems:"center",gap:6,marginBottom:4}}>
                <div style={{width:10,height:10,borderRadius:2,background:p.color,flexShrink:0}}/>
                <span style={{color:C.soft,fontSize:11,flex:1}}>{p.coin}</span>
                <span style={{color:C.dim,fontSize:11}}>{p.pct.toFixed(1)}%</span>
              </div>
            ))}
          </div>
        </div>

        {/* Holdings list */}
        <div style={{flex:1,minWidth:200}}>
          <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,overflow:"hidden"}}>
            <div style={{padding:"10px 16px",background:C.inner,display:"flex",fontSize:10,color:C.dim,fontWeight:700,letterSpacing:0.5}}>
              <span style={{flex:1}}>COIN</span>
              <span style={{width:80,textAlign:"right"}}>PRICE</span>
              <span style={{width:80,textAlign:"right"}}>VALUE</span>
              <span style={{width:50,textAlign:"right"}}>24H</span>
              <span style={{width:30}}/>
            </div>
            {rows.length===0&&(
              <div style={{padding:"20px",textAlign:"center",color:C.dim,fontSize:13}}>No holdings yet. Add a coin!</div>
            )}
            {rows.map((r,i)=>(
              <div key={i} style={{display:"flex",alignItems:"center",padding:"12px 16px",borderBottom:i<rows.length-1?`1px solid ${C.border}`:"none",transition:"background 0.15s"}}
                onMouseEnter={e=>e.currentTarget.style.background=C.isDark?"#1a2238":C.inner}
                onMouseLeave={e=>e.currentTarget.style.background="transparent"}>
                <div style={{flex:1}}>
                  <div style={{display:"flex",alignItems:"center",gap:8}}>
                    <div style={{width:28,height:28,borderRadius:"50%",background:colors[i%colors.length]+"33",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:800,color:colors[i%colors.length]}}>{r.coin[0]}</div>
                    <div>
                      <div style={{color:C.text,fontWeight:700,fontSize:13}}>{r.coin}</div>
                      <div style={{color:C.dim,fontSize:10}}>{r.amt} {r.coin}</div>
                    </div>
                  </div>
                </div>
                <div style={{width:80,textAlign:"right",color:C.soft,fontFamily:"monospace",fontSize:11}}>${fmt(r.price)}</div>
                <div style={{width:80,textAlign:"right",color:C.text,fontFamily:"monospace",fontWeight:700,fontSize:12}}>${r.value.toFixed(2)}</div>
                <div style={{width:50,textAlign:"right",color:r.change>0?C.neon:C.red,fontWeight:700,fontSize:11}}>{r.change>0?"â–²":"â–¼"}{Math.abs(r.change).toFixed(1)}%</div>
                <div style={{width:30,textAlign:"right"}}>
                  <button onClick={()=>removeHolding(r.coin)} style={{background:"none",border:"none",color:C.dim,cursor:"pointer",fontSize:14,padding:0}}
                    onMouseEnter={e=>e.target.style.color=C.red}
                    onMouseLeave={e=>e.target.style.color=C.dim}>âœ•</button>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* Stats */}
      <div style={{display:"flex",gap:10,flexWrap:"wrap"}}>
        {[
          {l:"Best Performer",v:rows.length?rows.sort((a,b)=>b.change-a.change)[0]?.coin+` +${rows.sort((a,b)=>b.change-a.change)[0]?.change.toFixed(1)}%`:"â€”",c:C.neon},
          {l:"Worst Performer",v:rows.length?rows.sort((a,b)=>a.change-b.change)[0]?.coin+` ${rows.sort((a,b)=>a.change-b.change)[0]?.change.toFixed(1)}%`:"â€”",c:C.red},
          {l:"Total Assets",v:rows.length.toString(),c:C.blue},
        ].map((s,i)=>(
          <div key={i} style={{flex:"1 1 100px",background:C.card,border:`1px solid ${C.border}`,borderRadius:12,padding:"12px 14px"}}>
            <div style={{color:s.c,fontWeight:800,fontSize:14,fontFamily:"monospace"}}>{s.v}</div>
            <div style={{color:C.dim,fontSize:10,marginTop:3}}>{s.l}</div>
          </div>
        ))}
      </div>
    </div>
  );
}

// â”€â”€ SETTINGS PAGE (FULL) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function SettingsPage({C,isDark,setIsDark,lang,setLang,timeframe,setTimeframe,accentColor,setAccentColor}){
  const [n,setN]=useState(true);
  const [s,setS]=useState(false);
  const [tg,setTg]=useState(false);

  const LANGS=[{code:"en",label:"ğŸ‡¬ğŸ‡§ English"}];
  const TFS=["1M","5M","15M","1H","4H","1D"];
  const COLORS=[
    {name:"Neon Green",value:"#00F5A0"},
    {name:"Blue",value:"#3B82F6"},
    {name:"Purple",value:"#8B5CF6"},
    {name:"Orange",value:"#F59E0B"},
    {name:"Pink",value:"#EC4899"},
    {name:"Cyan",value:"#06B6D4"},
  ];

  return(
    <div style={{padding:20,maxWidth:500}}>
      <h2 style={{color:C.text,fontSize:20,fontWeight:800,marginBottom:18}}>âš™ï¸ Settings</h2>

      {/* Appearance */}
      <div style={{color:C.dim,fontSize:10,letterSpacing:1.5,fontWeight:700,marginBottom:8}}>APPEARANCE</div>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:"4px 16px",marginBottom:18}}>
        <Toggle val={isDark} set={setIsDark} label="ğŸŒ™ Dark Mode" C={C}/>

        {/* Accent Color */}
        <div style={{padding:"14px 0",borderBottom:`1px solid ${C.border}`}}>
          <div style={{color:C.soft,fontSize:13,marginBottom:10}}>ğŸ¨ Accent Color</div>
          <div style={{display:"flex",gap:8,flexWrap:"wrap"}}>
            {COLORS.map(col=>(
              <div key={col.value} onClick={()=>setAccentColor(col.value)}
                title={col.name}
                style={{width:32,height:32,borderRadius:"50%",background:col.value,cursor:"pointer",
                  border:accentColor===col.value?`3px solid ${C.text}`:`3px solid transparent`,
                  boxShadow:accentColor===col.value?`0 0 10px ${col.value}88`:"none",
                  transition:"all 0.2s",transform:accentColor===col.value?"scale(1.15)":"scale(1)"}}/>
            ))}
          </div>
          <div style={{color:C.dim,fontSize:10,marginTop:8}}>Selected: {COLORS.find(c=>c.value===accentColor)?.name}</div>
        </div>
      </div>

      {/* Chart Timeframe */}
      <div style={{color:C.dim,fontSize:10,letterSpacing:1.5,fontWeight:700,marginBottom:8}}>DEFAULT CHART TIMEFRAME</div>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:14,marginBottom:18}}>
        <div style={{display:"flex",gap:8,flexWrap:"wrap"}}>
          {TFS.map(tf=>(
            <button key={tf} onClick={()=>setTimeframe(tf)}
              style={{flex:"1 1 50px",padding:"9px 0",borderRadius:8,border:"none",
                background:timeframe===tf?C.neon:"transparent",
                border:timeframe===tf?"none":`1px solid ${C.border}`,
                color:timeframe===tf?"#0B0F19":C.soft,
                fontSize:12,fontWeight:700,cursor:"pointer",transition:"all 0.2s"}}>
              {tf}
            </button>
          ))}
        </div>
        <div style={{color:C.dim,fontSize:11,marginTop:10}}>Charts will open at <strong style={{color:C.text}}>{timeframe}</strong> by default</div>
      </div>

      {/* Notifications */}
      <div style={{color:C.dim,fontSize:10,letterSpacing:1.5,fontWeight:700,marginBottom:8}}>NOTIFICATIONS</div>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:"4px 16px",marginBottom:18}}>
        <Toggle val={n} set={setN} label="ğŸ”” Push Notifications" C={C}/>
        <Toggle val={s} set={setS} label="ğŸ”Š Sound Alerts" C={C}/>
        <div style={{padding:"13px 0",display:"flex",justifyContent:"space-between",alignItems:"center"}}>
          <span style={{color:C.soft,fontSize:13}}>âœˆï¸ Telegram Alerts</span>
          <div onClick={()=>setTg(!tg)} style={{width:42,height:22,borderRadius:11,background:tg?C.neon:"#2a3a55",position:"relative",cursor:"pointer",transition:"background 0.2s"}}>
            <div style={{position:"absolute",top:3,left:tg?22:3,width:16,height:16,borderRadius:"50%",background:tg?"#0B0F19":C.dim,transition:"left 0.2s"}}/>
          </div>
        </div>
      </div>

      {/* App Info */}
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:16,textAlign:"center"}}>
        <div style={{fontFamily:"'Space Mono',monospace",fontSize:16,fontWeight:700,marginBottom:4}}>NEXUS<span style={{color:C.neon}}>PRO</span></div>
        <div style={{color:C.dim,fontSize:11,marginBottom:6}}>Version 2.0.0 Â· AI Crypto Signal Terminal</div>
        <div style={{color:C.dim,fontSize:10}}>Â© 2025 NexusPro. Not financial advice.</div>
      </div>
    </div>
  );
}

// â”€â”€ AUTO TRADE BOT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function AutoTradePage({user,C}){
  const [step,setStep]=useState("home"); // home | connect | connected | settings
  const [exchange,setExchange]=useState("binance");
  const [apiKey,setApiKey]=useState("");
  const [secretKey,setSecretKey]=useState("");
  const [showSecret,setShowSecret]=useState(false);
  const [connecting,setConnecting]=useState(false);
  const [connected,setConnected]=useState(false);
  const [botActive,setBotActive]=useState(false);
  const [riskPct,setRiskPct]=useState(1);
  const [maxTrades,setMaxTrades]=useState(2);
  const [autoSL,setAutoSL]=useState(true);
  const [autoTP,setAutoTP]=useState(true);
  const [minConfidence,setMinConfidence]=useState(80);
  const [agreed,setAgreed]=useState(false);
  const [trades,setTrades]=useState([
    {id:1,coin:"BTC",dir:"LONG",entry:66950,size:0.015,pnl:+127.4,pnlPct:+1.9,status:"OPEN",time:"2m ago"},
    {id:2,coin:"ETH",dir:"SHORT",entry:2528,size:0.4,pnl:+43.2,pnlPct:+1.7,status:"OPEN",time:"18m ago"},
    {id:3,coin:"SOL",dir:"LONG",entry:185.5,size:2.1,pnl:-12.3,pnlPct:-0.6,status:"CLOSED",time:"1h ago"},
  ]);

  const totalPnl=trades.filter(t=>t.status==="OPEN").reduce((a,t)=>a+t.pnl,0);
  const winRate=Math.round((trades.filter(t=>t.pnl>0).length/trades.length)*100);

  const handleConnect=()=>{
    if(!apiKey||!secretKey) return;
    setConnecting(true);
    setTimeout(()=>{
      setConnecting(false);
      setConnected(true);
      setStep("connected");
    },2500);
  };

  const isPremium=user?.plan==="premium"||user?.plan==="vip";

  // â”€â”€ HOME SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if(step==="home") return(
    <div style={{padding:16,maxWidth:500,margin:"0 auto"}}>
      {/* Hero */}
      <div style={{
        background:"linear-gradient(135deg,#0a1628 0%,#0d1f3c 50%,#0a1628 100%)",
        border:"1px solid #1e3a5f",borderRadius:24,padding:28,marginBottom:16,
        position:"relative",overflow:"hidden",textAlign:"center"}}>
        {/* Animated bg circles */}
        <div style={{position:"absolute",top:-40,right:-40,width:160,height:160,
          borderRadius:"50%",background:`radial-gradient(circle,${C.neon}15,transparent 70%)`,
          animation:"pulse 3s ease-in-out infinite"}}/>
        <div style={{position:"absolute",bottom:-30,left:-30,width:120,height:120,
          borderRadius:"50%",background:"radial-gradient(circle,#3B82F615,transparent 70%)",
          animation:"pulse 4s ease-in-out infinite reverse"}}/>
        
        <div style={{fontSize:56,marginBottom:12,filter:"drop-shadow(0 0 20px #00F5A066)"}}>ğŸ¤–</div>
        <h2 style={{
          fontFamily:"'Space Mono',monospace",
          color:C.neon,fontSize:22,fontWeight:700,
          letterSpacing:2,marginBottom:8}}>AUTO TRADE BOT</h2>
        <p style={{color:"#94A3B8",fontSize:13,lineHeight:1.6,marginBottom:20}}>
          Our AI signals are automatically executed on your Binance/Bybit account.
          Your API key = trade permission only. No withdrawal access ever.
        </p>

        {/* Stats */}
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:10,marginBottom:20}}>
          {[
            {icon:"âš¡",val:"2.3s",label:"Avg execution"},
            {icon:"ğŸ¯",val:"74%",label:"Win rate"},
            {icon:"ğŸ”’",val:"100%",label:"Non-custodial"},
          ].map((s,i)=>(
            <div key={i} style={{
              background:"rgba(255,255,255,0.04)",
              border:"1px solid rgba(255,255,255,0.08)",
              borderRadius:12,padding:"12px 8px"}}>
              <div style={{fontSize:20,marginBottom:4}}>{s.icon}</div>
              <div style={{color:C.neon,fontWeight:800,fontSize:16,fontFamily:"monospace"}}>{s.val}</div>
              <div style={{color:"#64748B",fontSize:10,marginTop:2}}>{s.label}</div>
            </div>
          ))}
        </div>

        {/* How it works */}
        <div style={{textAlign:"left",marginBottom:20}}>
          {[
            {n:"01",t:"Connect Your API Key",d:"Create a Read+Trade API key from Binance or Bybit"},
            {n:"02",t:"Configure Risk Settings",d:"1% risk per trade, max 2 trades â€” you stay in full control"},
            {n:"03",t:"Activate the Bot",d:"Signal detected â†’ Bot executes the trade automatically"},
          ].map((s,i)=>(
            <div key={i} style={{display:"flex",gap:12,marginBottom:12,alignItems:"flex-start"}}>
              <div style={{
                width:28,height:28,borderRadius:8,
                background:`linear-gradient(135deg,${C.neon}22,${C.neon}11)`,
                border:`1px solid ${C.neon}44`,
                color:C.neon,fontSize:10,fontWeight:800,fontFamily:"monospace",
                display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}}>
                {s.n}
              </div>
              <div>
                <div style={{color:C.text,fontWeight:700,fontSize:13}}>{s.t}</div>
                <div style={{color:"#64748B",fontSize:11,marginTop:2}}>{s.d}</div>
              </div>
            </div>
          ))}
        </div>

        {isPremium?(
          <button onClick={()=>setStep("connect")}
            style={{
              width:"100%",padding:"14px 0",
              background:`linear-gradient(90deg,${C.neon},#00c4a0)`,
              border:"none",borderRadius:14,
              color:"#0B0F19",fontSize:15,fontWeight:900,
              cursor:"pointer",letterSpacing:0.5,
              boxShadow:`0 8px 30px ${C.neon}44`,
              fontFamily:"'Space Mono',monospace"}}>
            ğŸ”— Connect Exchange â†’
          </button>
        ):(
          <div>
            <div style={{
              background:"rgba(239,68,68,0.08)",border:"1px solid rgba(239,68,68,0.2)",
              borderRadius:12,padding:"10px 14px",marginBottom:12,fontSize:12,color:"#EF4444"}}>
              âš ï¸ Auto Trading is available for Premium & VIP users only
            </div>
            <button style={{
              width:"100%",padding:"14px 0",
              background:"linear-gradient(90deg,#F59E0B,#d97706)",
              border:"none",borderRadius:14,
              color:"#0B0F19",fontSize:14,fontWeight:900,cursor:"pointer"}}>
              â­ Upgrade to Premium â†’
            </button>
          </div>
        )}
      </div>

      {/* Security notice */}
      <div style={{
        background:"rgba(0,245,160,0.05)",
        border:"1px solid rgba(0,245,160,0.15)",
        borderRadius:16,padding:16}}>
        <div style={{color:C.neon,fontWeight:700,fontSize:13,marginBottom:10}}>ğŸ”’ Security Guarantee</div>
        {[
          "Your API key is stored only on your device",
          "Withdraw/Transfer permission NEVER use hoti",
          "Disconnect anytime â€” instant & complete",
          "Our servers never touch your funds",
          "Read + Trade only â€” maximum safety",
        ].map((s,i)=>(
          <div key={i} style={{display:"flex",gap:8,marginBottom:6,fontSize:12,color:"#94A3B8"}}>
            <span style={{color:C.neon,flexShrink:0}}>âœ“</span>{s}
          </div>
        ))}
      </div>
    </div>
  );

  // â”€â”€ CONNECT SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if(step==="connect") return(
    <div style={{padding:16,maxWidth:500,margin:"0 auto"}}>
      <button onClick={()=>setStep("home")}
        style={{background:"transparent",border:"none",color:C.dim,fontSize:13,
          cursor:"pointer",marginBottom:16,display:"flex",alignItems:"center",gap:6}}>
        â† Back
      </button>

      <h2 style={{color:C.text,fontSize:18,fontWeight:800,marginBottom:4}}>
        ğŸ”— Connect Your Exchange
      </h2>
      <p style={{color:C.dim,fontSize:12,marginBottom:20}}>
        API key for trade permission only â€” your funds stay safe âœ…
      </p>

      {/* Exchange selector */}
      <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:20}}>
        {[
          {id:"binance",name:"Binance",color:"#F0B90B",sub:"Recommended"},
          {id:"bybit",name:"Bybit",color:"#F7A600",sub:"Also supported"},
        ].map(ex=>(
          <div key={ex.id} onClick={()=>setExchange(ex.id)}
            style={{
              background:exchange===ex.id?`${ex.color}15`:"transparent",
              border:`2px solid ${exchange===ex.id?ex.color:`${C.border}`}`,
              borderRadius:16,padding:"14px 12px",cursor:"pointer",
              textAlign:"center",transition:"all 0.2s"}}>
            <div style={{fontSize:28,marginBottom:6}}>
              {ex.id==="binance"?"ğŸ”¶":"ğŸ”·"}
            </div>
            <div style={{color:exchange===ex.id?ex.color:C.text,fontWeight:800,fontSize:14}}>{ex.name}</div>
            <div style={{color:C.dim,fontSize:10,marginTop:2}}>{ex.sub}</div>
          </div>
        ))}
      </div>

      {/* API Guide */}
      <div style={{
        background:C.isDark?"#0d1520":"#F8FAFC",
        border:`1px solid ${C.border}`,borderRadius:14,padding:14,marginBottom:16}}>
        <div style={{color:C.text,fontWeight:700,fontSize:13,marginBottom:10}}>
          ğŸ“– API Key Kaise Banayein?
        </div>
        {[
          `${exchange==="binance"?"Binance":"Bybit"} app kholo`,
          "Go to Profile â†’ API Management",
          'Click "Create API Key"',
          "Label it: NexusPro",
          "âœ… Enable Spot & Futures Trading ONLY",
          "âŒ Disable Withdrawals (CRITICAL!)",
          "Copy the API Key and Secret Key",
        ].map((s,i)=>(
          <div key={i} style={{
            display:"flex",gap:10,marginBottom:8,
            fontSize:12,color:C.soft,alignItems:"flex-start"}}>
            <span style={{
              color:C.neon,fontWeight:800,fontFamily:"monospace",
              fontSize:11,flexShrink:0,marginTop:1}}>
              {String(i+1).padStart(2,"0")}
            </span>
            <span style={{color:s.startsWith("âŒ")?"#EF4444":s.startsWith("âœ…")?C.neon:C.soft}}>{s}</span>
          </div>
        ))}
      </div>

      {/* API Key inputs */}
      <div style={{marginBottom:14}}>
        <label style={{color:C.dim,fontSize:11,fontWeight:700,letterSpacing:1,display:"block",marginBottom:6}}>
          API KEY
        </label>
        <input value={apiKey} onChange={e=>setApiKey(e.target.value)}
          placeholder="Paste your API key here..."
          style={{
            width:"100%",padding:"12px 14px",
            background:C.isDark?"#0d1520":C.inner,
            border:`1px solid ${apiKey?C.neon:C.border}`,
            borderRadius:12,color:C.text,fontSize:12,
            outline:"none",fontFamily:"monospace",
            transition:"border 0.2s"}}/>
      </div>

      <div style={{marginBottom:16,position:"relative"}}>
        <label style={{color:C.dim,fontSize:11,fontWeight:700,letterSpacing:1,display:"block",marginBottom:6}}>
          SECRET KEY
        </label>
        <input value={secretKey} onChange={e=>setSecretKey(e.target.value)}
          type={showSecret?"text":"password"}
          placeholder="Paste your secret key here..."
          style={{
            width:"100%",padding:"12px 44px 12px 14px",
            background:C.isDark?"#0d1520":C.inner,
            border:`1px solid ${secretKey?C.neon:C.border}`,
            borderRadius:12,color:C.text,fontSize:12,
            outline:"none",fontFamily:"monospace",
            transition:"border 0.2s"}}/>
        <button onClick={()=>setShowSecret(!showSecret)}
          style={{position:"absolute",right:12,top:34,background:"transparent",
            border:"none",color:C.dim,cursor:"pointer",fontSize:16}}>
          {showSecret?"ğŸ™ˆ":"ğŸ‘ï¸"}
        </button>
      </div>

      {/* Consent */}
      <div onClick={()=>setAgreed(!agreed)}
        style={{
          display:"flex",gap:12,alignItems:"flex-start",
          background:agreed?`${C.neon}08`:"transparent",
          border:`1px solid ${agreed?C.neon:C.border}`,
          borderRadius:12,padding:12,marginBottom:16,cursor:"pointer",
          transition:"all 0.2s"}}>
        <div style={{
          width:20,height:20,borderRadius:6,flexShrink:0,marginTop:1,
          background:agreed?C.neon:C.inner,
          border:`2px solid ${agreed?C.neon:C.border}`,
          display:"flex",alignItems:"center",justifyContent:"center",
          transition:"all 0.2s"}}>
          {agreed&&<span style={{color:"#0B0F19",fontSize:12,fontWeight:900}}>âœ“</span>}
        </div>
        <p style={{color:C.soft,fontSize:11,lineHeight:1.5,margin:0}}>
          I understand that these trading signals are for informational purposes only. 
          NexusPro does not guarantee returns on my funds. 
          I am trading at my own risk and discretion.
        </p>
      </div>

      <button
        onClick={handleConnect}
        disabled={!apiKey||!secretKey||!agreed||connecting}
        style={{
          width:"100%",padding:"15px 0",
          background:(!apiKey||!secretKey||!agreed)?C.inner
            :`linear-gradient(90deg,${C.neon},#00c4a0)`,
          border:"none",borderRadius:14,
          color:(!apiKey||!secretKey||!agreed)?C.dim:"#0B0F19",
          fontSize:15,fontWeight:900,
          cursor:(!apiKey||!secretKey||!agreed)?"not-allowed":"pointer",
          boxShadow:(!apiKey||!secretKey||!agreed)?"none":`0 8px 30px ${C.neon}44`,
          transition:"all 0.3s",fontFamily:"'Space Mono',monospace"}}>
        {connecting?"âš™ï¸ Connecting...":"ğŸ”— Connect & Verify â†’"}
      </button>
    </div>
  );

  // â”€â”€ CONNECTED DASHBOARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  return(
    <div style={{padding:16,maxWidth:500,margin:"0 auto"}}>

      {/* Bot Status Card */}
      <div style={{
        background:botActive
          ?"linear-gradient(135deg,#00F5A011,#00F5A005)"
          :"linear-gradient(135deg,#1a2238,#151C2F)",
        border:`2px solid ${botActive?C.neon:C.border}`,
        borderRadius:24,padding:20,marginBottom:14,
        boxShadow:botActive?`0 0 40px ${C.neon}22`:"none",
        transition:"all 0.5s"}}>

        <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16}}>
          <div>
            <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:4}}>
              <span style={{
                width:10,height:10,borderRadius:"50%",
                background:botActive?C.neon:"#EF4444",
                display:"inline-block",
                boxShadow:botActive?`0 0 10px ${C.neon}`:"none",
                animation:botActive?"blink 2s infinite":"none"}}/>
              <span style={{
                color:botActive?C.neon:"#EF4444",
                fontWeight:800,fontSize:13,fontFamily:"monospace",
                letterSpacing:1}}>
                {botActive?"BOT ACTIVE":"BOT PAUSED"}
              </span>
            </div>
            <div style={{color:C.dim,fontSize:11}}>
              {exchange.toUpperCase()} â€¢ API Connected âœ…
            </div>
          </div>

          {/* Toggle */}
          <div onClick={()=>setBotActive(!botActive)}
            style={{
              width:60,height:32,borderRadius:16,
              background:botActive?C.neon:"#1e2a40",
              position:"relative",cursor:"pointer",
              transition:"background 0.3s",
              boxShadow:botActive?`0 4px 20px ${C.neon}66`:"none"}}>
            <div style={{
              position:"absolute",top:4,
              left:botActive?30:4,
              width:24,height:24,borderRadius:"50%",
              background:"#fff",
              transition:"left 0.3s",
              boxShadow:"0 2px 8px rgba(0,0,0,0.3)"}}/>
          </div>
        </div>

        {/* P&L Summary */}
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:8}}>
          {[
            {l:"Live P&L",v:`+$${totalPnl.toFixed(1)}`,c:C.neon},
            {l:"Win Rate",v:`${winRate}%`,c:C.blue},
            {l:"Open Trades",v:trades.filter(t=>t.status==="OPEN").length,c:C.orange},
          ].map((s,i)=>(
            <div key={i} style={{
              background:"rgba(255,255,255,0.04)",
              borderRadius:12,padding:"10px 8px",textAlign:"center"}}>
              <div style={{color:s.c,fontWeight:800,fontSize:15,fontFamily:"monospace"}}>{s.v}</div>
              <div style={{color:C.dim,fontSize:9,marginTop:2}}>{s.l}</div>
            </div>
          ))}
        </div>
      </div>

      {/* Risk Settings */}
      <div style={{
        background:C.card,border:`1px solid ${C.border}`,
        borderRadius:18,padding:16,marginBottom:14}}>
        <div style={{fontWeight:800,fontSize:14,color:C.text,marginBottom:14}}>
          âš™ï¸ Risk Settings
        </div>

        {/* Risk per trade slider */}
        <div style={{marginBottom:16}}>
          <div style={{display:"flex",justifyContent:"space-between",marginBottom:8}}>
            <span style={{color:C.soft,fontSize:12}}>Risk per trade</span>
            <span style={{color:C.neon,fontWeight:800,fontSize:13,fontFamily:"monospace"}}>{riskPct}%</span>
          </div>
          <input type="range" min={0.5} max={5} step={0.5}
            value={riskPct} onChange={e=>setRiskPct(+e.target.value)}
            style={{width:"100%",accentColor:C.neon}}/>
          <div style={{display:"flex",justifyContent:"space-between",fontSize:9,color:C.dim,marginTop:4}}>
            <span>0.5% (Safe)</span><span>2.5% (Medium)</span><span>5% (High)</span>
          </div>
        </div>

        {/* Max trades */}
        <div style={{marginBottom:14}}>
          <div style={{display:"flex",justifyContent:"space-between",marginBottom:8}}>
            <span style={{color:C.soft,fontSize:12}}>Max concurrent trades</span>
            <span style={{color:C.neon,fontWeight:800,fontSize:13,fontFamily:"monospace"}}>{maxTrades}</span>
          </div>
          <div style={{display:"flex",gap:8}}>
            {[1,2,3,4,5].map(n=>(
              <button key={n} onClick={()=>setMaxTrades(n)}
                style={{
                  flex:1,padding:"8px 0",borderRadius:10,
                  background:maxTrades===n?C.neon:"transparent",
                  border:`1px solid ${maxTrades===n?C.neon:C.border}`,
                  color:maxTrades===n?"#0B0F19":C.dim,
                  fontWeight:700,fontSize:13,cursor:"pointer",
                  transition:"all 0.2s"}}>
                {n}
              </button>
            ))}
          </div>
        </div>

        {/* Min confidence */}
        <div style={{marginBottom:14}}>
          <div style={{display:"flex",justifyContent:"space-between",marginBottom:8}}>
            <span style={{color:C.soft,fontSize:12}}>Min signal confidence</span>
            <span style={{color:C.neon,fontWeight:800,fontSize:13,fontFamily:"monospace"}}>{minConfidence}%</span>
          </div>
          <input type="range" min={70} max={95} step={5}
            value={minConfidence} onChange={e=>setMinConfidence(+e.target.value)}
            style={{width:"100%",accentColor:C.neon}}/>
        </div>

        {/* Toggles */}
        {[
          {l:"Auto Stop Loss",sub:"Auto-set SL at order block level",val:autoSL,set:setAutoSL},
          {l:"Auto Take Profit",sub:"Auto-set TP1 and TP2 targets",val:autoTP,set:setAutoTP},
        ].map((t,i)=>(
          <div key={i} style={{
            display:"flex",justifyContent:"space-between",alignItems:"center",
            padding:"10px 0",borderTop:`1px solid ${C.border}`}}>
            <div>
              <div style={{color:C.text,fontSize:13,fontWeight:600}}>{t.l}</div>
              <div style={{color:C.dim,fontSize:11}}>{t.sub}</div>
            </div>
            <div onClick={()=>t.set(!t.val)}
              style={{
                width:44,height:24,borderRadius:12,
                background:t.val?C.neon:"#1e2a40",
                position:"relative",cursor:"pointer",
                transition:"background 0.3s"}}>
              <div style={{
                position:"absolute",top:3,
                left:t.val?22:3,
                width:18,height:18,borderRadius:"50%",
                background:"#fff",transition:"left 0.3s"}}/>
            </div>
          </div>
        ))}
      </div>

      {/* Open Trades */}
      <div style={{
        background:C.card,border:`1px solid ${C.border}`,
        borderRadius:18,padding:16,marginBottom:14}}>
        <div style={{fontWeight:800,fontSize:14,color:C.text,marginBottom:12}}>
          ğŸ“Š Live Trades
        </div>
        {trades.filter(t=>t.status==="OPEN").map((t,i)=>{
          const isLong=t.dir==="LONG";
          const glow=isLong?C.neon:"#EF4444";
          return(
            <div key={i} style={{
              background:C.isDark?"#0d1520":"#F8FAFC",
              border:`1px solid ${glow}33`,
              borderRadius:14,padding:"12px 14px",marginBottom:8,
              display:"flex",alignItems:"center",gap:12}}>
              <div style={{
                width:40,height:40,borderRadius:12,
                background:`${glow}15`,border:`1px solid ${glow}33`,
                display:"flex",alignItems:"center",justifyContent:"center",
                flexShrink:0}}>
                <span style={{fontSize:16}}>{isLong?"ğŸ“ˆ":"ğŸ“‰"}</span>
              </div>
              <div style={{flex:1,minWidth:0}}>
                <div style={{display:"flex",gap:6,alignItems:"center",marginBottom:3}}>
                  <span style={{color:C.text,fontWeight:700,fontSize:13}}>{t.coin}/USDT</span>
                  <span style={{color:glow,fontSize:10,fontWeight:700,
                    background:`${glow}15`,padding:"1px 6px",borderRadius:4}}>{t.dir}</span>
                </div>
                <div style={{color:C.dim,fontSize:11}}>Entry: ${t.entry} â€¢ Size: {t.size}</div>
              </div>
              <div style={{textAlign:"right"}}>
                <div style={{color:t.pnl>0?C.neon:"#EF4444",fontWeight:800,fontSize:14,fontFamily:"monospace"}}>
                  {t.pnl>0?"+":""}{t.pnlPct}%
                </div>
                <div style={{color:t.pnl>0?C.neon:"#EF4444",fontSize:11,fontFamily:"monospace"}}>
                  {t.pnl>0?"+":""} ${t.pnl.toFixed(1)}
                </div>
              </div>
            </div>
          );
        })}
      </div>

      {/* Disconnect */}
      <button onClick={()=>{setConnected(false);setStep("home");setBotActive(false);setApiKey("");setSecretKey("");}}
        style={{
          width:"100%",padding:12,
          background:"transparent",border:`1px solid #EF444433`,
          borderRadius:14,color:"#EF4444",fontSize:13,fontWeight:700,cursor:"pointer"}}>
        ğŸ”Œ Disconnect Exchange
      </button>
    </div>
  );
}

// â”€â”€ DAILY SPIN WHEEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function SpinWheelPage({C,onUpgrade}){
  const PRIZES=[
    {label:"BTC Signal",emoji:"ğŸ“¡",color:"#00F5A0",weight:20,desc:"1 Free BTC signal"},
    {label:"ETH Signal",emoji:"ğŸ“ˆ",color:"#3B82F6",weight:20,desc:"1 Free ETH signal"},
    {label:"10% Off",emoji:"ğŸ",color:"#8B5CF6",weight:15,desc:"10% off Premium"},
    {label:"SOL Signal",emoji:"ğŸš€",color:"#F59E0B",weight:15,desc:"1 Free SOL signal"},
    {label:"VIP 1 Day",emoji:"ğŸ’",color:"#F59E0B",weight:5,desc:"1 day VIP trial"},
    {label:"Try Again",emoji:"ğŸ˜…",color:"#6B7280",weight:10,desc:"Better luck tomorrow!"},
    {label:"25% Off",emoji:"ğŸ’°",color:"#EC4899",weight:10,desc:"25% off any plan"},
    {label:"3 Signals",emoji:"âš¡",color:"#06B6D4",weight:5,desc:"3 free signals pack"},
  ];

  const [spinning,setSpinning]=useState(false);
  const [rotation,setRotation]=useState(0);
  const [result,setResult]=useState(null);
  const [spun,setSpun]=useState(false);
  const [showResult,setShowResult]=useState(false);
  const [timeLeft,setTimeLeft]=useState(null);

  // Check if already spun today
  useEffect(()=>{
    const lastSpin=localStorage.getItem("lastSpin");
    if(lastSpin){
      const diff=Date.now()-parseInt(lastSpin);
      const remaining=86400000-diff;
      if(remaining>0){
        setSpun(true);
        setTimeLeft(remaining);
      }
    }
  },[]);

  // Timer for next spin
  useEffect(()=>{
    if(!timeLeft) return;
    const t=setInterval(()=>{
      setTimeLeft(x=>{
        if(x<=1000){setSpun(false);return null;}
        return x-1000;
      });
    },1000);
    return()=>clearInterval(t);
  },[timeLeft]);

  const fmtTime=(ms)=>{
    const h=Math.floor(ms/3600000);
    const m=Math.floor((ms%3600000)/60000);
    const s=Math.floor((ms%60000)/1000);
    return `${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
  };

  const spin=()=>{
    if(spinning||spun) return;
    setSpinning(true);
    setResult(null);
    setShowResult(false);

    // Weighted random prize
    const total=PRIZES.reduce((a,p)=>a+p.weight,0);
    let rand=Math.random()*total;
    let chosen=0;
    for(let i=0;i<PRIZES.length;i++){
      rand-=PRIZES[i].weight;
      if(rand<=0){chosen=i;break;}
    }

    const sliceAngle=360/PRIZES.length;
    const targetAngle=360*5+(chosen*sliceAngle*-1)+(sliceAngle/2);
    const finalRot=rotation+targetAngle+Math.random()*20-10;

    setRotation(finalRot);
    setTimeout(()=>{
      setSpinning(false);
      setResult(PRIZES[chosen]);
      setShowResult(true);
      setSpun(true);
      localStorage.setItem("lastSpin",Date.now().toString());
      setTimeLeft(86400000);
    },4000);
  };

  // Draw wheel
  const size=280;
  const cx=size/2,cy=size/2,r=size/2-10;
  const sliceAngle=360/PRIZES.length;

  const polarToCart=(angle,radius)=>{
    const rad=(angle-90)*Math.PI/180;
    return{x:cx+radius*Math.cos(rad),y:cy+radius*Math.sin(rad)};
  };

  const slicePath=(i)=>{
    const start=i*sliceAngle;
    const end=(i+1)*sliceAngle;
    const p1=polarToCart(start,r);
    const p2=polarToCart(end,r);
    return `M${cx},${cy} L${p1.x},${p1.y} A${r},${r} 0 0,1 ${p2.x},${p2.y} Z`;
  };

  return(
    <div style={{padding:16,maxWidth:480,margin:"0 auto"}}>
      <div style={{textAlign:"center",marginBottom:20}}>
        <div style={{fontSize:40,marginBottom:6}}>ğŸ°</div>
        <h2 style={{color:C.text,fontSize:22,fontWeight:900,marginBottom:4}}>Daily Spin Wheel</h2>
        <p style={{color:C.dim,fontSize:13}}>Spin once per day for free signals & discounts!</p>
      </div>

      {/* Streak info */}
      <div style={{display:"flex",gap:10,marginBottom:20}}>
        {[{l:"Today's Spin",v:spun?"âœ… Done":"ğŸ° Ready",c:spun?C.neon:C.orange},
          {l:"Total Wins",v:"7",c:C.blue},
          {l:"Best Prize",v:"VIP 1 Day",c:"#F59E0B"}
        ].map((s,i)=>(
          <div key={i} style={{flex:1,background:C.card,border:`1px solid ${C.border}`,borderRadius:12,padding:"10px 8px",textAlign:"center"}}>
            <div style={{fontSize:13,fontWeight:800,color:s.c}}>{s.v}</div>
            <div style={{fontSize:9,color:C.dim,marginTop:3}}>{s.l}</div>
          </div>
        ))}
      </div>

      {/* Wheel container */}
      <div style={{position:"relative",display:"flex",justifyContent:"center",marginBottom:20}}>
        {/* Pointer */}
        <div style={{position:"absolute",top:-8,left:"50%",transform:"translateX(-50%)",
          width:0,height:0,borderLeft:"12px solid transparent",
          borderRight:"12px solid transparent",borderTop:"24px solid #EF4444",
          zIndex:10,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5))"}}>
        </div>

        {/* Wheel SVG */}
        <div style={{
          transform:`rotate(${rotation}deg)`,
          transition:spinning?"transform 4s cubic-bezier(0.17,0.67,0.12,0.99)":"none",
          borderRadius:"50%",
          boxShadow:`0 0 40px ${C.neon}44,0 0 80px ${C.neon}22`,
          border:`4px solid ${C.border}`}}>
          <svg width={size} height={size}>
            {PRIZES.map((p,i)=>{
              const midAngle=i*sliceAngle+sliceAngle/2;
              const textPos=polarToCart(midAngle,r*0.65);
              const emojiPos=polarToCart(midAngle,r*0.82);
              return(
                <g key={i}>
                  <path d={slicePath(i)} fill={p.color} opacity={0.9}
                    stroke={C.isDark?"#0B0F19":"#fff"} strokeWidth={2}/>
                  {/* Emoji */}
                  <text x={emojiPos.x} y={emojiPos.y} textAnchor="middle"
                    dominantBaseline="middle" fontSize={16}
                    transform={`rotate(${midAngle},${emojiPos.x},${emojiPos.y})`}>
                    {p.emoji}
                  </text>
                  {/* Label */}
                  <text x={textPos.x} y={textPos.y} textAnchor="middle"
                    dominantBaseline="middle" fontSize={9} fontWeight="700"
                    fill="#0B0F19" opacity={0.9}
                    transform={`rotate(${midAngle},${textPos.x},${textPos.y})`}>
                    {p.label}
                  </text>
                </g>
              );
            })}
            {/* Center circle */}
            <circle cx={cx} cy={cy} r={28} fill={C.card} stroke={C.border} strokeWidth={3}/>
            <text x={cx} y={cy} textAnchor="middle" dominantBaseline="middle"
              fontSize={20}>ğŸ¯</text>
          </svg>
        </div>
      </div>

      {/* Spin button or countdown */}
      {!spun?(
        <button onClick={spin} disabled={spinning}
          style={{width:"100%",padding:15,
            background:spinning?C.inner:`linear-gradient(90deg,${C.neon},#00c4a0)`,
            border:"none",borderRadius:14,color:spinning?C.dim:"#0B0F19",
            fontSize:16,fontWeight:900,cursor:spinning?"not-allowed":"pointer",
            boxShadow:spinning?"none":`0 8px 30px ${C.neon}44`,
            transition:"all 0.3s",
            animation:!spinning?"spinBtnPulse 2s ease-in-out infinite":"none"}}>
          {spinning?"ğŸŒ€ Spinning...":"ğŸ° SPIN NOW â€” It's FREE!"}
        </button>
      ):(
        <div style={{textAlign:"center"}}>
          <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:14,padding:16,marginBottom:12}}>
            <div style={{color:C.dim,fontSize:12,marginBottom:4}}>Next spin in:</div>
            <div style={{fontFamily:"monospace",fontSize:28,fontWeight:900,color:C.orange}}>
              {timeLeft?fmtTime(timeLeft):"00:00:00"}
            </div>
          </div>
          <p style={{color:C.dim,fontSize:12}}>Come back tomorrow for another free spin! ğŸ”¥</p>
        </div>
      )}

      {/* Prize popup */}
      {showResult&&result&&(
        <div style={{position:"fixed",inset:0,background:"rgba(0,0,0,0.88)",
          zIndex:8000,display:"flex",alignItems:"center",justifyContent:"center",padding:20}}>
          <div style={{background:C.card,borderRadius:24,padding:32,maxWidth:340,width:"100%",
            textAlign:"center",border:`2px solid ${result.color}`,
            boxShadow:`0 0 60px ${result.color}44`,animation:"popIn 0.5s ease"}}>
            <div style={{fontSize:60,marginBottom:12,animation:"bounce 0.6s ease"}}>{result.emoji}</div>
            <div style={{fontSize:11,color:C.dim,letterSpacing:2,marginBottom:6}}>YOU WON!</div>
            <h2 style={{fontSize:24,fontWeight:900,color:result.color,marginBottom:8}}>{result.label}</h2>
            <p style={{color:C.soft,fontSize:14,marginBottom:24}}>{result.desc}</p>

            {result.label.includes("Off")&&(
              <div style={{background:`${result.color}22`,border:`1px solid ${result.color}44`,
                borderRadius:12,padding:"12px 16px",marginBottom:20}}>
                <div style={{color:C.dim,fontSize:11,marginBottom:4}}>Your coupon code:</div>
                <div style={{fontFamily:"monospace",fontSize:20,fontWeight:900,color:result.color,letterSpacing:3}}>
                  SPIN{Math.random().toString(36).slice(2,8).toUpperCase()}
                </div>
                <div style={{color:C.dim,fontSize:10,marginTop:4}}>Valid for 24 hours</div>
              </div>
            )}

            {result.label==="VIP 1 Day"&&(
              <button onClick={()=>{setShowResult(false);onUpgrade();}}
                style={{width:"100%",padding:12,background:`linear-gradient(90deg,#F59E0B,#d97706)`,
                  border:"none",borderRadius:12,color:"#0B0F19",fontSize:14,
                  fontWeight:800,cursor:"pointer",marginBottom:10}}>
                ğŸ’ Activate VIP Trial â†’
              </button>
            )}

            <button onClick={()=>setShowResult(false)}
              style={{width:"100%",padding:12,background:"transparent",
                border:`1px solid ${C.border}`,borderRadius:12,color:C.soft,
                fontSize:13,fontWeight:700,cursor:"pointer"}}>
              Claim & Close ğŸ‰
            </button>
          </div>
        </div>
      )}

      {/* Prize list */}
      <div style={{marginTop:20}}>
        <div style={{color:C.dim,fontSize:11,letterSpacing:1,fontWeight:700,marginBottom:10}}>POSSIBLE PRIZES</div>
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8}}>
          {PRIZES.filter(p=>p.label!=="Try Again").map((p,i)=>(
            <div key={i} style={{background:C.card,border:`1px solid ${p.color}33`,
              borderRadius:10,padding:"8px 12px",display:"flex",alignItems:"center",gap:8}}>
              <span style={{fontSize:18}}>{p.emoji}</span>
              <div>
                <div style={{color:p.color,fontWeight:700,fontSize:12}}>{p.label}</div>
                <div style={{color:C.dim,fontSize:10}}>{p.desc}</div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

function SupportPage({C}){
  return(
    <div style={{padding:20,maxWidth:580}}>
      <h2 style={{color:C.text,fontSize:20,fontWeight:800,marginBottom:16}}>Support</h2>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:"4px 16px",marginBottom:14}}>
        {[
          {q:"When are signals generated?",a:"Maximum 3 high-quality signals per day for top 10 coins â€” fully automated."},
          {q:"What is the difference between Free and Premium?",a:"Free gives 1 signal/day. Premium gives all signals, Telegram alerts, full history."},
          {q:"How accurate are the signals?",a:"These are AI-based informational signals. Always trade at your own risk."},
          {q:"How do I cancel Premium?",a:"Cancel anytime from your Stripe dashboard. No lock-in period."},
        ].map((f,i)=>(
          <div key={i} style={{padding:"14px 0",borderBottom:i<3?`1px solid ${C.border}`:"none"}}>
            <div style={{color:C.text,fontWeight:700,fontSize:13,marginBottom:5}}>â“ {f.q}</div>
            <div style={{color:C.soft,fontSize:12,lineHeight:1.7}}>{f.a}</div>
          </div>
        ))}
      </div>
      <div style={{background:C.card,border:`1px solid ${C.border}`,borderRadius:16,padding:16}}>
        <div style={{color:C.text,fontWeight:700,marginBottom:12}}>ğŸ“¬ Contact</div>
        <a href="mailto:support@nexuspro.io" style={{display:"block",color:C.neon,fontSize:13,marginBottom:8,textDecoration:"none"}}>âœ‰ï¸ support@nexuspro.io</a>
        <a href="https://t.me/nexuspro_support" target="_blank" rel="noreferrer" style={{display:"block",color:"#2196F3",fontSize:13,textDecoration:"none"}}>âœˆï¸ t.me/nexuspro_support</a>
      </div>
    </div>
  );
}

// â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// â”€â”€ BOTTOM TAB BAR (5 main tabs) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function IconHome({c}){return <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={c} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>;}
function IconSignals({c}){return <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={c} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>;}
function IconBot({c}){return <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={c} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="4" y="8" width="16" height="12" rx="2"/><path d="M8 8V6a4 4 0 0 1 8 0v2"/><circle cx="9" cy="14" r="1.5" fill={c} stroke="none"/><circle cx="15" cy="14" r="1.5" fill={c} stroke="none"/><line x1="9" y1="18" x2="15" y2="18"/></svg>;}
function IconPortfolio({c}){return <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={c} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/><line x1="2" y1="20" x2="22" y2="20"/></svg>;}
function IconProfile({c}){return <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={c} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>;}
const TAB_ICONS={dashboard:IconHome,signals:IconSignals,autobot:IconBot,portfolio:IconPortfolio,profile:IconProfile};
const BOTTOM_TABS=[
  {id:"dashboard",label:"Home"},
  {id:"signals",label:"Signals"},
  {id:"autobot",label:"Bot"},
  {id:"portfolio",label:"Portfolio"},
  {id:"profile",label:"Profile"},
];

// â”€â”€ DRAWER MENU (all pages) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DRAWER_ITEMS=[
  {id:"market",icon:"ğŸ”¥",label:"Market"},
  {id:"vip",icon:"ğŸ’",label:"VIP Signals"},
  {id:"membership",icon:"ğŸ‘‘",label:"Membership"},
  {id:"leaderboard",icon:"ğŸ†",label:"Leaderboard"},
  {id:"wallet",icon:"ğŸ’°",label:"Wallet"},
  {id:"history",icon:"ğŸ“Š",label:"History"},
  {id:"search",icon:"ğŸ”",label:"Search"},
  {id:"spin",icon:"ğŸ°",label:"Daily Reward"},
  {id:"notifications",icon:"ğŸ””",label:"Alerts"},
  {id:"settings",icon:"âš™ï¸",label:"Settings"},
  {id:"support",icon:"ğŸ’¬",label:"Support"},
];

function BottomTabBar({active,setActive,unread,C}){
  return(
    <div style={{
      position:"fixed",bottom:0,left:0,right:0,
      height:68,
      background:C.isDark?"rgba(8,12,22,0.98)":"rgba(255,255,255,0.98)",
      borderTop:`1px solid ${C.isDark?"#1a2540":"#E2E8F0"}`,
      display:"flex",alignItems:"stretch",
      backdropFilter:"blur(24px)",
      WebkitBackdropFilter:"blur(24px)",
      zIndex:100,
      boxShadow:C.isDark?"0 -4px 30px rgba(0,0,0,0.4)":"0 -4px 20px rgba(0,0,0,0.08)",
      paddingBottom:"env(safe-area-inset-bottom)"}}>
      {BOTTOM_TABS.map((tab,i)=>{
        const isActive=active===tab.id;
        const showBadge=tab.id==="notifications"&&unread>0;
        return(
          <button key={tab.id} onClick={()=>setActive(tab.id)}
            style={{
              flex:1,display:"flex",flexDirection:"column",
              alignItems:"center",justifyContent:"center",gap:4,
              background:"transparent",border:"none",
              cursor:"pointer",position:"relative",
              transition:"all 0.25s ease",
              paddingTop:8,paddingBottom:6}}>

            {/* Active indicator pill - top */}
            {isActive&&(
              <div style={{
                position:"absolute",top:0,left:"50%",
                transform:"translateX(-50%)",
                width:36,height:3,borderRadius:"0 0 4px 4px",
                background:C.neon,
                boxShadow:`0 0 12px ${C.neon}99`}}/>
            )}

            {/* Icon container */}
            <div style={{
              width:36,height:36,borderRadius:10,
              display:"flex",alignItems:"center",justifyContent:"center",
              background:isActive?`${C.neon}18`:"transparent",
              transition:"all 0.2s",
              transform:isActive?"scale(1.1)":"scale(1)"}}>
              {TAB_ICONS[tab.id]&&React.createElement(TAB_ICONS[tab.id],{c:isActive?C.neon:C.isDark?"#4B5563":"#94A3B8"})}
              {showBadge&&(
                <div style={{
                  position:"absolute",top:6,right:"calc(50% - 22px)",
                  width:8,height:8,borderRadius:"50%",
                  background:"#EF4444",
                  border:`2px solid ${C.isDark?"#0B0F19":"#fff"}`}}/>
              )}
            </div>

            {/* Label */}
            <span style={{
              fontSize:10,fontWeight:isActive?800:500,
              color:isActive?C.neon:C.isDark?"#4B5563":"#94A3B8",
              letterSpacing:isActive?0.5:0.2,
              lineHeight:1,
              transition:"all 0.25s",
              textTransform:isActive?"uppercase":"none"}}>
              {tab.label}
            </span>
          </button>
        );
      })}
    </div>
  );
}

// â”€â”€ SLIDE-IN DRAWER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Drawer({open,onClose,active,setActive,unread,user,C}){
  if(!open) return null;
  return(
    <>
      {/* Backdrop */}
      <div onClick={onClose}
        style={{position:"fixed",inset:0,background:"rgba(0,0,0,0.6)",
          zIndex:200,backdropFilter:"blur(4px)"}}/>
      
      {/* Drawer panel */}
      <div style={{
        position:"fixed",top:0,left:0,bottom:0,width:280,
        background:C.isDark?"#0B0F19":C.card,
        zIndex:201,display:"flex",flexDirection:"column",
        boxShadow:"4px 0 40px rgba(0,0,0,0.5)",
        animation:"slideRight 0.3s ease"}}>
        
        {/* Drawer header */}
        <div style={{
          padding:"52px 20px 20px",
          background:`linear-gradient(135deg,${C.isDark?"#0d1520":"#f0fdf4"},transparent)`,
          borderBottom:`1px solid ${C.border}`}}>
          <div style={{display:"flex",alignItems:"center",gap:14,marginBottom:16}}>
            <div style={{
              width:52,height:52,borderRadius:16,
              background:`linear-gradient(135deg,${C.neon},#00a06d)`,
              display:"flex",alignItems:"center",justifyContent:"center",
              fontSize:22,fontWeight:800,color:"#0B0F19",
              boxShadow:`0 4px 20px ${C.neon}44`}}>
              {user?.name?.[0]?.toUpperCase()||"G"}
            </div>
            <div>
              <div style={{color:C.text,fontWeight:800,fontSize:16}}>{user?.name||"Guest"}</div>
              <div style={{
                display:"inline-flex",alignItems:"center",gap:4,
                background:user?.plan==="vip"?"#F59E0B22":user?.plan==="premium"?`${C.neon}22`:"#6B728022",
                border:`1px solid ${user?.plan==="vip"?"#F59E0B44":user?.plan==="premium"?`${C.neon}44`:"#6B728044"}`,
                borderRadius:6,padding:"2px 8px",marginTop:4}}>
                <span style={{fontSize:10}}>
                  {user?.plan==="vip"?"ğŸ’":user?.plan==="premium"?"â­":"ğŸ†“"}
                </span>
                <span style={{
                  color:user?.plan==="vip"?"#F59E0B":user?.plan==="premium"?C.neon:"#6B7280",
                  fontSize:10,fontWeight:800,letterSpacing:1}}>
                  {(user?.plan||"FREE").toUpperCase()}
                </span>
              </div>
            </div>
          </div>
        </div>

        {/* Drawer nav items */}
        <div style={{flex:1,overflowY:"auto",padding:"12px 8px"}}>
          <div style={{color:C.dim,fontSize:10,fontWeight:700,letterSpacing:1.5,
            padding:"6px 12px",marginBottom:4}}>MORE PAGES</div>
          {DRAWER_ITEMS.map((item)=>{
            const isActive=active===item.id;
            const showBadge=item.id==="notifications"&&unread>0;
            return(
              <button key={item.id}
                onClick={()=>{setActive(item.id);onClose();}}
                style={{
                  width:"100%",display:"flex",alignItems:"center",gap:12,
                  padding:"11px 12px",borderRadius:14,marginBottom:2,
                  background:isActive?`${C.neon}15`:"transparent",
                  border:`1px solid ${isActive?`${C.neon}33`:"transparent"}`,
                  cursor:"pointer",transition:"all 0.15s",textAlign:"left"}}>
                <div style={{
                  width:36,height:36,borderRadius:10,
                  background:isActive?`${C.neon}20`:C.isDark?"#1e2a40":"#F1F5F9",
                  display:"flex",alignItems:"center",justifyContent:"center",
                  fontSize:18,flexShrink:0}}>
                  {item.icon}
                </div>
                <span style={{
                  color:isActive?C.neon:C.text,
                  fontWeight:isActive?700:500,fontSize:14,flex:1}}>
                  {item.label}
                </span>
                {showBadge&&(
                  <div style={{
                    background:"#EF4444",color:"#fff",
                    borderRadius:"50%",width:18,height:18,
                    display:"flex",alignItems:"center",justifyContent:"center",
                    fontSize:9,fontWeight:800}}>{unread}</div>
                )}
                {isActive&&<span style={{color:C.neon,fontSize:12}}>â—</span>}
              </button>
            );
          })}
        </div>

        {/* Drawer footer */}
        <div style={{
          padding:"12px 16px",
          borderTop:`1px solid ${C.border}`,
          paddingBottom:"calc(12px + env(safe-area-inset-bottom))"}}>
          <div style={{
            background:`${C.neon}10`,border:`1px solid ${C.neon}22`,
            borderRadius:12,padding:"10px 14px",
            display:"flex",alignItems:"center",gap:10}}>
            <span style={{fontSize:20}}>ğŸ“¡</span>
            <div>
              <div style={{color:C.neon,fontWeight:700,fontSize:12}}>NexusPro v2.0</div>
              <div style={{color:C.dim,fontSize:10}}>AI Crypto Signal Terminal</div>
            </div>
          </div>
        </div>
      </div>
    </>
  );
}

// Keep old Sidebar as alias (not used)
function Sidebar({active,setActive,collapsed,unread,C}){ return null; }


function NotifPopup({onClose,onView,C}){
  const SIGNAL_ALERTS=[
    {coin:"BTC/USDT",dir:"LONG",conf:87,icon:"â‚¿",color:"#F7931A"},
    {coin:"ETH/USDT",dir:"LONG",conf:82,icon:"Î",color:"#627EEA"},
    {coin:"SOL/USDT",dir:"SHORT",conf:79,icon:"â—",color:"#9945FF"},
    {coin:"BNB/USDT",dir:"LONG",conf:84,icon:"â¬¡",color:"#F3BA2F"},
    {coin:"XRP/USDT",dir:"SHORT",conf:76,icon:"âœ•",color:"#00AAE4"},
  ];
  const [sig]=useState(()=>SIGNAL_ALERTS[Math.floor(Math.random()*SIGNAL_ALERTS.length)]);
  const isLong=sig.dir==="LONG";
  const glow=isLong?C.neon:"#EF4444";

  // Auto hide after 3 seconds
  useEffect(()=>{
    const t=setTimeout(()=>onClose(),3000);
    return()=>clearTimeout(t);
  },[]);

  return(
    <div style={{
      position:"fixed",bottom:80,right:12,left:12,
      background:C.isDark?"#0d1520":"#fff",
      border:`1px solid ${glow}55`,
      borderRadius:18,padding:"14px 16px",
      display:"flex",alignItems:"center",gap:12,
      boxShadow:`0 8px 40px ${glow}33`,
      animation:"slideUp 0.4s ease",
      zIndex:4000}}>

      {/* Coin icon */}
      <div style={{
        width:42,height:42,borderRadius:14,
        background:`${sig.color}22`,
        border:`1px solid ${sig.color}44`,
        display:"flex",alignItems:"center",justifyContent:"center",
        fontSize:18,flexShrink:0,color:sig.color,fontWeight:800}}>
        {sig.icon}
      </div>

      {/* Signal info */}
      <div style={{flex:1,minWidth:0}}>
        <div style={{display:"flex",alignItems:"center",gap:6,marginBottom:3}}>
          <span style={{color:C.text,fontWeight:800,fontSize:13}}>{sig.coin}</span>
          <span style={{
            background:`${glow}22`,color:glow,
            fontSize:9,fontWeight:800,padding:"2px 7px",
            borderRadius:5,letterSpacing:0.5}}>
            {sig.dir}
          </span>
          <span style={{
            background:"#8B5CF622",color:"#8B5CF6",
            fontSize:9,fontWeight:700,padding:"2px 7px",
            borderRadius:5}}>NEW</span>
        </div>
        <div style={{color:C.dim,fontSize:11}}>
          ğŸ¯ {sig.conf}% confidence Â· Just now
        </div>
        {/* Timer bar */}
        <div style={{
          marginTop:6,height:2,
          background:C.isDark?"#1e2a40":"#E2E8F0",
          borderRadius:1,overflow:"hidden"}}>
          <div style={{
            height:"100%",background:glow,
            borderRadius:1,
            animation:"notifTimer 3s linear forwards"}}/>
        </div>
      </div>

      {/* View button */}
      <button onClick={onView} style={{
        background:`linear-gradient(135deg,${glow},${glow}cc)`,
        color:isLong?"#0B0F19":"#fff",
        border:"none",borderRadius:10,
        padding:"8px 14px",fontSize:11,fontWeight:800,
        cursor:"pointer",flexShrink:0,
        boxShadow:`0 4px 12px ${glow}44`}}>
        VIEW â†’
      </button>

      {/* Close */}
      <button onClick={onClose} style={{
        background:"none",border:"none",
        color:C.dim,cursor:"pointer",
        fontSize:18,flexShrink:0,padding:"0 0 0 4px",
        lineHeight:1}}>Ã—</button>
    </div>
  );
}

// â”€â”€ MAIN APP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function NexusPro(){
  const [isDark,setIsDark]=useState(true);
  const [lang,setLang]=useState("en");
  const [timeframe,setTimeframe]=useState("15M");
  const [accentColor,setAccentColor]=useState("#00F5A0");
  const C={...(isDark?DARK:LIGHT),neon:accentColor};

  // App state flow
  const [step,setStep]=useState("risk"); // risk â†’ onboarding â†’ auth â†’ app
  const [user,setUser]=useState(null);
  const [activeNav,setActiveNav]=useState("dashboard");
  const [collapsed,setCollapsed]=useState(true);
  const [drawerOpen,setDrawerOpen]=useState(false);
  const effectiveUser=user;
  const [coins,setCoins]=useState(COINS);
  const [showNotif,setShowNotif]=useState(false);
  const [modal,setModal]=useState({type:null,signal:null});
  const [toast,setToast]=useState(null);
  const [showPWA,setShowPWA]=useState(false);
  const [deferredPrompt,setDeferredPrompt]=useState(null);
  const [showGuestPopup,setShowGuestPopup]=useState(false);
  const isGuest=user?.isGuest||false;
  const goSignup=()=>{setShowGuestPopup(false);setStep("auth");setUser(null);};
  const [selectedCoin,setSelectedCoin]=useState(null);

  // Live prices
  useEffect(()=>{
    const t=setInterval(()=>{
      setCoins(prev=>prev.map(c=>({...c,price:+(c.price*(1+(Math.random()-0.5)*0.002)).toFixed(4),change:+(c.change+(Math.random()-0.5)*0.05).toFixed(2)})));
    },2000);
    return()=>clearInterval(t);
  },[]);

  // Show signal popup: first after 4s, then every 30s
  useEffect(()=>{
    if(step==="app"){
      // First popup after 4 seconds
      const first=setTimeout(()=>setShowNotif(true),4000);
      // Repeat every 30 seconds
      const interval=setInterval(()=>setShowNotif(true),30000);
      return()=>{clearTimeout(first);clearInterval(interval);}
    }
  },[step]);

  const showToast=msg=>setToast(msg);
  const openChart=s=>setModal({type:"chart",signal:s});
  const openShare=s=>setModal({type:"share",signal:s});
  const openDetail=s=>setModal({type:"signalDetail",signal:s});
  const openUpgrade=()=>setModal({type:"upgrade",signal:null});
  const openVIP=()=>setModal({type:"vip",signal:null});
  const closeModal=()=>setModal({type:null,signal:null});
  const unreadCount=NOTIFS.filter(n=>!n.read).length;

  const handleNavClick=(id)=>{
    if(id==="coinDetail") return;
    setActiveNav(id);
    setSelectedCoin(null);
    setDrawerOpen(false);
  };

  // Ticker
  const ticker=[...coins,...coins].map((c,i)=>(
    <span key={i} style={{marginRight:24,fontSize:11,whiteSpace:"nowrap"}}>
      <span style={{color:C.dim}}>{c.symbol}/USDT </span>
      <span style={{color:C.text,fontFamily:"monospace"}}>${fmt(c.price)}</span>
      <span style={{color:c.change>0?C.neon:C.red,marginLeft:3}}>{c.change>0?"â–²":"â–¼"} {Math.abs(c.change).toFixed(2)}%</span>
    </span>
  ));

  // â”€â”€ FLOW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if(step==="risk") return <RiskDisclaimer onAccept={()=>setStep("onboarding")} C={C}/>;
  if(step==="onboarding") return <Onboarding onDone={()=>setStep("auth")} C={C}/>;
  if(step==="auth") return <AuthScreen onLogin={u=>{setUser(u);setStep("app");}} C={C}/>;

  // â”€â”€ MAIN APP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  return(
    <>
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Rajdhani:wght@400;500;600;700;800&display=swap');
        *{box-sizing:border-box;margin:0;padding:0;}
        body{background:${C.bg};font-family:'Rajdhani',sans-serif;}
        button{font-family:'Rajdhani',sans-serif;}
        @keyframes ticker{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
        @keyframes fadeSlideIn{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}
        @keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}} @keyframes slideRight{from{transform:translateX(-100%)}to{transform:translateX(0)}}
        @keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}
        @keyframes popIn{from{opacity:0;transform:scale(0.85)}to{opacity:1;transform:scale(1)}}
        @keyframes spin{to{transform:rotate(360deg)}}
        @keyframes urgencyPulse{0%,100%{opacity:1;box-shadow:0 0 0 0 rgba(239,68,68,0)}50%{opacity:0.7;box-shadow:0 0 0 6px rgba(239,68,68,0.15)}}
        @keyframes criticalBlink{0%,100%{opacity:1}50%{opacity:0.3}}
        @keyframes bounce{0%,100%{transform:scale(1)}50%{transform:scale(1.2)}}
        @keyframes slideUp{from{transform:translateY(100px);opacity:0}to{transform:translateY(0);opacity:1}} @keyframes spinBtnPulse{0%,100%{box-shadow:0 8px 30px #00F5A044}50%{box-shadow:0 8px 50px #00F5A088}}
        ::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:${C.card}}::-webkit-scrollbar-thumb{background:#2a3a55;border-radius:2px}
      `}</style>

```
  <div style={{display:"flex",flexDirection:"column",height:"100vh",background:C.bg,color:C.text,overflow:"hidden"}}>
    {/* TOP BAR */}
    <div style={{display:"flex",alignItems:"center",padding:"0 12px",height:52,background:C.isDark?"#0d1220":C.card,borderBottom:`1px solid ${C.border}`,gap:8,flexShrink:0,zIndex:20,minWidth:0}}>
      {/* Menu button */}
      <button onClick={()=>setDrawerOpen(true)}
        style={{
          background:C.isDark?"#1e2a4088":"#E2E8F088",
          border:"none",
          color:C.text,cursor:"pointer",
          width:36,height:36,borderRadius:10,
          display:"flex",flexDirection:"column",
          alignItems:"center",justifyContent:"center",
          gap:4,flexShrink:0}}>
        <span style={{width:16,height:2,background:C.text,borderRadius:1,display:"block"}}/>
        <span style={{width:12,height:2,background:C.text,borderRadius:1,display:"block"}}/>
        <span style={{width:16,height:2,background:C.text,borderRadius:1,display:"block"}}/>
      </button>

      {/* Logo - compact */}
      <div style={{flexShrink:0}}>
        <div style={{fontFamily:"'Space Mono',monospace",fontWeight:700,fontSize:12,letterSpacing:1.5,lineHeight:1}}>NEXUS<span style={{color:C.neon}}>PRO</span></div>
      </div>

      {/* Ticker - flex:1 with hard overflow hidden */}
      <div style={{flex:1,minWidth:0,overflow:"hidden",borderLeft:`1px solid ${C.border}`,borderRight:`1px solid ${C.border}`,padding:"0 8px",height:"100%",display:"flex",alignItems:"center"}}>
        <div style={{display:"inline-flex",animation:"ticker 30s linear infinite",whiteSpace:"nowrap",willChange:"transform"}}>{ticker}</div>
      </div>

      {/* Right side - only upgrade button + avatar */}
      <div style={{display:"flex",alignItems:"center",gap:6,flexShrink:0}}>
        <button onClick={()=>setIsDark(d=>!d)}
          style={{background:"transparent",border:`1px solid ${C.border}`,color:C.dim,
            width:30,height:30,borderRadius:8,fontSize:14,
            cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"}}>
          {isDark?"â˜€ï¸":"ğŸŒ™"}
        </button>

        <button onClick={openUpgrade}
          style={{background:`${C.neon}20`,border:`1px solid ${C.neon}44`,color:C.neon,
            padding:"5px 10px",borderRadius:8,fontSize:10,fontWeight:800,
            cursor:"pointer",whiteSpace:"nowrap",letterSpacing:0.5}}>
          â­ UPGRADE
        </button>
        <button onClick={()=>handleNavClick("profile")}
          style={{width:30,height:30,borderRadius:"50%",background:`linear-gradient(135deg,${C.neon},#00a06d)`,
            display:"flex",alignItems:"center",justifyContent:"center",
            fontSize:13,cursor:"pointer",border:"none",color:"#0B0F19",fontWeight:800,flexShrink:0}}>
          {user?.name?.[0]?.toUpperCase()||"G"}
        </button>
      </div>
    </div>

    {/* DRAWER */}
    <Drawer open={drawerOpen} onClose={()=>setDrawerOpen(false)}
      active={activeNav} setActive={handleNavClick}
      unread={unreadCount} user={effectiveUser} C={C}/>

    {/* BODY */}
    <div style={{display:"flex",flex:1,overflow:"hidden",position:"relative"}}>
      <Sidebar active={selectedCoin?"coinDetail":activeNav} setActive={(id)=>{handleNavClick(id);setCollapsed(true);}} collapsed={collapsed} unread={unreadCount} C={C}/>
      {/* Backdrop when sidebar open */}
      {!collapsed&&<div onClick={()=>setCollapsed(true)} style={{position:"absolute",inset:0,background:"rgba(0,0,0,0.5)",zIndex:99}}/>}
      <div style={{flex:1,overflow:"auto",position:"relative",minWidth:0}}>
        <div style={{position:"absolute",inset:0,pointerEvents:"none",backgroundImage:`linear-gradient(${C.border}15 1px,transparent 1px),linear-gradient(90deg,${C.border}15 1px,transparent 1px)`,backgroundSize:"40px 40px"}}/>

        {selectedCoin && <CoinDetailPage coin={selectedCoin} onBack={()=>setSelectedCoin(null)} C={C}/>}
        {!selectedCoin && (activeNav==="dashboard"||activeNav==="signals") && <Dashboard coins={coins} onChart={openChart} onShare={openShare} onDetail={openDetail} onUpgrade={openUpgrade} C={C} isGuest={effectiveUser?.isGuest||false} onSignup={()=>setShowGuestPopup(true)} onGoBot={()=>handleNavClick("autobot")}/>}
        {!selectedCoin && activeNav==="search"       && <SearchPage coins={coins} C={C} setCoin={setSelectedCoin} setNav={setActiveNav}/>}
        {!selectedCoin && activeNav==="history"      && <HistoryPage C={C}/>}
        {!selectedCoin && activeNav==="market"       && <MarketPage coins={coins} setCoin={setSelectedCoin} setNav={setActiveNav} C={C}/>}
        {!selectedCoin && activeNav==="portfolio"    && <PortfolioPage coins={coins} C={C}/>}
        {!selectedCoin && activeNav==="wallet"       && <WalletPage C={C}/>}
        {!selectedCoin && activeNav==="leaderboard"  && <LeaderboardPage C={C}/>}
        {!selectedCoin && activeNav==="vip"          && <VIPSignalsPage onUpgrade={openVIP} C={C}/>}
        {!selectedCoin && activeNav==="membership"   && <MembershipPage onUpgrade={openUpgrade} onVIP={openVIP} C={C}/>}
        {!selectedCoin && activeNav==="notifications"&& <NotificationsPage C={C}/>}
        {!selectedCoin && activeNav==="profile"      && (isGuest?<div style={{padding:20,textAlign:"center"}}><div style={{fontSize:50,marginBottom:16}}>ğŸ‘¤</div><h2 style={{color:C.text,marginBottom:8}}>Guest Account</h2><p style={{color:C.soft,fontSize:13,marginBottom:20}}>Sign up to access your profile, referrals, and more!</p><button onClick={goSignup} style={{padding:"13px 28px",background:C.neon,border:"none",borderRadius:12,color:"#0B0F19",fontSize:14,fontWeight:800,cursor:"pointer"}}>Create Free Account â†’</button></div>:<ProfilePage user={effectiveUser} onLogout={()=>{setUser(null);setStep("auth");}} onUpgrade={openUpgrade} onVIP={openVIP} C={C}/>)}
        {!selectedCoin && activeNav==="settings"     && <SettingsPage C={C} isDark={isDark} setIsDark={setIsDark} lang={lang} setLang={setLang} timeframe={timeframe} setTimeframe={setTimeframe} accentColor={accentColor} setAccentColor={setAccentColor}/>}
        {!selectedCoin && activeNav==="autobot"      && <AutoTradePage user={effectiveUser} C={C}/>}
        {!selectedCoin && activeNav==="spin"         && <SpinWheelPage C={C} onUpgrade={openVIP}/>}
        {!selectedCoin && activeNav==="support"      && <SupportPage C={C}/>}
      </div>
    </div>

    {/* STATUS BAR */}
    <div style={{background:C.isDark?"#0d1220":C.card,borderTop:`1px solid ${C.border}`,padding:"5px 14px",display:"flex",alignItems:"center",gap:12,fontSize:10,color:C.dim,flexShrink:0}}>
      <span style={{display:"flex",alignItems:"center",gap:5}}>
        <span style={{width:6,height:6,borderRadius:"50%",background:C.neon,display:"inline-block",animation:"blink 1.5s infinite"}}/>
        Signal Engine: ACTIVE
      </span>
      <span>BTC/USDT Â· LONG</span>
      <span style={{marginLeft:"auto"}}>Not financial advice. Trade at your own risk.</span>
    </div>
  </div>

  {showNotif&&<NotifPopup C={C} onClose={()=>setShowNotif(false)} onView={()=>{openDetail(SIGNALS[0]);setShowNotif(false);}}/>}
  {showPWA&&<PWAInstallBanner C={C} onDismiss={()=>{setShowPWA(false);localStorage.setItem("pwaDismissed","1");}}/>}
  <BottomTabBar
    active={selectedCoin?"coinDetail":activeNav}
    setActive={handleNavClick}
    unread={unreadCount}
    C={C}/>
  {showGuestPopup&&<GuestSignupPopup C={C} onClose={()=>setShowGuestPopup(false)} onGoSignup={goSignup}/>}
  <Modal type={modal.type} signal={modal.signal} onClose={closeModal} toast={showToast} C={C}/>
  {toast&&<Toast msg={toast} C={C} onDone={()=>setToast(null)}/>}
</>
```

);
}

```
// Mount app
const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(<NexusPro/>);


// Hide loading screen
var ls = document.getElementById('loading-screen');
if(ls){ ls.style.transition='opacity 0.4s'; ls.style.opacity='0'; setTimeout(function(){ls.remove();},400); }
```

  </script>

  <!-- PWA Service Worker -->

  <script>
    try {
      if('serviceWorker' in navigator && location.protocol === 'https:'){
        window.addEventListener('load', function(){
          navigator.serviceWorker.register('/sw.js').catch(function(){});
        });
      }
    } catch(e){}
  </script>

</body>
</html>